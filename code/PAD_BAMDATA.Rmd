---
title: "PAD_BAMDATA"
author: "Merritt Harlan"
date: "2/24/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Functions

```{r Functions}
###Run BAM for all rivers
library(gtools)
library(bamr)
library(zoo)
library(hydroGOF)
library(dplyr)
library(ggplot2)
library(robustHD)
library(rgdal)
library(raster)

### Functions --------

#Calculate dA
#Calculate area
#' Calculate partial cross-section area from DAWG-formatted width and height matrices
#' @param w Matrix of widths
#' @param h Matrix of heights(FROM MARK)
calcdA_mat <- function(w, h) {
  stopifnot(all(dim(w) == dim(h)))
  dA <- w
  for (i in 1:nrow(dA)) {
    dA[i, ] <- calcdA_vec(w[i, ], h[i, ])
  }
  dA
}


#' Calculate partial cross-section area from width and height vectors (time series)
#' @param w vector of widths
#' @param h vector of heights(FROM MARK)
calcdA_vec <- function(w, h) {
  words <- order(w)
  warr <- w[words]
  harr <- h[words]
  delh <- c(0, diff(harr))
  delA <- cumsum(warr * delh)
  dA <- 1:length(w)
  dA[words] <- delA
  dA
}

#Calculate slope
#' Calculate slope based on height and along-river distance
#' @param xvec vector of x (along-stream) distances, measured from
#' upstream-most cross-section
#' @param hmat Matrix (space-down, time-across) of stream heights above
#'arbitrary datum.(FROM MARK)
calcslope <- function(xvec, hmat) {
  dH <- apply(hmat, 2, function(x) c(NA, -diff(x)))
  dX_vec <- c(NA, diff(xvec))
  dX <- matrix(dX_vec, ncol = ncol(hmat), nrow = nrow(hmat),
               byrow = FALSE)
  out <- dH / dX
}


#Vector of distances between pt coordinates
calc_xvec <- function(pt_coords_sp, cl){
  coords = cl@lines[[1]]@Lines[[1]]@coords
  csum = cumsum(pointDistance(coords[1:(nrow(coords)-1),], coords[2:nrow(coords),], lonlat = FALSE))
  dist_mat = pointDistance(pt_coords_sp, data.frame(cl@lines[[1]]@Lines[[1]]@coords))
  xvec = csum[apply(dist_mat, 1, FUN = which.min)]
  return(xvec)
}

#Run BAM for each time step, updating the prior each time
run_bam_var_width <-function(wd, rivname, wse, slope, qobs){
  setwd(wd)
  l = nrow(qobs)
  sam = list()
  for(i in 1:l){
    sam[[i]] = sample(l, i)
    q_sam = qobs$Q[sam[[i]]]
    width = t(standardize(wse)+mean(qobs$Width[sam[[i]]]))
    dA = calcdA_mat(width, t(wse))
    data = bam_data(w = width, s = slope ,dA = dA, Qhat = q_sam)
    qmin = max(c(1, c(min(q_sam) - max(c(0.2*min(q_sam), (max(q_sam) - min(q_sam)))))))
    qmax = max(q_sam) + max(c(0.2*max(q_sam), (max(q_sam) - min(q_sam))))
    priors = bam_priors(bamdata= data, lowerbound_logQ = log(qmin), 
                        upperbound_logQ = log(qmax),lowerbound_logn = log(0.025),
                        upperbound_logn = log(0.150), Serr_sd = 0.1 * mean(slope),
                        lowerbound_A0 = mean(qobs$Area[sam[[i]]]- 2*qobs$Width[sam[[i]]]), 
                        upperbound_A0 = mean(qobs$Area[sam[[i]]]+ 2*qobs$Width[sam[[i]]]))
    man_amhg = bam_estimate(bamdata = data, variant = "manning_amhg",bampriors = priors)
    save(man_amhg, file = paste0(rivname, "_man_amhg_", i, ".RData"))
  }
  return(sam)
}


run_bam_invar_width <-function(wd, rivname, wse, slope, qobs){
  setwd(wd)
  l = nrow(qobs)
  sam = list()
  for(i in 1:l){
    sam[[i]] = sample(l, i)
    q_sam = qobs$Q[sam[[i]]]
    width = matrix(mean(qobs$Width[sam[[i]]]), nrow = ncol(wse), ncol = nrow(wse))
    dA = calcdA_mat(width, t(wse))
    data = bam_data(w = width, s = slope ,dA = dA, Qhat = q_sam)
    qmin = max(c(1, c(min(q_sam) - max(c(0.2*min(q_sam), (max(q_sam) - min(q_sam)))))))
    qmax = max(q_sam) + max(c(0.2*max(q_sam), (max(q_sam) - min(q_sam))))
    priors = bam_priors(bamdata= data, lowerbound_logQ = log(qmin), 
                        upperbound_logQ = log(qmax),lowerbound_logn = log(0.025),
                        upperbound_logn = log(0.150), Serr_sd = 0.1 * mean(slope),
                        lowerbound_A0 = mean(qobs$Area[sam[[i]]]- 2*qobs$Width[sam[[i]]]), 
                        upperbound_A0 = mean(qobs$Area[sam[[i]]]+ 2*qobs$Width[sam[[i]]]))
    man_amhg = bam_estimate(bamdata = data, variant = "manning_amhg", bampriors = priors)
    save(man_amhg, file = paste0(rivname, "_man_amhg_", i, ".RData"))
  }
  return(sam)
}


run_bam_invar_width_Q <-function(wd, rivname, wse, slope, qobs, maxQ, minQ){
  setwd(wd)
  l = min(nrow(qobs), 10)
  sam = list()
  for(i in 1:l){
    sam[[i]] = sample(l, i)
    q_sam = qobs$Q[sam[[i]]]
    width = matrix(mean(qobs$Width[sam[[i]]]), nrow = ncol(wse), ncol = nrow(wse))
    dA = calcdA_mat(width, t(wse))
    data = bam_data(w = width, s = slope ,dA = dA, Qhat = q_sam)
    priors = bam_priors(bamdata= data, lowerbound_logQ = log(minQ), 
                        upperbound_logQ = log(maxQ),lowerbound_logn = log(0.025),
                        upperbound_logn = log(0.150), Serr_sd = 0.1 * mean(slope),
                        lowerbound_A0 = mean(qobs$Area[sam[[i]]]- 2*qobs$Width[sam[[i]]]), 
                        upperbound_A0 = mean(qobs$Area[sam[[i]]]+ 2*qobs$Width[sam[[i]]]))
    man_amhg = bam_estimate(bamdata = data, variant = "manning_amhg", bampriors = priors)
    save(man_amhg, file = paste0(rivname, "_man_amhg_", i, ".RData"))
  }
  return(sam)
}

run_bam_invar_width_default <-function(wd, rivname, wse, slope, qobs, maxQ, minQ){
  setwd(wd)
  l = nrow(qobs)
  sam = list()
  for(i in 1:l){
    sam[[i]] = sample(l, i)
    q_sam = qobs$Q[sam[[i]]]
    width = matrix(mean(qobs$Width[sam[[i]]]), nrow = ncol(wse), ncol = nrow(wse))
    dA = calcdA_mat(width, t(wse))
    data = bam_data(w = width, s = slope ,dA = dA, Qhat = q_sam)
    priors = bam_priors(bamdata= data, lowerbound_logQ = log(minQ), 
                        upperbound_logQ = log(maxQ))
    man_amhg = bam_estimate(bamdata = data, variant = "manning_amhg", bampriors = priors)
    save(man_amhg, file = paste0(rivname, "_man_amhg_", i, ".RData"))
  }
  return(sam)
}

#Plot BAM
bam_plot <- function(wd, qobs){
  setwd(wd)
  bam_files = mixedsort(list.files())
  hydrograph = list()
  for(f in 1:length(bam_files)){
    load(bam_files[f])
    hydrograph[[f]] = bam_hydrograph(fit = man_amhg, qobs = qobs)
  }
  return(hydrograph)
}

#Validate BAM
bam_val <- function(wd, qobs){
  setwd(wd)
  bam_files = mixedsort(list.files())
  bam_stats = data.frame()
  ptm = proc.time()
  for(f in 1:length(bam_files)){
    load(bam_files[f])
    detach("package:hydroGOF", unload = TRUE)
    pred = bam_validate(man_amhg, qobs)$valdata$qpred
    library(hydroGOF)
    sd = exp(summary(man_amhg)$summary[1:length(qobs), 3])
    rrmse = sqrt(mean(((pred - qobs)/qobs)^2))
    nash = NSE(sim = pred, obs = qobs)
    n_rmse = sqrt(mean(((pred - qobs)/mean(qobs))^2))
    p_bias = mean((pred - qobs)/mean(qobs))
    kge = KGE(sim = pred, obs = qobs)
    
    rrmse_lower = sqrt(mean((((pred-sd) - qobs)/qobs)^2))
    nash_lower = NSE(sim = (pred-sd), obs = qobs)
    n_rmse_lower = sqrt(mean((((pred-sd) - qobs)/mean(qobs))^2))
    p_bias_lower = mean(((pred-sd) - qobs)/mean(qobs))
    kge_lower = KGE(sim = (pred-sd), obs = qobs)
    
    rrmse_upper = sqrt(mean((((pred+sd) - qobs)/qobs)^2))
    nash_upper = NSE(sim = (pred+sd), obs = qobs)
    n_rmse_upper = sqrt(mean((((pred+sd) - qobs)/mean(qobs))^2))
    p_bias_upper = mean(((pred+sd) - qobs)/mean(qobs))
    kge_upper = KGE(sim = (pred+sd), obs = qobs)
    
    df = data.frame(nash = nash, rrmse = rrmse, n_rmse = n_rmse, p_bias = p_bias, 
                    kge = kge, num_xs = f, nash_lower = nash_lower, rrmse_lower = rrmse_lower,
                    n_rmse_lower = n_rmse_lower, p_bias_lower = p_bias_lower, kge_lower = kge_lower,
                    nash_upper = nash_upper, rrmse_upper = rrmse_upper, 
                    n_rmse_upper = n_rmse_upper, p_bias_upper = p_bias_upper, kge_upper = kge_upper)
    bam_stats = rbind(df, bam_stats)
  }
  return(bam_stats)
}

bam_val_stats <- function(bam_stats){
  nash = rowMeans(matrix(c(bam_stats$nash, bam_stats$nash_lower, bam_stats$nash_upper), ncol = 3))
  nash_sd = apply(matrix(c(bam_stats$nash, bam_stats$nash_lower, bam_stats$nash_upper), ncol = 3), 1, sd)
  rrmse = rowMeans(matrix(c(bam_stats$rrmse, bam_stats$rrmse_lower, bam_stats$rrmse_upper), ncol = 3))
  rrmse_sd = apply(matrix(c(bam_stats$rrmse, bam_stats$rrmse_lower, bam_stats$rrmse_upper), ncol = 3), 1, sd)
  n_rmse = rowMeans(matrix(c(bam_stats$n_rmse, bam_stats$n_rmse_lower, bam_stats$n_rmse_upper), ncol = 3))
  n_rmse_sd = apply(matrix(c(bam_stats$n_rmse, bam_stats$n_rmse_lower, bam_stats$n_rmse_upper), ncol = 3), 1, sd)
  p_bias = rowMeans(matrix(c(bam_stats$p_bias, bam_stats$p_bias_lower, bam_stats$p_bias_upper), ncol = 3))
  p_bias_sd = apply(matrix(c(bam_stats$p_bias, bam_stats$p_bias_lower, bam_stats$p_bias_upper), ncol = 3), 1, sd)
  kge = rowMeans(matrix(c(bam_stats$kge, bam_stats$kge_lower, bam_stats$kge_upper), ncol = 3))
  kge_sd = apply(matrix(c(bam_stats$kge, bam_stats$kge_lower, bam_stats$kge_upper), ncol = 3), 1, sd)
  stats = data.frame(nash, nash_sd, rrmse, rrmse_sd, n_rmse, n_rmse_sd, p_bias, p_bias_sd, kge, kge_sd)
  return(stats)
}

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
#Merritt Harlan
#12/18/2019


#####PAD 2018-----

###Athabasca------
#load WSE
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT/Athabasca/WSE")
Athabasca_WSE <- read.csv("Athabasca_WSE_PPP_corr.csv")
Athabasca_WSE <- Athabasca_WSE %>%
  mutate(day = as.Date(new_time, format="%Y-%m-%d"))
Athabasca_WSE_daily <- aggregate(. ~day, data = Athabasca_WSE, mean, na.rm = TRUE)[,c(4:ncol(Athabasca_WSE))]

#load Q
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca")
Athabasca_corr_Q <- read.csv("Athabasca_corr_Q.csv")
Athabasca_corr_Q <- Athabasca_corr_Q %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Athabasca_qobs_daily <- aggregate(. ~day, data = Athabasca_corr_Q[,c(6,8,9,14)], 
                                  mean, na.rm = TRUE)[,2]
par(family = "serif")
plot(as.POSIXct(Athabasca_corr_Q$new_date), Athabasca_corr_Q$Q, xlab = "Date", ylab = "Discharge (m^3/s)", 
     main = "Athabasca ADCP hydrograph", pch = 19)

#load cl and PT coords
setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca", sep =""))
Athabasca_cl <-readOGR(dsn = ".", layer = "Athabasca_cl_UTM")

setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT", sep =""))
Athabasca_PT_coords <- read.csv("Athabasca_PT_coords.csv")
Athabasca_PT_coords_sp <-SpatialPoints(Athabasca_PT_coords[,4:5], 
                                       proj4string = crs('+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0' ))
#calculate the distance between pts
Athabasca_xvec <- calc_xvec(Athabasca_PT_coords_sp, Athabasca_cl)
save(Athabasca_xvec, file = "Athabasca_xvec.RData")
#find overlapping ADCP and PT times
Athabasca_closest_time <- vector(length = length(Athabasca_corr_Q$new_date))
for(i in 1:length(Athabasca_corr_Q$new_date)){
  Athabasca_closest_time[i] = which.min(abs(as.POSIXct(Athabasca_WSE$new_time, tz = "MST") - 
                                              as.POSIXct(Athabasca_corr_Q$new_date[i], tz = "MST")))
}

Athabasca_WSE_corrQ <- Athabasca_WSE[c(Athabasca_closest_time[order(Athabasca_closest_time)]),c(3:7)]

#Calculate slope
Athabasca_slope <- calcslope(sort(Athabasca_xvec), hmat = t(Athabasca_WSE_corrQ[, order(Athabasca_xvec)]))
Athabasca_slope[1,] <- colMeans(Athabasca_slope, na.rm = TRUE)

#Run BAM
pt = proc.time()
Athabasca_bam_invar_width <- run_bam_invar_width_default(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_invar_width",
                               slope =  Athabasca_slope, qobs = Athabasca_corr_Q, rivname = "Athabasca",
                               minQ = min(Athabasca_corr_Q$Q), maxQ = max(Athabasca_corr_Q$Q),
                               wse = Athabasca_WSE_corrQ)
library(hydroGOF)
Athabasca_val_invar_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_invar_width",
                               Athabasca_corr_Q$Q)
Athabasca_val_invar_width <- Athabasca_val_invar_width[order(Athabasca_val_invar_width$num_xs),]
Athabasca_stats_invar_width <- bam_val_stats(Athabasca_val_invar_width)
Athabasca_plot_invar_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_invar_width",
                                 Athabasca_corr_Q$Q)
proc.time()-pt

#With new priors
pt = proc.time()
Athabasca_bam_invar_width_priors <- run_bam_invar_width_Q(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_invar_width_Qpriors_10",
                                                 slope =  Athabasca_slope, qobs = Athabasca_corr_Q, rivname = "Athabasca",
                                                 minQ = 0.75*min(Athabasca_corr_Q$Q), maxQ = 1.3*max(Athabasca_corr_Q$Q),
                                                 wse = Athabasca_WSE_corrQ)
library(hydroGOF)
Athabasca_val_invar_width_priors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_invar_width_Qpriors_10",
                                     Athabasca_corr_Q$Q)
Athabasca_val_invar_width_priors <- Athabasca_val_invar_width_priors[order(Athabasca_val_invar_width_priors$num_xs),]
Athabasca_stats_invar_width_priors <- bam_val_stats(Athabasca_val_invar_width_priors)
Athabasca_plot_invar_width_priors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_invar_width_Qpriors_10",
                                       Athabasca_corr_Q$Q)
proc.time()-pt


#With new priors and Q prior
pt = proc.time()
Athabasca_bam_invar_width_Qpriors <- run_bam_invar_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_invar_width_Qpriors",
                                                        slope =  Athabasca_slope, qobs = Athabasca_corr_Q, rivname = "Athabasca",
                                                        wse = Athabasca_WSE_corrQ)
library(hydroGOF)
Athabasca_val_invar_width_Qpriors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_invar_width_Qpriors",
                                            Athabasca_corr_Q$Q)
Athabasca_val_invar_width_Qpriors <- Athabasca_val_invar_width_Qpriors[order(Athabasca_val_invar_width_Qpriors$num_xs),]
Athabasca_stats_invar_width_Qpriors <- bam_val_stats(Athabasca_val_invar_width_Qpriors)
Athabasca_plot_invar_width_Qpriors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_invar_width_Qpriors",
                                              Athabasca_corr_Q$Q)
proc.time()-pt

#var width
pt = proc.time()
Athabasca_bam_var_width <- run_bam_var_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_var_width",
                                                         slope =  Athabasca_slope, qobs = Athabasca_corr_Q, rivname = "Athabasca",
                                                         wse = Athabasca_WSE_corrQ)
library(hydroGOF)
Athabasca_val_var_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_var_width",
                                             Athabasca_corr_Q$Q)
Athabasca_val_var_width <- Athabasca_val_var_width[order(Athabasca_val_var_width$num_xs),]
Athabasca_stats_var_width <- bam_val_stats(Athabasca_val_var_width)
Athabasca_plot_var_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_var_width",
                                               Athabasca_corr_Q$Q)
proc.time()-pt


#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/Gauge_All")
Athabasca_temp_gauge_all <- temporary_gauge_all(num_days = nrow(Athabasca_WSE_corrQ), 
                                                pt_count = ncol(Athabasca_WSE_corrQ), 
                                                file_name = "Athabasca",
                                                WSE_mat = t(Athabasca_WSE_corrQ), 
                                                Qobs = Athabasca_corr_Q$Q)
Athabasca_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/Gauge_All",
                                       Athabasca_corr_Q$Q)

#Load BAM results from old method of estimating width from DEM
library(hydroGOF)
Athabasca_old_corr_Q <- data.frame(PAD_2018_ADCP_UTM)
Athabasca_old_corr_Q$Location <- unlist(lapply(Athabasca_old_corr_Q$Location, toString))
Athabasca_old_corr_Q <- Athabasca_old_corr_Q[startsWith(Athabasca_old_corr_Q$Location,
                                                                         "ATH"),]
Athabasca_old_corr_Q <- Athabasca_old_corr_Q$Q[Athabasca_old_corr_Q$Q > 600]
Athabasca_val_corr_Q <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Athabasca/BAM_corrQ",
                                     Athabasca_old_corr_Q)
Athabasca_val_corr_Q <- Athabasca_val_corr_Q[order(Athabasca_val_corr_Q$num_xs),]
Athabasca_stats_corr_Q <- bam_val_stats(Athabasca_val_corr_Q)

#Plot total time and all error metrics--------
#KGE
png(filename = "Athabasca", width = 13, height = 7.5, units = "in", res = 300)
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Athabasca_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Athabasca_stats_invar_width_priors$kge, col = "red", pch = 19)
arrows(c(0:9), 
       Athabasca_stats_invar_width_priors$kge - Athabasca_stats_invar_width_priors$kge_sd, c(0:9), 
       Athabasca_stats_invar_width_priors$kge + Athabasca_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "red")

#NSE
par(family = "serif")
boxplot(nash~num_xs,
        data= Athabasca_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Athabasca_stats_invar_width_priors$nash, col = "red", pch = 19)
arrows(c(0:9), 
       Athabasca_stats_invar_width_priors$nash - Athabasca_stats_invar_width_priors$nash_sd, c(0:9), 
       Athabasca_stats_invar_width_priors$nash + Athabasca_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "red")

#rrmse
par(family = "serif")
boxplot(rrmse~num_xs,
        data= Athabasca_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(0.06, 0.15)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Athabasca_stats_invar_width_priors$rrmse, col = "red", pch = 19)
arrows(c(0:9), 
       Athabasca_stats_invar_width_priors$rrmse - Athabasca_stats_invar_width_priors$rrmse_sd, c(0:9), 
       Athabasca_stats_invar_width_priors$rrmse + Athabasca_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "red")
#NRMSE
par(family = "serif")
boxplot(n_rmse~num_xs,
        data= Athabasca_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(0.06, 0.15)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Athabasca_stats_invar_width_priors$n_rmse, col = "red", pch = 19)
arrows(c(0:9), 
       Athabasca_stats_invar_width_priors$n_rmse - Athabasca_stats_invar_width_priors$n_rmse_sd, c(0:9), 
       Athabasca_stats_invar_width_priors$n_rmse + Athabasca_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "red")
#PBIAS
par(family = "serif")
boxplot(p_bias~num_xs,
        data= Athabasca_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(-0.1, 0.05)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Athabasca_stats_invar_width_priors$p_bias, col = "red", pch = 19)
arrows(c(0:9), 
       Athabasca_stats_invar_width_priors$p_bias - Athabasca_stats_invar_width_priors$p_bias_sd, c(0:9), 
       Athabasca_stats_invar_width_priors$p_bias + Athabasca_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "red")
dev.off()
#rrmse
boxplot(rrmse~num_xs,
        data= Athabasca_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Athabasca_corr_Q$Q)), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$rrmse - Athabasca_stats_invar_width$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$rrmse + Athabasca_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$rrmse - Athabasca_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$rrmse + Athabasca_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$rrmse - Athabasca_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$rrmse + Athabasca_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$rrmse - Athabasca_stats_var_width$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$rrmse + Athabasca_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_corr_Q$rrmse[1:46], col = "red", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$rrmse - Athabasca_stats_corr_Q$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$rrmse + Athabasca_stats_corr_Q$rrmse_sd, length=0.05, angle=90, code=3,
       col = "red")

#n_rmse
boxplot(n_rmse~num_xs,
        data= Athabasca_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Athabasca_corr_Q$Q)), 
        ylim= c(0.8, 2)
)
axis(1, at = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$n_rmse - Athabasca_stats_invar_width$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$n_rmse + Athabasca_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$n_rmse - Athabasca_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$n_rmse + Athabasca_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$n_rmse - Athabasca_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$n_rmse + Athabasca_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$n_rmse - Athabasca_stats_var_width$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$n_rmse + Athabasca_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_corr_Q$n_rmse[1:46], col = "red", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$n_rmse - Athabasca_stats_corr_Q$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$n_rmse + Athabasca_stats_corr_Q$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "red")

#p_bias
boxplot(p_bias~num_xs,
        data= Athabasca_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Athabasca_corr_Q$Q)), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$p_bias - Athabasca_stats_invar_width$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$p_bias + Athabasca_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$p_bias - Athabasca_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$p_bias + Athabasca_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$p_bias - Athabasca_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$p_bias + Athabasca_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$p_bias - Athabasca_stats_var_width$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$p_bias + Athabasca_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_corr_Q$p_bias[1:46], col = "red", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$p_bias - Athabasca_stats_corr_Q$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$p_bias + Athabasca_stats_corr_Q$p_bias_sd, length=0.05, angle=90, code=3,
       col = "red")

par(xpd = NA)
legend(63, 4, legend = c("DEM Width", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                                 "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("red", "blue", "purple", "magenta","orange", "aquamarine4"))

#Plot 10 time steps to show tradeoff better-------------

par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Athabasca_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$kge - Athabasca_stats_invar_width$kge_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$kge + Athabasca_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$kge - Athabasca_stats_invar_width_priors$kge_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$kge + Athabasca_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$kge - Athabasca_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$kge + Athabasca_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$kge - Athabasca_stats_var_width$kge_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$kge + Athabasca_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_corr_Q$kge[1:46], col = "red", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$kge - Athabasca_stats_corr_Q$kge_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$kge + Athabasca_stats_corr_Q$kge_sd, length=0.05, angle=90, code=3,
       col = "red")

#NSE
boxplot(nash~num_xs,
        data= Athabasca_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$nash - Athabasca_stats_invar_width$nash_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$nash + Athabasca_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$nash - Athabasca_stats_invar_width_priors$nash_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$nash + Athabasca_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$nash - Athabasca_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$nash + Athabasca_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$nash - Athabasca_stats_var_width$nash_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$nash + Athabasca_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_corr_Q$nash[1:46], col = "red", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$nash - Athabasca_stats_corr_Q$nash_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$nash + Athabasca_stats_corr_Q$nash_sd, length=0.05, angle=90, code=3,
       col = "red")

#rrmse
boxplot(rrmse~num_xs,
        data= Athabasca_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$rrmse - Athabasca_stats_invar_width$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$rrmse + Athabasca_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$rrmse - Athabasca_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$rrmse + Athabasca_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$rrmse - Athabasca_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$rrmse + Athabasca_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$rrmse - Athabasca_stats_var_width$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$rrmse + Athabasca_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_corr_Q$rrmse[1:46], col = "red", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$rrmse - Athabasca_stats_corr_Q$rrmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$rrmse + Athabasca_stats_corr_Q$rrmse_sd, length=0.05, angle=90, code=3,
       col = "red")

#n_rmse
boxplot(n_rmse~num_xs,
        data= Athabasca_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(.8, 2)
)
axis(1, at = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$n_rmse - Athabasca_stats_invar_width$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$n_rmse + Athabasca_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$n_rmse - Athabasca_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$n_rmse + Athabasca_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$n_rmse - Athabasca_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$n_rmse + Athabasca_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$n_rmse - Athabasca_stats_var_width$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$n_rmse + Athabasca_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_corr_Q$n_rmse[1:46], col = "red", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$n_rmse - Athabasca_stats_corr_Q$n_rmse_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$n_rmse + Athabasca_stats_corr_Q$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "red")

#p_bias
boxplot(p_bias~num_xs,
        data= Athabasca_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Athabasca_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$p_bias - Athabasca_stats_invar_width$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width$p_bias + Athabasca_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$p_bias - Athabasca_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_priors$p_bias + Athabasca_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$p_bias - Athabasca_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_invar_width_Qpriors$p_bias + Athabasca_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$p_bias - Athabasca_stats_var_width$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_var_width$p_bias + Athabasca_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Athabasca_WSE_corrQ)-1)), Athabasca_stats_corr_Q$p_bias[1:46], col = "red", pch = 19)
arrows(c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$p_bias - Athabasca_stats_corr_Q$p_bias_sd, c(0:(nrow(Athabasca_WSE_corrQ)-1)), 
       Athabasca_stats_corr_Q$p_bias + Athabasca_stats_corr_Q$p_bias_sd, length=0.05, angle=90, code=3,
       col = "red")
par(xpd = NA)
legend(14, 4, legend = c("DEM Width", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("red", "blue", "purple", "magenta","orange", "aquamarine4"))

#Plot multiple error metric comparison------
#2 discharge samples-----
Athabasca_temp_gauge_all_kge_2 <- na.omit(Athabasca_gauge_all$kge[Athabasca_gauge_all$num_xs == 1.9])
Athabasca_temp_gauge_all_nash_2 <- na.omit(Athabasca_gauge_all$nash[Athabasca_gauge_all$num_xs == 1.9])
Athabasca_temp_gauge_all_rrmse_2 <- na.omit(Athabasca_gauge_all$rrmse[Athabasca_gauge_all$num_xs == 1.9])
Athabasca_temp_gauge_all_n_rmse_2 <- na.omit(Athabasca_gauge_all$n_rmse[Athabasca_gauge_all$num_xs == 1.9])
Athabasca_temp_gauge_all_p_bias_2 <- na.omit(Athabasca_gauge_all$p_bias[Athabasca_gauge_all$num_xs == 1.9])

Athabasca_invar_width_kge_2 <- Athabasca_stats_invar_width$kge[c(1,2)]
Athabasca_invar_width_nash_2 <- Athabasca_stats_invar_width$nash[c(1,2)]
Athabasca_invar_width_rrmse_2 <- Athabasca_stats_invar_width$rrmse[c(1,2)]
Athabasca_invar_width_n_rmse_2 <- Athabasca_stats_invar_width$n_rmse[c(1,2)]
Athabasca_invar_width_p_bias_2 <- Athabasca_stats_invar_width$p_bias[c(1,2)]

Athabasca_var_width_kge_2 <- Athabasca_stats_var_width$kge[c(1,2)]
Athabasca_var_width_nash_2 <- Athabasca_stats_var_width$nash[c(1,2)]
Athabasca_var_width_rrmse_2 <- Athabasca_stats_var_width$rrmse[c(1,2)]
Athabasca_var_width_n_rmse_2 <- Athabasca_stats_var_width$n_rmse[c(1,2)]
Athabasca_var_width_p_bias_2 <- Athabasca_stats_var_width$p_bias[c(1,2)]

Athabasca_invar_width_priors_kge_2 <- Athabasca_stats_invar_width_priors$kge[c(1,2)]
Athabasca_invar_width_priors_nash_2 <- Athabasca_stats_invar_width_priors$nash[c(1,2)]
Athabasca_invar_width_priors_rrmse_2 <- Athabasca_stats_invar_width_priors$rrmse[c(1,2)]
Athabasca_invar_width_priors_n_rmse_2 <- Athabasca_stats_invar_width_priors$n_rmse[c(1,2)]
Athabasca_invar_width_priors_p_bias_2 <- Athabasca_stats_invar_width_priors$p_bias[c(1,2)]

Athabasca_invar_width_Qpriors_kge_2 <- Athabasca_stats_invar_width_Qpriors$kge[c(1,2)]
Athabasca_invar_width_Qpriors_nash_2 <- Athabasca_stats_invar_width_Qpriors$nash[c(1,2)]
Athabasca_invar_width_Qpriors_rrmse_2 <- Athabasca_stats_invar_width_Qpriors$rrmse[c(1,2)]
Athabasca_invar_width_Qpriors_n_rmse_2 <- Athabasca_stats_invar_width_Qpriors$n_rmse[c(1,2)]
Athabasca_invar_width_Qpriors_p_bias_2 <- Athabasca_stats_invar_width_Qpriors$p_bias[c(1,2)]

Athabasca_corr_Q_kge_2 <- Athabasca_stats_corr_Q$kge[c(1,2)]
Athabasca_corr_Q_nash_2 <- Athabasca_stats_corr_Q$nash[c(1,2)]
Athabasca_corr_Q_rrmse_2 <- Athabasca_stats_corr_Q$rrmse[c(1,2)]
Athabasca_corr_Q_n_rmse_2 <- Athabasca_stats_corr_Q$n_rmse[c(1,2)]
Athabasca_corr_Q_p_bias_2 <- Athabasca_stats_corr_Q$p_bias[c(1,2)]

dev.off()
par(mfrow = c(2,2))
par(family = "serif")
boxplot(Athabasca_temp_gauge_all_kge_2, Athabasca_corr_Q_kge_2, Athabasca_invar_width_kge_2, Athabasca_invar_width_priors_kge_2, 
        Athabasca_invar_width_Qpriors_kge_2, Athabasca_var_width_kge_2, 
        Athabasca_temp_gauge_all_nash_2, Athabasca_corr_Q_nash_2, Athabasca_invar_width_nash_2, Athabasca_invar_width_priors_nash_2, 
        Athabasca_invar_width_Qpriors_nash_2, Athabasca_var_width_nash_2, 
        Athabasca_temp_gauge_all_rrmse_2, Athabasca_corr_Q_rrmse_2, Athabasca_invar_width_rrmse_2, Athabasca_invar_width_priors_rrmse_2, 
        Athabasca_invar_width_Qpriors_rrmse_2, Athabasca_var_width_rrmse_2, 
        Athabasca_temp_gauge_all_n_rmse_2, Athabasca_corr_Q_n_rmse_2, Athabasca_invar_width_n_rmse_2, Athabasca_invar_width_priors_n_rmse_2, 
        Athabasca_invar_width_Qpriors_n_rmse_2, Athabasca_var_width_n_rmse_2, 
        Athabasca_temp_gauge_all_p_bias_2, Athabasca_corr_Q_p_bias_2, Athabasca_invar_width_p_bias_2, Athabasca_invar_width_priors_p_bias_2, 
        Athabasca_invar_width_Qpriors_p_bias_2, Athabasca_var_width_p_bias_2, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "red", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:6, 8:13, 15:20, 22:27, 29:34))
axis(1, at = seq(3, 34, 7), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
#3-5 discharge samples------
Athabasca_temp_gauge_all_kge_5 <- na.omit(Athabasca_gauge_all$kge[Athabasca_gauge_all$num_xs > 1.9 & Athabasca_gauge_all$num_xs < 6.9])
Athabasca_temp_gauge_all_nash_5 <- na.omit(Athabasca_gauge_all$nash[Athabasca_gauge_all$num_xs > 1.9 & Athabasca_gauge_all$num_xs < 6.9])
Athabasca_temp_gauge_all_rrmse_5 <- na.omit(Athabasca_gauge_all$rrmse[Athabasca_gauge_all$num_xs > 1.9 & Athabasca_gauge_all$num_xs < 6.9])
Athabasca_temp_gauge_all_n_rmse_5 <- na.omit(Athabasca_gauge_all$n_rmse[Athabasca_gauge_all$num_xs > 1.9 & Athabasca_gauge_all$num_xs < 6.9])
Athabasca_temp_gauge_all_p_bias_5 <- na.omit(Athabasca_gauge_all$p_bias[Athabasca_gauge_all$num_xs > 1.9 & Athabasca_gauge_all$num_xs < 6.9])

Athabasca_invar_width_kge_5 <- Athabasca_stats_invar_width$kge[c(3:5)]
Athabasca_invar_width_nash_5 <- Athabasca_stats_invar_width$nash[c(3:5)]
Athabasca_invar_width_rrmse_5 <- Athabasca_stats_invar_width$rrmse[c(3:5)]
Athabasca_invar_width_n_rmse_5 <- Athabasca_stats_invar_width$n_rmse[c(3:5)]
Athabasca_invar_width_p_bias_5 <- Athabasca_stats_invar_width$p_bias[c(3:5)]

Athabasca_var_width_kge_5 <- Athabasca_stats_var_width$kge[c(3:5)]
Athabasca_var_width_nash_5 <- Athabasca_stats_var_width$nash[c(3:5)]
Athabasca_var_width_rrmse_5 <- Athabasca_stats_var_width$rrmse[c(3:5)]
Athabasca_var_width_n_rmse_5 <- Athabasca_stats_var_width$n_rmse[c(3:5)]
Athabasca_var_width_p_bias_5 <- Athabasca_stats_var_width$p_bias[c(3:5)]

Athabasca_invar_width_priors_kge_5 <- Athabasca_stats_invar_width_priors$kge[c(3:5)]
Athabasca_invar_width_priors_nash_5 <- Athabasca_stats_invar_width_priors$nash[c(3:5)]
Athabasca_invar_width_priors_rrmse_5 <- Athabasca_stats_invar_width_priors$rrmse[c(3:5)]
Athabasca_invar_width_priors_n_rmse_5 <- Athabasca_stats_invar_width_priors$n_rmse[c(3:5)]
Athabasca_invar_width_priors_p_bias_5 <- Athabasca_stats_invar_width_priors$p_bias[c(3:5)]

Athabasca_invar_width_Qpriors_kge_5 <- Athabasca_stats_invar_width_Qpriors$kge[c(3:5)]
Athabasca_invar_width_Qpriors_nash_5 <- Athabasca_stats_invar_width_Qpriors$nash[c(3:5)]
Athabasca_invar_width_Qpriors_rrmse_5 <- Athabasca_stats_invar_width_Qpriors$rrmse[c(3:5)]
Athabasca_invar_width_Qpriors_n_rmse_5 <- Athabasca_stats_invar_width_Qpriors$n_rmse[c(3:5)]
Athabasca_invar_width_Qpriors_p_bias_5 <- Athabasca_stats_invar_width_Qpriors$p_bias[c(3:5)]

Athabasca_corr_Q_kge_5 <- Athabasca_stats_corr_Q$kge[c(3:5)]
Athabasca_corr_Q_nash_5 <- Athabasca_stats_corr_Q$nash[c(3:5)]
Athabasca_corr_Q_rrmse_5 <- Athabasca_stats_corr_Q$rrmse[c(3:5)]
Athabasca_corr_Q_n_rmse_5 <- Athabasca_stats_corr_Q$n_rmse[c(3:5)]
Athabasca_corr_Q_p_bias_5 <- Athabasca_stats_corr_Q$p_bias[c(3:5)]

boxplot(Athabasca_temp_gauge_all_kge_5, Athabasca_corr_Q_kge_5, Athabasca_invar_width_kge_5, Athabasca_invar_width_priors_kge_5, 
        Athabasca_invar_width_Qpriors_kge_5, Athabasca_var_width_kge_5, 
        Athabasca_temp_gauge_all_nash_5, Athabasca_corr_Q_nash_5, Athabasca_invar_width_nash_5, Athabasca_invar_width_priors_nash_5, 
        Athabasca_invar_width_Qpriors_nash_5, Athabasca_var_width_nash_5, 
        Athabasca_temp_gauge_all_rrmse_5, Athabasca_corr_Q_rrmse_5, Athabasca_invar_width_rrmse_5, Athabasca_invar_width_priors_rrmse_5, 
        Athabasca_invar_width_Qpriors_rrmse_5, Athabasca_var_width_rrmse_5, 
        Athabasca_temp_gauge_all_n_rmse_5, Athabasca_corr_Q_n_rmse_5, Athabasca_invar_width_n_rmse_5, Athabasca_invar_width_priors_n_rmse_5, 
        Athabasca_invar_width_Qpriors_n_rmse_5, Athabasca_var_width_n_rmse_5, 
        Athabasca_temp_gauge_all_p_bias_5, Athabasca_corr_Q_p_bias_5, Athabasca_invar_width_p_bias_5, Athabasca_invar_width_priors_p_bias_5, 
        Athabasca_invar_width_Qpriors_p_bias_5, Athabasca_var_width_p_bias_5, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "red", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:6, 8:13, 15:20, 22:27, 29:34))
axis(1, at = seq(3, 34, 7), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#6-10 discharge samples
Athabasca_temp_gauge_all_kge_10 <- na.omit(Athabasca_gauge_all$kge[Athabasca_gauge_all$num_xs > 5.9 & Athabasca_gauge_all$num_xs < 11.9])
Athabasca_temp_gauge_all_nash_10 <- na.omit(Athabasca_gauge_all$nash[Athabasca_gauge_all$num_xs > 5.9 & Athabasca_gauge_all$num_xs < 11.9])
Athabasca_temp_gauge_all_rrmse_10 <- na.omit(Athabasca_gauge_all$rrmse[Athabasca_gauge_all$num_xs > 5.9 & Athabasca_gauge_all$num_xs < 11.9])
Athabasca_temp_gauge_all_n_rmse_10 <- na.omit(Athabasca_gauge_all$n_rmse[Athabasca_gauge_all$num_xs > 5.9 & Athabasca_gauge_all$num_xs < 11.9])
Athabasca_temp_gauge_all_p_bias_10 <- na.omit(Athabasca_gauge_all$p_bias[Athabasca_gauge_all$num_xs > 5.9 & Athabasca_gauge_all$num_xs < 11.9])

Athabasca_invar_width_kge_10 <- Athabasca_stats_invar_width$kge[c(6:10)]
Athabasca_invar_width_nash_10 <- Athabasca_stats_invar_width$nash[c(6:10)]
Athabasca_invar_width_rrmse_10 <- Athabasca_stats_invar_width$rrmse[c(6:10)]
Athabasca_invar_width_n_rmse_10 <- Athabasca_stats_invar_width$n_rmse[c(6:10)]
Athabasca_invar_width_p_bias_10 <- Athabasca_stats_invar_width$p_bias[c(6:10)]

Athabasca_var_width_kge_10 <- Athabasca_stats_var_width$kge[c(6:10)]
Athabasca_var_width_nash_10 <- Athabasca_stats_var_width$nash[c(6:10)]
Athabasca_var_width_rrmse_10 <- Athabasca_stats_var_width$rrmse[c(6:10)]
Athabasca_var_width_n_rmse_10 <- Athabasca_stats_var_width$n_rmse[c(6:10)]
Athabasca_var_width_p_bias_10 <- Athabasca_stats_var_width$p_bias[c(6:10)]

Athabasca_invar_width_priors_kge_10 <- Athabasca_stats_invar_width_priors$kge[c(6:10)]
Athabasca_invar_width_priors_nash_10 <- Athabasca_stats_invar_width_priors$nash[c(6:10)]
Athabasca_invar_width_priors_rrmse_10 <- Athabasca_stats_invar_width_priors$rrmse[c(6:10)]
Athabasca_invar_width_priors_n_rmse_10 <- Athabasca_stats_invar_width_priors$n_rmse[c(6:10)]
Athabasca_invar_width_priors_p_bias_10 <- Athabasca_stats_invar_width_priors$p_bias[c(6:10)]

Athabasca_invar_width_Qpriors_kge_10 <- Athabasca_stats_invar_width_Qpriors$kge[c(6:10)]
Athabasca_invar_width_Qpriors_nash_10 <- Athabasca_stats_invar_width_Qpriors$nash[c(6:10)]
Athabasca_invar_width_Qpriors_rrmse_10 <- Athabasca_stats_invar_width_Qpriors$rrmse[c(6:10)]
Athabasca_invar_width_Qpriors_n_rmse_10 <- Athabasca_stats_invar_width_Qpriors$n_rmse[c(6:10)]
Athabasca_invar_width_Qpriors_p_bias_10 <- Athabasca_stats_invar_width_Qpriors$p_bias[c(6:10)]

Athabasca_corr_Q_kge_10 <- Athabasca_stats_corr_Q$kge[c(6:10)]
Athabasca_corr_Q_nash_10 <- Athabasca_stats_corr_Q$nash[c(6:10)]
Athabasca_corr_Q_rrmse_10 <- Athabasca_stats_corr_Q$rrmse[c(6:10)]
Athabasca_corr_Q_n_rmse_10 <- Athabasca_stats_corr_Q$n_rmse[c(6:10)]
Athabasca_corr_Q_p_bias_10 <- Athabasca_stats_corr_Q$p_bias[c(6:10)]

boxplot(Athabasca_temp_gauge_all_kge_10, Athabasca_corr_Q_kge_10, Athabasca_invar_width_kge_10, Athabasca_invar_width_priors_kge_10, 
        Athabasca_invar_width_Qpriors_kge_10, Athabasca_var_width_kge_10, 
        Athabasca_temp_gauge_all_nash_10, Athabasca_corr_Q_nash_10, Athabasca_invar_width_nash_10, Athabasca_invar_width_priors_nash_10, 
        Athabasca_invar_width_Qpriors_nash_10, Athabasca_var_width_nash_10, 
        Athabasca_temp_gauge_all_rrmse_10, Athabasca_corr_Q_rrmse_10, Athabasca_invar_width_rrmse_10, Athabasca_invar_width_priors_rrmse_10, 
        Athabasca_invar_width_Qpriors_rrmse_10, Athabasca_var_width_rrmse_10, 
        Athabasca_temp_gauge_all_n_rmse_10, Athabasca_corr_Q_n_rmse_10, Athabasca_invar_width_n_rmse_10, Athabasca_invar_width_priors_n_rmse_10, 
        Athabasca_invar_width_Qpriors_n_rmse_10, Athabasca_var_width_n_rmse_10, 
        Athabasca_temp_gauge_all_p_bias_10, Athabasca_corr_Q_p_bias_10, Athabasca_invar_width_p_bias_10, Athabasca_invar_width_priors_p_bias_10, 
        Athabasca_invar_width_Qpriors_p_bias_10, Athabasca_var_width_p_bias_10, 
        ylim = c(-5,2), 
        col = c("aquamarine4", "red", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:6, 8:13, 15:20, 22:27, 29:34))
axis(1, at = seq(3, 34, 7), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#11-46 discharge samples
Athabasca_temp_gauge_all_kge_46 <- na.omit(Athabasca_gauge_all$kge[Athabasca_gauge_all$num_xs > 10.9])
Athabasca_temp_gauge_all_nash_46 <- na.omit(Athabasca_gauge_all$nash[Athabasca_gauge_all$num_xs > 10.9])
Athabasca_temp_gauge_all_rrmse_46 <- na.omit(Athabasca_gauge_all$rrmse[Athabasca_gauge_all$num_xs > 10.9])
Athabasca_temp_gauge_all_n_rmse_46 <- na.omit(Athabasca_gauge_all$r_rmse[Athabasca_gauge_all$num_xs > 10.9])
Athabasca_temp_gauge_all_p_bias_46 <- na.omit(Athabasca_gauge_all$p_bias[Athabasca_gauge_all$num_xs > 10.9])

Athabasca_invar_width_kge_46 <- Athabasca_stats_invar_width$kge[c(11:46)]
Athabasca_invar_width_nash_46 <- Athabasca_stats_invar_width$nash[c(11:46)]
Athabasca_invar_width_rrmse_46 <- Athabasca_stats_invar_width$rrmse[c(11:46)]
Athabasca_invar_width_n_rmse_46 <- Athabasca_stats_invar_width$n_rmse[c(11:46)]
Athabasca_invar_width_p_bias_46 <- Athabasca_stats_invar_width$p_bias[c(11:46)]

Athabasca_var_width_kge_46 <- Athabasca_stats_var_width$kge[c(11:46)]
Athabasca_var_width_nash_46 <- Athabasca_stats_var_width$nash[c(11:46)]
Athabasca_var_width_rrmse_46 <- Athabasca_stats_var_width$rrmse[c(11:46)]
Athabasca_var_width_n_rmse_46 <- Athabasca_stats_var_width$n_rmse[c(11:46)]
Athabasca_var_width_p_bias_46 <- Athabasca_stats_var_width$p_bias[c(11:46)]

Athabasca_invar_width_priors_kge_46 <- Athabasca_stats_invar_width_priors$kge[c(11:46)]
Athabasca_invar_width_priors_nash_46 <- Athabasca_stats_invar_width_priors$nash[c(11:46)]
Athabasca_invar_width_priors_rrmse_46 <- Athabasca_stats_invar_width_priors$rrmse[c(11:46)]
Athabasca_invar_width_priors_n_rmse_46 <- Athabasca_stats_invar_width_priors$n_rmse[c(11:46)]
Athabasca_invar_width_priors_p_bias_46 <- Athabasca_stats_invar_width_priors$p_bias[c(11:46)]

Athabasca_invar_width_Qpriors_kge_46 <- Athabasca_stats_invar_width_Qpriors$kge[c(11:46)]
Athabasca_invar_width_Qpriors_nash_46 <- Athabasca_stats_invar_width_Qpriors$nash[c(11:46)]
Athabasca_invar_width_Qpriors_rrmse_46 <- Athabasca_stats_invar_width_Qpriors$rrmse[c(11:46)]
Athabasca_invar_width_Qpriors_n_rmse_46 <- Athabasca_stats_invar_width_Qpriors$n_rmse[c(11:46)]
Athabasca_invar_width_Qpriors_p_bias_46 <- Athabasca_stats_invar_width_Qpriors$p_bias[c(11:46)]

Athabasca_corr_Q_kge_46 <- Athabasca_stats_corr_Q$kge[c(11:46)]
Athabasca_corr_Q_nash_46 <- Athabasca_stats_corr_Q$nash[c(11:46)]
Athabasca_corr_Q_rrmse_46 <- Athabasca_stats_corr_Q$rrmse[c(11:46)]
Athabasca_corr_Q_n_rmse_46 <- Athabasca_stats_corr_Q$n_rmse[c(11:46)]
Athabasca_corr_Q_p_bias_46 <- Athabasca_stats_corr_Q$p_bias[c(11:46)]

boxplot(Athabasca_temp_gauge_all_kge_46, Athabasca_corr_Q_kge_46, Athabasca_invar_width_kge_46, Athabasca_invar_width_priors_kge_46, 
        Athabasca_invar_width_Qpriors_kge_46, Athabasca_var_width_kge_46, 
        Athabasca_temp_gauge_all_nash_46, Athabasca_corr_Q_nash_46, Athabasca_invar_width_nash_46, Athabasca_invar_width_priors_nash_46, 
        Athabasca_invar_width_Qpriors_nash_46, Athabasca_var_width_nash_46, 
        Athabasca_temp_gauge_all_rrmse_46, Athabasca_corr_Q_rrmse_46, Athabasca_invar_width_rrmse_46, Athabasca_invar_width_priors_rrmse_46, 
        Athabasca_invar_width_Qpriors_rrmse_46, Athabasca_var_width_rrmse_46, 
        Athabasca_temp_gauge_all_n_rmse_46, Athabasca_corr_Q_n_rmse_46, Athabasca_invar_width_n_rmse_46, Athabasca_invar_width_priors_n_rmse_46, 
        Athabasca_invar_width_Qpriors_n_rmse_46, Athabasca_var_width_n_rmse_46, 
        Athabasca_temp_gauge_all_p_bias_46, Athabasca_corr_Q_p_bias_46, Athabasca_invar_width_p_bias_46, Athabasca_invar_width_priors_p_bias_46, 
        Athabasca_invar_width_Qpriors_p_bias_46, Athabasca_var_width_p_bias_46, 
        ylim = c(-5,2), 
        col = c("aquamarine4", "red", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:6, 8:13, 15:20, 22:27, 29:34))
axis(1, at = seq(3, 34, 7), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#Remake plots only ranging from -1 to 0.5
boxplot(Athabasca_temp_gauge_all_kge_2, Athabasca_corr_Q_kge_2, Athabasca_invar_width_kge_2, Athabasca_invar_width_priors_kge_2, 
        Athabasca_invar_width_Qpriors_kge_2, Athabasca_var_width_kge_2, 
        Athabasca_temp_gauge_all_nash_2, Athabasca_corr_Q_nash_2, Athabasca_invar_width_nash_2, Athabasca_invar_width_priors_nash_2, 
        Athabasca_invar_width_Qpriors_nash_2, Athabasca_var_width_nash_2, 
        Athabasca_temp_gauge_all_rrmse_2, Athabasca_corr_Q_rrmse_2, Athabasca_invar_width_rrmse_2, Athabasca_invar_width_priors_rrmse_2, 
        Athabasca_invar_width_Qpriors_rrmse_2, Athabasca_var_width_rrmse_2, 
        Athabasca_temp_gauge_all_n_rmse_2, Athabasca_corr_Q_n_rmse_2, Athabasca_invar_width_n_rmse_2, Athabasca_invar_width_priors_n_rmse_2, 
        Athabasca_invar_width_Qpriors_n_rmse_2, Athabasca_var_width_n_rmse_2, 
        Athabasca_temp_gauge_all_p_bias_2, Athabasca_corr_Q_p_bias_2, Athabasca_invar_width_p_bias_2, Athabasca_invar_width_priors_p_bias_2, 
        Athabasca_invar_width_Qpriors_p_bias_2, Athabasca_var_width_p_bias_2, 
        ylim = c(-1,0.5), 
        col = c("aquamarine4", "red", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:6, 8:13, 15:20, 22:27, 29:34))
axis(1, at = seq(3, 34, 7), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Athabasca_temp_gauge_all_kge_5, Athabasca_corr_Q_kge_5, Athabasca_invar_width_kge_5, Athabasca_invar_width_priors_kge_5, 
        Athabasca_invar_width_Qpriors_kge_5, Athabasca_var_width_kge_5, 
        Athabasca_temp_gauge_all_nash_5, Athabasca_corr_Q_nash_5, Athabasca_invar_width_nash_5, Athabasca_invar_width_priors_nash_5, 
        Athabasca_invar_width_Qpriors_nash_5, Athabasca_var_width_nash_5, 
        Athabasca_temp_gauge_all_rrmse_5, Athabasca_corr_Q_rrmse_5, Athabasca_invar_width_rrmse_5, Athabasca_invar_width_priors_rrmse_5, 
        Athabasca_invar_width_Qpriors_rrmse_5, Athabasca_var_width_rrmse_5, 
        Athabasca_temp_gauge_all_n_rmse_5, Athabasca_corr_Q_n_rmse_5, Athabasca_invar_width_n_rmse_5, Athabasca_invar_width_priors_n_rmse_5, 
        Athabasca_invar_width_Qpriors_n_rmse_5, Athabasca_var_width_n_rmse_5, 
        Athabasca_temp_gauge_all_p_bias_5, Athabasca_corr_Q_p_bias_5, Athabasca_invar_width_p_bias_5, Athabasca_invar_width_priors_p_bias_5, 
        Athabasca_invar_width_Qpriors_p_bias_5, Athabasca_var_width_p_bias_5, 
        ylim = c(-1, 0.5), 
        col = c("aquamarine4", "red", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:6, 8:13, 15:20, 22:27, 29:34))
axis(1, at = seq(3, 34, 7), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Athabasca_temp_gauge_all_kge_10, Athabasca_corr_Q_kge_10, Athabasca_invar_width_kge_10, Athabasca_invar_width_priors_kge_10, 
        Athabasca_invar_width_Qpriors_kge_10, Athabasca_var_width_kge_10, 
        Athabasca_temp_gauge_all_nash_10, Athabasca_corr_Q_nash_10, Athabasca_invar_width_nash_10, Athabasca_invar_width_priors_nash_10, 
        Athabasca_invar_width_Qpriors_nash_10, Athabasca_var_width_nash_10, 
        Athabasca_temp_gauge_all_rrmse_10, Athabasca_corr_Q_rrmse_10, Athabasca_invar_width_rrmse_10, Athabasca_invar_width_priors_rrmse_10, 
        Athabasca_invar_width_Qpriors_rrmse_10, Athabasca_var_width_rrmse_10, 
        Athabasca_temp_gauge_all_n_rmse_10, Athabasca_corr_Q_n_rmse_10, Athabasca_invar_width_n_rmse_10, Athabasca_invar_width_priors_n_rmse_10, 
        Athabasca_invar_width_Qpriors_n_rmse_10, Athabasca_var_width_n_rmse_10, 
        Athabasca_temp_gauge_all_p_bias_10, Athabasca_corr_Q_p_bias_10, Athabasca_invar_width_p_bias_10, Athabasca_invar_width_priors_p_bias_10, 
        Athabasca_invar_width_Qpriors_p_bias_10, Athabasca_var_width_p_bias_10, 
        ylim = c(-1,0.5), 
        col = c("aquamarine4", "red", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:6, 8:13, 15:20, 22:27, 29:34))
axis(1, at = seq(3, 34, 7), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Athabasca_temp_gauge_all_kge_46, Athabasca_corr_Q_kge_46, Athabasca_invar_width_kge_46, Athabasca_invar_width_priors_kge_46, 
        Athabasca_invar_width_Qpriors_kge_46, Athabasca_var_width_kge_46, 
        Athabasca_temp_gauge_all_nash_46, Athabasca_corr_Q_nash_46, Athabasca_invar_width_nash_46, Athabasca_invar_width_priors_nash_46, 
        Athabasca_invar_width_Qpriors_nash_46, Athabasca_var_width_nash_46, 
        Athabasca_temp_gauge_all_rrmse_46, Athabasca_corr_Q_rrmse_46, Athabasca_invar_width_rrmse_46, Athabasca_invar_width_priors_rrmse_46, 
        Athabasca_invar_width_Qpriors_rrmse_46, Athabasca_var_width_rrmse_46, 
        Athabasca_temp_gauge_all_n_rmse_46, Athabasca_corr_Q_n_rmse_46, Athabasca_invar_width_n_rmse_46, Athabasca_invar_width_priors_n_rmse_46, 
        Athabasca_invar_width_Qpriors_n_rmse_46, Athabasca_var_width_n_rmse_46, 
        Athabasca_temp_gauge_all_p_bias_46, Athabasca_corr_Q_p_bias_46, Athabasca_invar_width_p_bias_46, Athabasca_invar_width_priors_p_bias_46, 
        Athabasca_invar_width_Qpriors_p_bias_46, Athabasca_var_width_p_bias_46, 
        ylim = c(-1,0.5), 
        col = c("aquamarine4", "red", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:6, 8:13, 15:20, 22:27, 29:34))
axis(1, at = seq(3, 34, 7), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")


#Plot hydrographs ensemble


###Coupe------
#load WSE
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT/Coupe/WSE")
Coupe_WSE <- read.csv("Coupe_WSE_PPP_corr.csv")
Coupe_WSE <- Coupe_WSE %>%
  mutate(day = as.Date(new_time, format="%Y-%m-%d"))
Coupe_WSE_daily <- aggregate(. ~day, data = Coupe_WSE, mean, na.rm = TRUE)[,c(4:ncol(Coupe_WSE))]

#load Q
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe")
Coupe_corr_Q <- read.csv("Coupe_corr_Q.csv")
Coupe_corr_Q <- Coupe_corr_Q %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Coupe_qobs_daily <- aggregate(. ~day, data = Coupe_corr_Q[,c(6,8,9,14)], 
                                  mean, na.rm = TRUE)[,2]
par(family = "serif")
plot(as.POSIXct(Coupe_corr_Q$new_date), Coupe_corr_Q$Q, xlab = "Date", ylab = "Discharge (m^3/s)", 
     main = "Coupe ADCP hydrograph", pch = 19)
#load cl and PT coords
setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe", sep =""))
Coupe_cl <-readOGR(dsn = ".", layer = "Coupe_CL_UTM")

setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT", sep =""))
Coupe_PT_coords <- read.csv("Coupe_PT_coords.csv")
Coupe_PT_coords_sp <-SpatialPoints(Coupe_PT_coords[,4:5], 
                                       proj4string = crs('+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0' ))
#calculate the distance between pts
Coupe_xvec <- calc_xvec(Coupe_PT_coords_sp, Coupe_cl)
save(Coupe_xvec, file = "Coupe_xvec.RData")
#find overlapping ADCP and PT times
Coupe_closest_time <- vector(length = length(Coupe_corr_Q$new_date))
for(i in 1:length(Coupe_corr_Q$new_date)){
  Coupe_closest_time[i] = which.min(abs(as.POSIXct(Coupe_WSE$new_time, tz = "MST") - 
                                              as.POSIXct(Coupe_corr_Q$new_date[i], tz = "MST")))
}

Coupe_WSE_corrQ <- Coupe_WSE[c(Coupe_closest_time[order(Coupe_closest_time)]),c(3:7)]

#Calculate slope
Coupe_slope <- -1*calcslope(sort(Coupe_xvec[1:5]), hmat = t(Coupe_WSE_corrQ[, order(Coupe_xvec[1:5])]))
Coupe_slope[1,] <- colMeans(Coupe_slope, na.rm = TRUE)

#Run BAM
pt = proc.time()
Coupe_bam_invar_width <- run_bam_invar_width_default(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_invar_width",
                                                         slope =  Coupe_slope, qobs = Coupe_corr_Q, rivname = "Coupe",
                                                         minQ = min(Coupe_corr_Q$Q), maxQ = max(Coupe_corr_Q$Q),
                                                         wse = Coupe_WSE_corrQ)
library(hydroGOF)
Coupe_val_invar_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_invar_width",
                                     Coupe_corr_Q$Q)
Coupe_val_invar_width <- Coupe_val_invar_width[order(Coupe_val_invar_width$num_xs),]
Coupe_stats_invar_width <- bam_val_stats(Coupe_val_invar_width)
Coupe_plot_invar_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_invar_width",
                                       Coupe_corr_Q$Q)
proc.time()-pt

#With new priors
pt = proc.time()
Coupe_bam_invar_width_priors <- run_bam_invar_width_Q(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_invar_width_Qpriors_10",
                                                          slope =  Coupe_slope, qobs = Coupe_corr_Q, rivname = "Coupe",
                                                          minQ = 0.75* min(Coupe_corr_Q$Q), maxQ = 1.3*max(Coupe_corr_Q$Q),
                                                          wse = Coupe_WSE_corrQ)
library(hydroGOF)
Coupe_val_invar_width_priors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_invar_width_Qpriors_10",
                                            Coupe_corr_Q$Q)
Coupe_val_invar_width_priors <- Coupe_val_invar_width_priors[order(Coupe_val_invar_width_priors$num_xs),]
Coupe_stats_invar_width_priors <- bam_val_stats(Coupe_val_invar_width_priors)
Coupe_plot_invar_width_priors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_invar_width_Qpriors_10",
                                              Coupe_corr_Q$Q)
proc.time()-pt


#With new priors and Q prior
pt = proc.time()
Coupe_bam_invar_width_Qpriors <- run_bam_invar_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_invar_width_Qpriors",
                                                         slope =  Coupe_slope, qobs = Coupe_corr_Q, rivname = "Coupe",
                                                         wse = Coupe_WSE_corrQ)
library(hydroGOF)
Coupe_val_invar_width_Qpriors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_invar_width_Qpriors",
                                             Coupe_corr_Q$Q)
Coupe_val_invar_width_Qpriors <- Coupe_val_invar_width_Qpriors[order(Coupe_val_invar_width_Qpriors$num_xs),]
Coupe_stats_invar_width_Qpriors <- bam_val_stats(Coupe_val_invar_width_Qpriors)
Coupe_plot_invar_width_Qpriors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_invar_width_Qpriors",
                                               Coupe_corr_Q$Q)
proc.time()-pt

#var width
pt = proc.time()
Coupe_bam_var_width <- run_bam_var_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_var_width",
                                             slope =  Coupe_slope, qobs = Coupe_corr_Q, rivname = "Coupe",
                                             wse = Coupe_WSE_corrQ)
library(hydroGOF)
Coupe_val_var_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_var_width",
                                   Coupe_corr_Q$Q)
Coupe_val_var_width <- Coupe_val_var_width[order(Coupe_val_var_width$num_xs),]
Coupe_stats_var_width <- bam_val_stats(Coupe_val_var_width)
Coupe_plot_var_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_var_width",
                                     Coupe_corr_Q$Q)
proc.time()-pt


#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/Gauge_All")
Coupe_temp_gauge_all <- temporary_gauge_all(num_days = nrow(Coupe_WSE_corrQ), 
                                                pt_count = ncol(Coupe_WSE_corrQ), 
                                                file_name = "Coupe",
                                                WSE_mat = t(Coupe_WSE_corrQ), 
                                                Qobs = Coupe_corr_Q$Q)
Coupe_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/Gauge_All",
                                       Coupe_corr_Q$Q)

#Load BAM results from old method of estimating width from DEM
library(hydroGOF)
Coupe_val_corr_Q <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Coupe/BAM_corrQ",
                                Coupe_corr_Q$Q)
Coupe_val_corr_Q <- Coupe_val_corr_Q[order(Coupe_val_corr_Q$num_xs),]
Coupe_stats_corr_Q <- bam_val_stats(Coupe_val_corr_Q)
#KGE
png(filename = "Coupe", width = 13, height = 7.5, units = "in", res = 300)
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Coupe_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Coupe_stats_invar_width_priors$kge, col = "red", pch = 19)
arrows(c(0:9), 
       Coupe_stats_invar_width_priors$kge - Coupe_stats_invar_width_priors$kge_sd, c(0:9), 
       Coupe_stats_invar_width_priors$kge + Coupe_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "red")

#NSE
par(family = "serif")
boxplot(nash~num_xs,
        data= Coupe_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Coupe_stats_invar_width_priors$nash, col = "red", pch = 19)
arrows(c(0:9), 
       Coupe_stats_invar_width_priors$nash - Coupe_stats_invar_width_priors$nash_sd, c(0:9), 
       Coupe_stats_invar_width_priors$nash + Coupe_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "red")

#rrmse
par(family = "serif")
boxplot(rrmse~num_xs,
        data= Coupe_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(0.06, 0.5)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Coupe_stats_invar_width_priors$rrmse, col = "red", pch = 19)
arrows(c(0:9), 
       Coupe_stats_invar_width_priors$rrmse - Coupe_stats_invar_width_priors$rrmse_sd, c(0:9), 
       Coupe_stats_invar_width_priors$rrmse + Coupe_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "red")
#NRMSE
par(family = "serif")
boxplot(n_rmse~num_xs,
        data= Coupe_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(0.06, 0.5)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Coupe_stats_invar_width_priors$n_rmse, col = "red", pch = 19)
arrows(c(0:9), 
       Coupe_stats_invar_width_priors$n_rmse - Coupe_stats_invar_width_priors$n_rmse_sd, c(0:9), 
       Coupe_stats_invar_width_priors$n_rmse + Coupe_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "red")
#PBIAS
par(family = "serif")
boxplot(p_bias~num_xs,
        data= Coupe_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 9), 
        ylim= c(-0.1, 0.3)
)
axis(1, at = seq(0, 9, 1), 
     labels = seq(1, 10, 1), cex.axis = 1.5)
points(c(0:9), Coupe_stats_invar_width_priors$p_bias, col = "red", pch = 19)
arrows(c(0:9), 
       Coupe_stats_invar_width_priors$p_bias - Coupe_stats_invar_width_priors$p_bias_sd, c(0:9), 
       Coupe_stats_invar_width_priors$p_bias + Coupe_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "red")
dev.off()
#Plot total time and all error metrics--------
#KGE
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Coupe_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Coupe_corr_Q$Q)), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$kge - Coupe_stats_invar_width$kge_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$kge + Coupe_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$kge - Coupe_stats_invar_width_priors$kge_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$kge + Coupe_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$kge - Coupe_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$kge + Coupe_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$kge - Coupe_stats_var_width$kge_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$kge + Coupe_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Coupe_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Coupe_corr_Q$Q)), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$nash - Coupe_stats_invar_width$nash_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$nash + Coupe_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$nash - Coupe_stats_invar_width_priors$nash_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$nash + Coupe_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$nash - Coupe_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$nash + Coupe_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$nash - Coupe_stats_var_width$nash_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$nash + Coupe_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Coupe_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Coupe_corr_Q$Q)), 
        ylim= c(0.15, 0.25)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$rrmse - Coupe_stats_invar_width$rrmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$rrmse + Coupe_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$rrmse - Coupe_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$rrmse + Coupe_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$rrmse - Coupe_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$rrmse + Coupe_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$rrmse - Coupe_stats_var_width$rrmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$rrmse + Coupe_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Coupe_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Coupe_corr_Q$Q)), 
        ylim= c(0.8, 1.6)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$n_rmse - Coupe_stats_invar_width$n_rmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$n_rmse + Coupe_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$n_rmse - Coupe_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$n_rmse + Coupe_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$n_rmse - Coupe_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$n_rmse + Coupe_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$n_rmse - Coupe_stats_var_width$n_rmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$n_rmse + Coupe_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Coupe_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Coupe_corr_Q$Q)), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$p_bias - Coupe_stats_invar_width$p_bias_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$p_bias + Coupe_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$p_bias - Coupe_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$p_bias + Coupe_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$p_bias - Coupe_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$p_bias + Coupe_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$p_bias - Coupe_stats_var_width$p_bias_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$p_bias + Coupe_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(63, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot 10 time steps to show tradeoff better-------------
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Coupe_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$kge - Coupe_stats_invar_width$kge_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$kge + Coupe_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$kge - Coupe_stats_invar_width_priors$kge_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$kge + Coupe_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$kge - Coupe_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$kge + Coupe_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$kge - Coupe_stats_var_width$kge_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$kge + Coupe_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Coupe_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$nash - Coupe_stats_invar_width$nash_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$nash + Coupe_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$nash - Coupe_stats_invar_width_priors$nash_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$nash + Coupe_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$nash - Coupe_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$nash + Coupe_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$nash - Coupe_stats_var_width$nash_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$nash + Coupe_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Coupe_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$rrmse - Coupe_stats_invar_width$rrmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$rrmse + Coupe_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$rrmse - Coupe_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$rrmse + Coupe_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$rrmse - Coupe_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$rrmse + Coupe_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$rrmse - Coupe_stats_var_width$rrmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$rrmse + Coupe_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Coupe_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(80, 200)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$n_rmse - Coupe_stats_invar_width$n_rmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$n_rmse + Coupe_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$n_rmse - Coupe_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$n_rmse + Coupe_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$n_rmse - Coupe_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$n_rmse + Coupe_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$n_rmse - Coupe_stats_var_width$n_rmse_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$n_rmse + Coupe_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Coupe_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Coupe_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$p_bias - Coupe_stats_invar_width$p_bias_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width$p_bias + Coupe_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$p_bias - Coupe_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_priors$p_bias + Coupe_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$p_bias - Coupe_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_invar_width_Qpriors$p_bias + Coupe_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Coupe_WSE_corrQ)-1)), Coupe_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$p_bias - Coupe_stats_var_width$p_bias_sd, c(0:(nrow(Coupe_WSE_corrQ)-1)), 
       Coupe_stats_var_width$p_bias + Coupe_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(14, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot multiple error metric comparison------
#2 discharge samples-----
Coupe_temp_gauge_all_kge_2 <- na.omit(Coupe_gauge_all$kge[Coupe_gauge_all$num_xs == 1.9])
Coupe_temp_gauge_all_nash_2 <- na.omit(Coupe_gauge_all$nash[Coupe_gauge_all$num_xs == 1.9])
Coupe_temp_gauge_all_rrmse_2 <- na.omit(Coupe_gauge_all$rrmse[Coupe_gauge_all$num_xs == 1.9])
Coupe_temp_gauge_all_n_rmse_2 <- na.omit(Coupe_gauge_all$n_rmse[Coupe_gauge_all$num_xs == 1.9])
Coupe_temp_gauge_all_p_bias_2 <- na.omit(Coupe_gauge_all$p_bias[Coupe_gauge_all$num_xs == 1.9])

Coupe_invar_width_kge_2 <- Coupe_stats_invar_width$kge[c(1,2)]
Coupe_invar_width_nash_2 <- Coupe_stats_invar_width$nash[c(1,2)]
Coupe_invar_width_rrmse_2 <- Coupe_stats_invar_width$rrmse[c(1,2)]
Coupe_invar_width_n_rmse_2 <- Coupe_stats_invar_width$n_rmse[c(1,2)]
Coupe_invar_width_p_bias_2 <- Coupe_stats_invar_width$p_bias[c(1,2)]

Coupe_var_width_kge_2 <- Coupe_stats_var_width$kge[c(1,2)]
Coupe_var_width_nash_2 <- Coupe_stats_var_width$nash[c(1,2)]
Coupe_var_width_rrmse_2 <- Coupe_stats_var_width$rrmse[c(1,2)]
Coupe_var_width_n_rmse_2 <- Coupe_stats_var_width$n_rmse[c(1,2)]
Coupe_var_width_p_bias_2 <- Coupe_stats_var_width$p_bias[c(1,2)]

Coupe_invar_width_priors_kge_2 <- Coupe_stats_invar_width_priors$kge[c(1,2)]
Coupe_invar_width_priors_nash_2 <- Coupe_stats_invar_width_priors$nash[c(1,2)]
Coupe_invar_width_priors_rrmse_2 <- Coupe_stats_invar_width_priors$rrmse[c(1,2)]
Coupe_invar_width_priors_n_rmse_2 <- Coupe_stats_invar_width_priors$n_rmse[c(1,2)]
Coupe_invar_width_priors_p_bias_2 <- Coupe_stats_invar_width_priors$p_bias[c(1,2)]

Coupe_invar_width_Qpriors_kge_2 <- Coupe_stats_invar_width_Qpriors$kge[c(1,2)]
Coupe_invar_width_Qpriors_nash_2 <- Coupe_stats_invar_width_Qpriors$nash[c(1,2)]
Coupe_invar_width_Qpriors_rrmse_2 <- Coupe_stats_invar_width_Qpriors$rrmse[c(1,2)]
Coupe_invar_width_Qpriors_n_rmse_2 <- Coupe_stats_invar_width_Qpriors$n_rmse[c(1,2)]
Coupe_invar_width_Qpriors_p_bias_2 <- Coupe_stats_invar_width_Qpriors$p_bias[c(1,2)]

dev.off()
par(mfrow = c(2,2))
par(family = "serif")
boxplot(Coupe_temp_gauge_all_kge_2, Coupe_invar_width_kge_2, Coupe_invar_width_priors_kge_2, 
        Coupe_invar_width_Qpriors_kge_2, Coupe_var_width_kge_2, 
        Coupe_temp_gauge_all_nash_2, Coupe_invar_width_nash_2, Coupe_invar_width_priors_nash_2, 
        Coupe_invar_width_Qpriors_nash_2, Coupe_var_width_nash_2, 
        Coupe_temp_gauge_all_rrmse_2, Coupe_invar_width_rrmse_2, Coupe_invar_width_priors_rrmse_2, 
        Coupe_invar_width_Qpriors_rrmse_2, Coupe_var_width_rrmse_2, 
        Coupe_temp_gauge_all_n_rmse_2, Coupe_invar_width_n_rmse_2, Coupe_invar_width_priors_n_rmse_2, 
        Coupe_invar_width_Qpriors_n_rmse_2, Coupe_var_width_n_rmse_2, 
        Coupe_temp_gauge_all_p_bias_2, Coupe_invar_width_p_bias_2, Coupe_invar_width_priors_p_bias_2, 
        Coupe_invar_width_Qpriors_p_bias_2, Coupe_var_width_p_bias_2, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
#3-5 discharge samples------
Coupe_temp_gauge_all_kge_5 <- na.omit(Coupe_gauge_all$kge[Coupe_gauge_all$num_xs > 1.9 & Coupe_gauge_all$num_xs < 6.9])
Coupe_temp_gauge_all_nash_5 <- na.omit(Coupe_gauge_all$nash[Coupe_gauge_all$num_xs > 1.9 & Coupe_gauge_all$num_xs < 6.9])
Coupe_temp_gauge_all_rrmse_5 <- na.omit(Coupe_gauge_all$rrmse[Coupe_gauge_all$num_xs > 1.9 & Coupe_gauge_all$num_xs < 6.9])
Coupe_temp_gauge_all_n_rmse_5 <- na.omit(Coupe_gauge_all$n_rmse[Coupe_gauge_all$num_xs > 1.9 & Coupe_gauge_all$num_xs < 6.9])
Coupe_temp_gauge_all_p_bias_5 <- na.omit(Coupe_gauge_all$p_bias[Coupe_gauge_all$num_xs > 1.9 & Coupe_gauge_all$num_xs < 6.9])

Coupe_invar_width_kge_5 <- Coupe_stats_invar_width$kge[c(3:5)]
Coupe_invar_width_nash_5 <- Coupe_stats_invar_width$nash[c(3:5)]
Coupe_invar_width_rrmse_5 <- Coupe_stats_invar_width$rrmse[c(3:5)]
Coupe_invar_width_n_rmse_5 <- Coupe_stats_invar_width$n_rmse[c(3:5)]
Coupe_invar_width_p_bias_5 <- Coupe_stats_invar_width$p_bias[c(3:5)]

Coupe_var_width_kge_5 <- Coupe_stats_var_width$kge[c(3:5)]
Coupe_var_width_nash_5 <- Coupe_stats_var_width$nash[c(3:5)]
Coupe_var_width_rrmse_5 <- Coupe_stats_var_width$rrmse[c(3:5)]
Coupe_var_width_n_rmse_5 <- Coupe_stats_var_width$n_rmse[c(3:5)]
Coupe_var_width_p_bias_5 <- Coupe_stats_var_width$p_bias[c(3:5)]

Coupe_invar_width_priors_kge_5 <- Coupe_stats_invar_width_priors$kge[c(3:5)]
Coupe_invar_width_priors_nash_5 <- Coupe_stats_invar_width_priors$nash[c(3:5)]
Coupe_invar_width_priors_rrmse_5 <- Coupe_stats_invar_width_priors$rrmse[c(3:5)]
Coupe_invar_width_priors_n_rmse_5 <- Coupe_stats_invar_width_priors$n_rmse[c(3:5)]
Coupe_invar_width_priors_p_bias_5 <- Coupe_stats_invar_width_priors$p_bias[c(3:5)]

Coupe_invar_width_Qpriors_kge_5 <- Coupe_stats_invar_width_Qpriors$kge[c(3:5)]
Coupe_invar_width_Qpriors_nash_5 <- Coupe_stats_invar_width_Qpriors$nash[c(3:5)]
Coupe_invar_width_Qpriors_rrmse_5 <- Coupe_stats_invar_width_Qpriors$rrmse[c(3:5)]
Coupe_invar_width_Qpriors_n_rmse_5 <- Coupe_stats_invar_width_Qpriors$n_rmse[c(3:5)]
Coupe_invar_width_Qpriors_p_bias_5 <- Coupe_stats_invar_width_Qpriors$p_bias[c(3:5)]

boxplot(Coupe_temp_gauge_all_kge_5, Coupe_invar_width_kge_5, Coupe_invar_width_priors_kge_5, 
        Coupe_invar_width_Qpriors_kge_5, Coupe_var_width_kge_5, 
        Coupe_temp_gauge_all_nash_5, Coupe_invar_width_nash_5, Coupe_invar_width_priors_nash_5, 
        Coupe_invar_width_Qpriors_nash_5, Coupe_var_width_nash_5, 
        Coupe_temp_gauge_all_rrmse_5, Coupe_invar_width_rrmse_5, Coupe_invar_width_priors_rrmse_5, 
        Coupe_invar_width_Qpriors_rrmse_5, Coupe_var_width_rrmse_5, 
        Coupe_temp_gauge_all_n_rmse_5, Coupe_invar_width_n_rmse_5, Coupe_invar_width_priors_n_rmse_5, 
        Coupe_invar_width_Qpriors_n_rmse_5, Coupe_var_width_n_rmse_5, 
        Coupe_temp_gauge_all_p_bias_5, Coupe_invar_width_p_bias_5, Coupe_invar_width_priors_p_bias_5, 
        Coupe_invar_width_Qpriors_p_bias_5, Coupe_var_width_p_bias_5, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#6-10 discharge samples
Coupe_temp_gauge_all_kge_10 <- na.omit(Coupe_gauge_all$kge[Coupe_gauge_all$num_xs > 5.9 & Coupe_gauge_all$num_xs < 11.9])
Coupe_temp_gauge_all_nash_10 <- na.omit(Coupe_gauge_all$nash[Coupe_gauge_all$num_xs > 5.9 & Coupe_gauge_all$num_xs < 11.9])
Coupe_temp_gauge_all_rrmse_10 <- na.omit(Coupe_gauge_all$rrmse[Coupe_gauge_all$num_xs > 5.9 & Coupe_gauge_all$num_xs < 11.9])
Coupe_temp_gauge_all_n_rmse_10 <- na.omit(Coupe_gauge_all$n_rmse[Coupe_gauge_all$num_xs > 5.9 & Coupe_gauge_all$num_xs < 11.9])
Coupe_temp_gauge_all_p_bias_10 <- na.omit(Coupe_gauge_all$p_bias[Coupe_gauge_all$num_xs > 5.9 & Coupe_gauge_all$num_xs < 11.9])

Coupe_invar_width_kge_10 <- Coupe_stats_invar_width$kge[c(6:10)]
Coupe_invar_width_nash_10 <- Coupe_stats_invar_width$nash[c(6:10)]
Coupe_invar_width_rrmse_10 <- Coupe_stats_invar_width$rrmse[c(6:10)]
Coupe_invar_width_n_rmse_10 <- Coupe_stats_invar_width$n_rmse[c(6:10)]
Coupe_invar_width_p_bias_10 <- Coupe_stats_invar_width$p_bias[c(6:10)]

Coupe_var_width_kge_10 <- Coupe_stats_var_width$kge[c(6:10)]
Coupe_var_width_nash_10 <- Coupe_stats_var_width$nash[c(6:10)]
Coupe_var_width_rrmse_10 <- Coupe_stats_var_width$rrmse[c(6:10)]
Coupe_var_width_n_rmse_10 <- Coupe_stats_var_width$n_rmse[c(6:10)]
Coupe_var_width_p_bias_10 <- Coupe_stats_var_width$p_bias[c(6:10)]

Coupe_invar_width_priors_kge_10 <- Coupe_stats_invar_width_priors$kge[c(6:10)]
Coupe_invar_width_priors_nash_10 <- Coupe_stats_invar_width_priors$nash[c(6:10)]
Coupe_invar_width_priors_rrmse_10 <- Coupe_stats_invar_width_priors$rrmse[c(6:10)]
Coupe_invar_width_priors_n_rmse_10 <- Coupe_stats_invar_width_priors$n_rmse[c(6:10)]
Coupe_invar_width_priors_p_bias_10 <- Coupe_stats_invar_width_priors$p_bias[c(6:10)]

Coupe_invar_width_Qpriors_kge_10 <- Coupe_stats_invar_width_Qpriors$kge[c(6:10)]
Coupe_invar_width_Qpriors_nash_10 <- Coupe_stats_invar_width_Qpriors$nash[c(6:10)]
Coupe_invar_width_Qpriors_rrmse_10 <- Coupe_stats_invar_width_Qpriors$rrmse[c(6:10)]
Coupe_invar_width_Qpriors_n_rmse_10 <- Coupe_stats_invar_width_Qpriors$n_rmse[c(6:10)]
Coupe_invar_width_Qpriors_p_bias_10 <- Coupe_stats_invar_width_Qpriors$p_bias[c(6:10)]

boxplot(Coupe_temp_gauge_all_kge_10, Coupe_invar_width_kge_10, Coupe_invar_width_priors_kge_10, 
        Coupe_invar_width_Qpriors_kge_10, Coupe_var_width_kge_10, 
        Coupe_temp_gauge_all_nash_10, Coupe_invar_width_nash_10, Coupe_invar_width_priors_nash_10, 
        Coupe_invar_width_Qpriors_nash_10, Coupe_var_width_nash_10, 
        Coupe_temp_gauge_all_rrmse_10, Coupe_invar_width_rrmse_10, Coupe_invar_width_priors_rrmse_10, 
        Coupe_invar_width_Qpriors_rrmse_10, Coupe_var_width_rrmse_10, 
        Coupe_temp_gauge_all_n_rmse_10, Coupe_invar_width_n_rmse_10, Coupe_invar_width_priors_n_rmse_10, 
        Coupe_invar_width_Qpriors_n_rmse_10, Coupe_var_width_n_rmse_10, 
        Coupe_temp_gauge_all_p_bias_10, Coupe_invar_width_p_bias_10, Coupe_invar_width_priors_p_bias_10, 
        Coupe_invar_width_Qpriors_p_bias_10, Coupe_var_width_p_bias_10, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#11-46 discharge samples
Coupe_temp_gauge_all_kge_46 <- na.omit(Coupe_gauge_all$kge[Coupe_gauge_all$num_xs > 10.9])
Coupe_temp_gauge_all_nash_46 <- na.omit(Coupe_gauge_all$nash[Coupe_gauge_all$num_xs > 10.9])
Coupe_temp_gauge_all_rrmse_46 <- na.omit(Coupe_gauge_all$rrmse[Coupe_gauge_all$num_xs > 10.9])
Coupe_temp_gauge_all_n_rmse_46 <- na.omit(Coupe_gauge_all$r_rmse[Coupe_gauge_all$num_xs > 10.9])
Coupe_temp_gauge_all_p_bias_46 <- na.omit(Coupe_gauge_all$p_bias[Coupe_gauge_all$num_xs > 10.9])

Coupe_invar_width_kge_46 <- Coupe_stats_invar_width$kge[c(11:46)]
Coupe_invar_width_nash_46 <- Coupe_stats_invar_width$nash[c(11:46)]
Coupe_invar_width_rrmse_46 <- Coupe_stats_invar_width$rrmse[c(11:46)]
Coupe_invar_width_n_rmse_46 <- Coupe_stats_invar_width$n_rmse[c(11:46)]
Coupe_invar_width_p_bias_46 <- Coupe_stats_invar_width$p_bias[c(11:46)]

Coupe_var_width_kge_46 <- Coupe_stats_var_width$kge[c(11:46)]
Coupe_var_width_nash_46 <- Coupe_stats_var_width$nash[c(11:46)]
Coupe_var_width_rrmse_46 <- Coupe_stats_var_width$rrmse[c(11:46)]
Coupe_var_width_n_rmse_46 <- Coupe_stats_var_width$n_rmse[c(11:46)]
Coupe_var_width_p_bias_46 <- Coupe_stats_var_width$p_bias[c(11:46)]

Coupe_invar_width_priors_kge_46 <- Coupe_stats_invar_width_priors$kge[c(11:46)]
Coupe_invar_width_priors_nash_46 <- Coupe_stats_invar_width_priors$nash[c(11:46)]
Coupe_invar_width_priors_rrmse_46 <- Coupe_stats_invar_width_priors$rrmse[c(11:46)]
Coupe_invar_width_priors_n_rmse_46 <- Coupe_stats_invar_width_priors$n_rmse[c(11:46)]
Coupe_invar_width_priors_p_bias_46 <- Coupe_stats_invar_width_priors$p_bias[c(11:46)]

Coupe_invar_width_Qpriors_kge_46 <- Coupe_stats_invar_width_Qpriors$kge[c(11:46)]
Coupe_invar_width_Qpriors_nash_46 <- Coupe_stats_invar_width_Qpriors$nash[c(11:46)]
Coupe_invar_width_Qpriors_rrmse_46 <- Coupe_stats_invar_width_Qpriors$rrmse[c(11:46)]
Coupe_invar_width_Qpriors_n_rmse_46 <- Coupe_stats_invar_width_Qpriors$n_rmse[c(11:46)]
Coupe_invar_width_Qpriors_p_bias_46 <- Coupe_stats_invar_width_Qpriors$p_bias[c(11:46)]

boxplot(Coupe_temp_gauge_all_kge_46, Coupe_invar_width_kge_46, Coupe_invar_width_priors_kge_46, 
        Coupe_invar_width_Qpriors_kge_46, Coupe_var_width_kge_46, 
        Coupe_temp_gauge_all_nash_46, Coupe_invar_width_nash_46, Coupe_invar_width_priors_nash_46, 
        Coupe_invar_width_Qpriors_nash_46, Coupe_var_width_nash_46, 
        Coupe_temp_gauge_all_rrmse_46, Coupe_invar_width_rrmse_46, Coupe_invar_width_priors_rrmse_46, 
        Coupe_invar_width_Qpriors_rrmse_46, Coupe_var_width_rrmse_46, 
        Coupe_temp_gauge_all_n_rmse_46, Coupe_invar_width_n_rmse_46, Coupe_invar_width_priors_n_rmse_46, 
        Coupe_invar_width_Qpriors_n_rmse_46, Coupe_var_width_n_rmse_46, 
        Coupe_temp_gauge_all_p_bias_46, Coupe_invar_width_p_bias_46, Coupe_invar_width_priors_p_bias_46, 
        Coupe_invar_width_Qpriors_p_bias_46, Coupe_var_width_p_bias_46, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
legend("bottomleft", legend = c("Temporary Gauge", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                                "Var width new priors"), pch = c(15), 
       cex = 1,
       col = c("aquamarine4", "blue", "purple", "magenta","orange"))
#Remake plots only ranging from -1 to 0.5
boxplot(Coupe_temp_gauge_all_kge_2, Coupe_invar_width_kge_2, Coupe_invar_width_priors_kge_2, 
        Coupe_invar_width_Qpriors_kge_2, Coupe_var_width_kge_2, 
        Coupe_temp_gauge_all_nash_2, Coupe_invar_width_nash_2, Coupe_invar_width_priors_nash_2, 
        Coupe_invar_width_Qpriors_nash_2, Coupe_var_width_nash_2, 
        Coupe_temp_gauge_all_rrmse_2, Coupe_invar_width_rrmse_2, Coupe_invar_width_priors_rrmse_2, 
        Coupe_invar_width_Qpriors_rrmse_2, Coupe_var_width_rrmse_2, 
        Coupe_temp_gauge_all_n_rmse_2, Coupe_invar_width_n_rmse_2, Coupe_invar_width_priors_n_rmse_2, 
        Coupe_invar_width_Qpriors_n_rmse_2, Coupe_var_width_n_rmse_2, 
        Coupe_temp_gauge_all_p_bias_2, Coupe_invar_width_p_bias_2, Coupe_invar_width_priors_p_bias_2, 
        Coupe_invar_width_Qpriors_p_bias_2, Coupe_var_width_p_bias_2, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Coupe_temp_gauge_all_kge_5, Coupe_invar_width_kge_5, Coupe_invar_width_priors_kge_5, 
        Coupe_invar_width_Qpriors_kge_5, Coupe_var_width_kge_5, 
        Coupe_temp_gauge_all_nash_5, Coupe_invar_width_nash_5, Coupe_invar_width_priors_nash_5, 
        Coupe_invar_width_Qpriors_nash_5, Coupe_var_width_nash_5, 
        Coupe_temp_gauge_all_rrmse_5, Coupe_invar_width_rrmse_5, Coupe_invar_width_priors_rrmse_5, 
        Coupe_invar_width_Qpriors_rrmse_5, Coupe_var_width_rrmse_5, 
        Coupe_temp_gauge_all_n_rmse_5, Coupe_invar_width_n_rmse_5, Coupe_invar_width_priors_n_rmse_5, 
        Coupe_invar_width_Qpriors_n_rmse_5, Coupe_var_width_n_rmse_5, 
        Coupe_temp_gauge_all_p_bias_5, Coupe_invar_width_p_bias_5, Coupe_invar_width_priors_p_bias_5, 
        Coupe_invar_width_Qpriors_p_bias_5, Coupe_var_width_p_bias_5, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Coupe_temp_gauge_all_kge_10, Coupe_invar_width_kge_10, Coupe_invar_width_priors_kge_10, 
        Coupe_invar_width_Qpriors_kge_10, Coupe_var_width_kge_10, 
        Coupe_temp_gauge_all_nash_10, Coupe_invar_width_nash_10, Coupe_invar_width_priors_nash_10, 
        Coupe_invar_width_Qpriors_nash_10, Coupe_var_width_nash_10, 
        Coupe_temp_gauge_all_rrmse_10, Coupe_invar_width_rrmse_10, Coupe_invar_width_priors_rrmse_10, 
        Coupe_invar_width_Qpriors_rrmse_10, Coupe_var_width_rrmse_10, 
        Coupe_temp_gauge_all_n_rmse_10, Coupe_invar_width_n_rmse_10, Coupe_invar_width_priors_n_rmse_10, 
        Coupe_invar_width_Qpriors_n_rmse_10, Coupe_var_width_n_rmse_10, 
        Coupe_temp_gauge_all_p_bias_10, Coupe_invar_width_p_bias_10, Coupe_invar_width_priors_p_bias_10, 
        Coupe_invar_width_Qpriors_p_bias_10, Coupe_var_width_p_bias_10, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Coupe_temp_gauge_all_kge_46, Coupe_invar_width_kge_46, Coupe_invar_width_priors_kge_46, 
        Coupe_invar_width_Qpriors_kge_46, Coupe_var_width_kge_46, 
        Coupe_temp_gauge_all_nash_46, Coupe_invar_width_nash_46, Coupe_invar_width_priors_nash_46, 
        Coupe_invar_width_Qpriors_nash_46, Coupe_var_width_nash_46, 
        Coupe_temp_gauge_all_rrmse_46, Coupe_invar_width_rrmse_46, Coupe_invar_width_priors_rrmse_46, 
        Coupe_invar_width_Qpriors_rrmse_46, Coupe_var_width_rrmse_46, 
        Coupe_temp_gauge_all_n_rmse_46, Coupe_invar_width_n_rmse_46, Coupe_invar_width_priors_n_rmse_46, 
        Coupe_invar_width_Qpriors_n_rmse_46, Coupe_var_width_n_rmse_46, 
        Coupe_temp_gauge_all_p_bias_46, Coupe_invar_width_p_bias_46, Coupe_invar_width_priors_p_bias_46, 
        Coupe_invar_width_Qpriors_p_bias_46, Coupe_var_width_p_bias_46, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#Plot hydrographs ensemble


###Fletcher------
#load WSE
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT/Fletcher/WSE")
Fletcher_WSE <- read.csv("Fletcher_WSE_PPP_corr.csv")
Fletcher_WSE <- Fletcher_WSE %>%
  mutate(day = as.Date(new_time, format="%m/%d/%Y"))
Fletcher_WSE_daily <- aggregate(. ~day, data = Fletcher_WSE, mean, na.rm = TRUE)[,c(4:ncol(Fletcher_WSE))]

#load Q
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher")
Fletcher_corr_Q <- read.csv("Fletcher_corr_Q.csv")
Fletcher_corr_Q <- Fletcher_corr_Q %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Fletcher_qobs_daily <- aggregate(. ~day, data = Fletcher_corr_Q[,c(6,8,9,14)], 
                              mean, na.rm = TRUE)[,2]
par(family = "serif")
plot(as.POSIXct(Fletcher_corr_Q$new_date), Fletcher_corr_Q$Q, xlab = "Date", ylab = "Discharge (m^3/s)", 
     main = "Fletcher ADCP hydrograph", pch = 19)
#load cl and PT coords
setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher", sep =""))
Fletcher_cl <-readOGR(dsn = ".", layer = "Fletcher_CL_UTM")

setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT", sep =""))
Fletcher_PT_coords <- read.csv("Fletcher_PT_coords.csv")
Fletcher_PT_coords_sp <-SpatialPoints(Fletcher_PT_coords[,4:5], 
                                   proj4string = crs('+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0' ))
#calculate the distance between pts
Fletcher_xvec <- calc_xvec(Fletcher_PT_coords_sp, Fletcher_cl)
save(Fletcher_xvec, file = "Fletcher_xvec.RData")
#find overlapping ADCP and PT times
Fletcher_closest_time <- vector(length = length(Fletcher_corr_Q$new_date))
for(i in 1:length(Fletcher_corr_Q$new_date)){
  Fletcher_closest_time[i] = which.min(abs(as.POSIXct(Fletcher_WSE$new_time, format = "%m/%d/%Y %H:%M", tz = "MST") - 
                                          as.POSIXct(Fletcher_corr_Q$new_date[i], tz = "MST")))
}

Fletcher_WSE_corrQ <- Fletcher_WSE[c(Fletcher_closest_time[order(Fletcher_closest_time)]),c(3,5,6)]

#Calculate slope
Fletcher_slope <- calcslope(sort(Fletcher_xvec[c(3:5)]), hmat = t(Fletcher_WSE_corrQ[, order(Fletcher_xvec[c(3:5)])]))
Fletcher_slope[1,] <- colMeans(Fletcher_slope, na.rm = TRUE)

#Run BAM
pt = proc.time()
Fletcher_bam_invar_width <- run_bam_invar_width_default(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_invar_width",
                                                     slope =  Fletcher_slope, qobs = Fletcher_corr_Q, rivname = "Fletcher",
                                                     minQ = min(Fletcher_corr_Q$Q), maxQ = max(Fletcher_corr_Q$Q),
                                                     wse = Fletcher_WSE_corrQ)
library(hydroGOF)
Fletcher_val_invar_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_invar_width",
                                 Fletcher_corr_Q$Q)
Fletcher_val_invar_width <- Fletcher_val_invar_width[order(Fletcher_val_invar_width$num_xs),]
Fletcher_stats_invar_width <- bam_val_stats(Fletcher_val_invar_width)
Fletcher_plot_invar_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_invar_width",
                                   Fletcher_corr_Q$Q)
proc.time()-pt

#With new priors
pt = proc.time()
Fletcher_bam_invar_width_priors <- run_bam_invar_width_Q(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_invar_width_priors",
                                                      slope =  Fletcher_slope, qobs = Fletcher_corr_Q, rivname = "Fletcher",
                                                      minQ = min(Fletcher_corr_Q$Q), maxQ = max(Fletcher_corr_Q$Q),
                                                      wse = Fletcher_WSE_corrQ)
library(hydroGOF)
Fletcher_val_invar_width_priors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_invar_width_priors",
                                        Fletcher_corr_Q$Q)
Fletcher_val_invar_width_priors <- Fletcher_val_invar_width_priors[order(Fletcher_val_invar_width_priors$num_xs),]
Fletcher_stats_invar_width_priors <- bam_val_stats(Fletcher_val_invar_width_priors)
Fletcher_plot_invar_width_priors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_invar_width_priors",
                                          Fletcher_corr_Q$Q)
proc.time()-pt


#With new priors and Q prior
pt = proc.time()
Fletcher_bam_invar_width_Qpriors <- run_bam_invar_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_invar_width_Qpriors",
                                                     slope =  Fletcher_slope, qobs = Fletcher_corr_Q, rivname = "Fletcher",
                                                     wse = Fletcher_WSE_corrQ)
library(hydroGOF)
Fletcher_val_invar_width_Qpriors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_invar_width_Qpriors",
                                         Fletcher_corr_Q$Q)
Fletcher_val_invar_width_Qpriors <- Fletcher_val_invar_width_Qpriors[order(Fletcher_val_invar_width_Qpriors$num_xs),]
Fletcher_stats_invar_width_Qpriors <- bam_val_stats(Fletcher_val_invar_width_Qpriors)
Fletcher_plot_invar_width_Qpriors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_invar_width_Qpriors",
                                           Fletcher_corr_Q$Q)
proc.time()-pt

#var width
pt = proc.time()
Fletcher_bam_var_width <- run_bam_var_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_var_width",
                                         slope =  Fletcher_slope, qobs = Fletcher_corr_Q, rivname = "Fletcher",
                                         wse = Fletcher_WSE_corrQ)
library(hydroGOF)
Fletcher_val_var_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_var_width",
                               Fletcher_corr_Q$Q)
Fletcher_val_var_width <- Fletcher_val_var_width[order(Fletcher_val_var_width$num_xs),]
Fletcher_stats_var_width <- bam_val_stats(Fletcher_val_var_width)
Fletcher_plot_var_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_var_width",
                                 Fletcher_corr_Q$Q)
proc.time()-pt


#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/Gauge_All")
Fletcher_temp_gauge_all <- temporary_gauge_all(num_days = nrow(Fletcher_WSE_corrQ), 
                                            pt_count = ncol(Fletcher_WSE_corrQ), 
                                            file_name = "Fletcher",
                                            WSE_mat = t(Fletcher_WSE_corrQ), 
                                            Qobs = Fletcher_corr_Q$Q)
Fletcher_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/Gauge_All",
                                   Fletcher_corr_Q$Q)

#Load BAM results from old method of estimating width from DEM
library(hydroGOF)
Fletcher_val_corr_Q <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Fletcher/BAM_corrQ",
                            Fletcher_corr_Q$Q)
Fletcher_val_corr_Q <- Fletcher_val_corr_Q[order(Fletcher_val_corr_Q$num_xs),]
Fletcher_stats_corr_Q <- bam_val_stats(Fletcher_val_corr_Q)

#Plot total time and all error metrics--------
#KGE
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Fletcher_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Fletcher_corr_Q$Q)), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$kge - Fletcher_stats_invar_width$kge_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$kge + Fletcher_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$kge - Fletcher_stats_invar_width_priors$kge_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$kge + Fletcher_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$kge - Fletcher_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$kge + Fletcher_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$kge - Fletcher_stats_var_width$kge_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$kge + Fletcher_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Fletcher_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Fletcher_corr_Q$Q)), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$nash - Fletcher_stats_invar_width$nash_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$nash + Fletcher_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$nash - Fletcher_stats_invar_width_priors$nash_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$nash + Fletcher_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$nash - Fletcher_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$nash + Fletcher_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$nash - Fletcher_stats_var_width$nash_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$nash + Fletcher_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Fletcher_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Fletcher_corr_Q$Q)), 
        ylim= c(0.15, 0.25)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$rrmse - Fletcher_stats_invar_width$rrmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$rrmse + Fletcher_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$rrmse - Fletcher_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$rrmse + Fletcher_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$rrmse - Fletcher_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$rrmse + Fletcher_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$rrmse - Fletcher_stats_var_width$rrmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$rrmse + Fletcher_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Fletcher_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Fletcher_corr_Q$Q)), 
        ylim= c(0.8, 1.6)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$n_rmse - Fletcher_stats_invar_width$n_rmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$n_rmse + Fletcher_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$n_rmse - Fletcher_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$n_rmse + Fletcher_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$n_rmse - Fletcher_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$n_rmse + Fletcher_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$n_rmse - Fletcher_stats_var_width$n_rmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$n_rmse + Fletcher_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Fletcher_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Fletcher_corr_Q$Q)), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$p_bias - Fletcher_stats_invar_width$p_bias_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$p_bias + Fletcher_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$p_bias - Fletcher_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$p_bias + Fletcher_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$p_bias - Fletcher_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$p_bias + Fletcher_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$p_bias - Fletcher_stats_var_width$p_bias_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$p_bias + Fletcher_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(63, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot 10 time steps to show tradeoff better-------------
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Fletcher_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$kge - Fletcher_stats_invar_width$kge_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$kge + Fletcher_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$kge - Fletcher_stats_invar_width_priors$kge_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$kge + Fletcher_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$kge - Fletcher_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$kge + Fletcher_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$kge - Fletcher_stats_var_width$kge_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$kge + Fletcher_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Fletcher_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$nash - Fletcher_stats_invar_width$nash_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$nash + Fletcher_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$nash - Fletcher_stats_invar_width_priors$nash_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$nash + Fletcher_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$nash - Fletcher_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$nash + Fletcher_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$nash - Fletcher_stats_var_width$nash_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$nash + Fletcher_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Fletcher_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$rrmse - Fletcher_stats_invar_width$rrmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$rrmse + Fletcher_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$rrmse - Fletcher_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$rrmse + Fletcher_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$rrmse - Fletcher_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$rrmse + Fletcher_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$rrmse - Fletcher_stats_var_width$rrmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$rrmse + Fletcher_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Fletcher_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(80, 200)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$n_rmse - Fletcher_stats_invar_width$n_rmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$n_rmse + Fletcher_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$n_rmse - Fletcher_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$n_rmse + Fletcher_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$n_rmse - Fletcher_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$n_rmse + Fletcher_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$n_rmse - Fletcher_stats_var_width$n_rmse_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$n_rmse + Fletcher_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Fletcher_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Fletcher_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$p_bias - Fletcher_stats_invar_width$p_bias_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width$p_bias + Fletcher_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$p_bias - Fletcher_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_priors$p_bias + Fletcher_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$p_bias - Fletcher_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_invar_width_Qpriors$p_bias + Fletcher_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Fletcher_WSE_corrQ)-1)), Fletcher_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$p_bias - Fletcher_stats_var_width$p_bias_sd, c(0:(nrow(Fletcher_WSE_corrQ)-1)), 
       Fletcher_stats_var_width$p_bias + Fletcher_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(14, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot multiple error metric comparison------
#2 discharge samples-----
Fletcher_temp_gauge_all_kge_2 <- na.omit(Fletcher_gauge_all$kge[Fletcher_gauge_all$num_xs == 1.9])
Fletcher_temp_gauge_all_nash_2 <- na.omit(Fletcher_gauge_all$nash[Fletcher_gauge_all$num_xs == 1.9])
Fletcher_temp_gauge_all_rrmse_2 <- na.omit(Fletcher_gauge_all$rrmse[Fletcher_gauge_all$num_xs == 1.9])
Fletcher_temp_gauge_all_n_rmse_2 <- na.omit(Fletcher_gauge_all$n_rmse[Fletcher_gauge_all$num_xs == 1.9])
Fletcher_temp_gauge_all_p_bias_2 <- na.omit(Fletcher_gauge_all$p_bias[Fletcher_gauge_all$num_xs == 1.9])

Fletcher_invar_width_kge_2 <- Fletcher_stats_invar_width$kge[c(1,2)]
Fletcher_invar_width_nash_2 <- Fletcher_stats_invar_width$nash[c(1,2)]
Fletcher_invar_width_rrmse_2 <- Fletcher_stats_invar_width$rrmse[c(1,2)]
Fletcher_invar_width_n_rmse_2 <- Fletcher_stats_invar_width$n_rmse[c(1,2)]
Fletcher_invar_width_p_bias_2 <- Fletcher_stats_invar_width$p_bias[c(1,2)]

Fletcher_var_width_kge_2 <- Fletcher_stats_var_width$kge[c(1,2)]
Fletcher_var_width_nash_2 <- Fletcher_stats_var_width$nash[c(1,2)]
Fletcher_var_width_rrmse_2 <- Fletcher_stats_var_width$rrmse[c(1,2)]
Fletcher_var_width_n_rmse_2 <- Fletcher_stats_var_width$n_rmse[c(1,2)]
Fletcher_var_width_p_bias_2 <- Fletcher_stats_var_width$p_bias[c(1,2)]

Fletcher_invar_width_priors_kge_2 <- Fletcher_stats_invar_width_priors$kge[c(1,2)]
Fletcher_invar_width_priors_nash_2 <- Fletcher_stats_invar_width_priors$nash[c(1,2)]
Fletcher_invar_width_priors_rrmse_2 <- Fletcher_stats_invar_width_priors$rrmse[c(1,2)]
Fletcher_invar_width_priors_n_rmse_2 <- Fletcher_stats_invar_width_priors$n_rmse[c(1,2)]
Fletcher_invar_width_priors_p_bias_2 <- Fletcher_stats_invar_width_priors$p_bias[c(1,2)]

Fletcher_invar_width_Qpriors_kge_2 <- Fletcher_stats_invar_width_Qpriors$kge[c(1,2)]
Fletcher_invar_width_Qpriors_nash_2 <- Fletcher_stats_invar_width_Qpriors$nash[c(1,2)]
Fletcher_invar_width_Qpriors_rrmse_2 <- Fletcher_stats_invar_width_Qpriors$rrmse[c(1,2)]
Fletcher_invar_width_Qpriors_n_rmse_2 <- Fletcher_stats_invar_width_Qpriors$n_rmse[c(1,2)]
Fletcher_invar_width_Qpriors_p_bias_2 <- Fletcher_stats_invar_width_Qpriors$p_bias[c(1,2)]

dev.off()
par(mfrow = c(2,2))
par(family = "serif")
boxplot(Fletcher_temp_gauge_all_kge_2, Fletcher_invar_width_kge_2, Fletcher_invar_width_priors_kge_2, 
        Fletcher_invar_width_Qpriors_kge_2, Fletcher_var_width_kge_2, 
        Fletcher_temp_gauge_all_nash_2, Fletcher_invar_width_nash_2, Fletcher_invar_width_priors_nash_2, 
        Fletcher_invar_width_Qpriors_nash_2, Fletcher_var_width_nash_2, 
        Fletcher_temp_gauge_all_rrmse_2, Fletcher_invar_width_rrmse_2, Fletcher_invar_width_priors_rrmse_2, 
        Fletcher_invar_width_Qpriors_rrmse_2, Fletcher_var_width_rrmse_2, 
        Fletcher_temp_gauge_all_n_rmse_2, Fletcher_invar_width_n_rmse_2, Fletcher_invar_width_priors_n_rmse_2, 
        Fletcher_invar_width_Qpriors_n_rmse_2, Fletcher_var_width_n_rmse_2, 
        Fletcher_temp_gauge_all_p_bias_2, Fletcher_invar_width_p_bias_2, Fletcher_invar_width_priors_p_bias_2, 
        Fletcher_invar_width_Qpriors_p_bias_2, Fletcher_var_width_p_bias_2, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
#3-5 discharge samples------
Fletcher_temp_gauge_all_kge_5 <- na.omit(Fletcher_gauge_all$kge[Fletcher_gauge_all$num_xs > 1.9 & Fletcher_gauge_all$num_xs < 6.9])
Fletcher_temp_gauge_all_nash_5 <- na.omit(Fletcher_gauge_all$nash[Fletcher_gauge_all$num_xs > 1.9 & Fletcher_gauge_all$num_xs < 6.9])
Fletcher_temp_gauge_all_rrmse_5 <- na.omit(Fletcher_gauge_all$rrmse[Fletcher_gauge_all$num_xs > 1.9 & Fletcher_gauge_all$num_xs < 6.9])
Fletcher_temp_gauge_all_n_rmse_5 <- na.omit(Fletcher_gauge_all$n_rmse[Fletcher_gauge_all$num_xs > 1.9 & Fletcher_gauge_all$num_xs < 6.9])
Fletcher_temp_gauge_all_p_bias_5 <- na.omit(Fletcher_gauge_all$p_bias[Fletcher_gauge_all$num_xs > 1.9 & Fletcher_gauge_all$num_xs < 6.9])

Fletcher_invar_width_kge_5 <- Fletcher_stats_invar_width$kge[c(3:5)]
Fletcher_invar_width_nash_5 <- Fletcher_stats_invar_width$nash[c(3:5)]
Fletcher_invar_width_rrmse_5 <- Fletcher_stats_invar_width$rrmse[c(3:5)]
Fletcher_invar_width_n_rmse_5 <- Fletcher_stats_invar_width$n_rmse[c(3:5)]
Fletcher_invar_width_p_bias_5 <- Fletcher_stats_invar_width$p_bias[c(3:5)]

Fletcher_var_width_kge_5 <- Fletcher_stats_var_width$kge[c(3:5)]
Fletcher_var_width_nash_5 <- Fletcher_stats_var_width$nash[c(3:5)]
Fletcher_var_width_rrmse_5 <- Fletcher_stats_var_width$rrmse[c(3:5)]
Fletcher_var_width_n_rmse_5 <- Fletcher_stats_var_width$n_rmse[c(3:5)]
Fletcher_var_width_p_bias_5 <- Fletcher_stats_var_width$p_bias[c(3:5)]

Fletcher_invar_width_priors_kge_5 <- Fletcher_stats_invar_width_priors$kge[c(3:5)]
Fletcher_invar_width_priors_nash_5 <- Fletcher_stats_invar_width_priors$nash[c(3:5)]
Fletcher_invar_width_priors_rrmse_5 <- Fletcher_stats_invar_width_priors$rrmse[c(3:5)]
Fletcher_invar_width_priors_n_rmse_5 <- Fletcher_stats_invar_width_priors$n_rmse[c(3:5)]
Fletcher_invar_width_priors_p_bias_5 <- Fletcher_stats_invar_width_priors$p_bias[c(3:5)]

Fletcher_invar_width_Qpriors_kge_5 <- Fletcher_stats_invar_width_Qpriors$kge[c(3:5)]
Fletcher_invar_width_Qpriors_nash_5 <- Fletcher_stats_invar_width_Qpriors$nash[c(3:5)]
Fletcher_invar_width_Qpriors_rrmse_5 <- Fletcher_stats_invar_width_Qpriors$rrmse[c(3:5)]
Fletcher_invar_width_Qpriors_n_rmse_5 <- Fletcher_stats_invar_width_Qpriors$n_rmse[c(3:5)]
Fletcher_invar_width_Qpriors_p_bias_5 <- Fletcher_stats_invar_width_Qpriors$p_bias[c(3:5)]

boxplot(Fletcher_temp_gauge_all_kge_5, Fletcher_invar_width_kge_5, Fletcher_invar_width_priors_kge_5, 
        Fletcher_invar_width_Qpriors_kge_5, Fletcher_var_width_kge_5, 
        Fletcher_temp_gauge_all_nash_5, Fletcher_invar_width_nash_5, Fletcher_invar_width_priors_nash_5, 
        Fletcher_invar_width_Qpriors_nash_5, Fletcher_var_width_nash_5, 
        Fletcher_temp_gauge_all_rrmse_5, Fletcher_invar_width_rrmse_5, Fletcher_invar_width_priors_rrmse_5, 
        Fletcher_invar_width_Qpriors_rrmse_5, Fletcher_var_width_rrmse_5, 
        Fletcher_temp_gauge_all_n_rmse_5, Fletcher_invar_width_n_rmse_5, Fletcher_invar_width_priors_n_rmse_5, 
        Fletcher_invar_width_Qpriors_n_rmse_5, Fletcher_var_width_n_rmse_5, 
        Fletcher_temp_gauge_all_p_bias_5, Fletcher_invar_width_p_bias_5, Fletcher_invar_width_priors_p_bias_5, 
        Fletcher_invar_width_Qpriors_p_bias_5, Fletcher_var_width_p_bias_5, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#6-10 discharge samples
Fletcher_temp_gauge_all_kge_10 <- na.omit(Fletcher_gauge_all$kge[Fletcher_gauge_all$num_xs > 5.9 & Fletcher_gauge_all$num_xs < 11.9])
Fletcher_temp_gauge_all_nash_10 <- na.omit(Fletcher_gauge_all$nash[Fletcher_gauge_all$num_xs > 5.9 & Fletcher_gauge_all$num_xs < 11.9])
Fletcher_temp_gauge_all_rrmse_10 <- na.omit(Fletcher_gauge_all$rrmse[Fletcher_gauge_all$num_xs > 5.9 & Fletcher_gauge_all$num_xs < 11.9])
Fletcher_temp_gauge_all_n_rmse_10 <- na.omit(Fletcher_gauge_all$n_rmse[Fletcher_gauge_all$num_xs > 5.9 & Fletcher_gauge_all$num_xs < 11.9])
Fletcher_temp_gauge_all_p_bias_10 <- na.omit(Fletcher_gauge_all$p_bias[Fletcher_gauge_all$num_xs > 5.9 & Fletcher_gauge_all$num_xs < 11.9])

Fletcher_invar_width_kge_10 <- Fletcher_stats_invar_width$kge[c(6:10)]
Fletcher_invar_width_nash_10 <- Fletcher_stats_invar_width$nash[c(6:10)]
Fletcher_invar_width_rrmse_10 <- Fletcher_stats_invar_width$rrmse[c(6:10)]
Fletcher_invar_width_n_rmse_10 <- Fletcher_stats_invar_width$n_rmse[c(6:10)]
Fletcher_invar_width_p_bias_10 <- Fletcher_stats_invar_width$p_bias[c(6:10)]

Fletcher_var_width_kge_10 <- Fletcher_stats_var_width$kge[c(6:10)]
Fletcher_var_width_nash_10 <- Fletcher_stats_var_width$nash[c(6:10)]
Fletcher_var_width_rrmse_10 <- Fletcher_stats_var_width$rrmse[c(6:10)]
Fletcher_var_width_n_rmse_10 <- Fletcher_stats_var_width$n_rmse[c(6:10)]
Fletcher_var_width_p_bias_10 <- Fletcher_stats_var_width$p_bias[c(6:10)]

Fletcher_invar_width_priors_kge_10 <- Fletcher_stats_invar_width_priors$kge[c(6:10)]
Fletcher_invar_width_priors_nash_10 <- Fletcher_stats_invar_width_priors$nash[c(6:10)]
Fletcher_invar_width_priors_rrmse_10 <- Fletcher_stats_invar_width_priors$rrmse[c(6:10)]
Fletcher_invar_width_priors_n_rmse_10 <- Fletcher_stats_invar_width_priors$n_rmse[c(6:10)]
Fletcher_invar_width_priors_p_bias_10 <- Fletcher_stats_invar_width_priors$p_bias[c(6:10)]

Fletcher_invar_width_Qpriors_kge_10 <- Fletcher_stats_invar_width_Qpriors$kge[c(6:10)]
Fletcher_invar_width_Qpriors_nash_10 <- Fletcher_stats_invar_width_Qpriors$nash[c(6:10)]
Fletcher_invar_width_Qpriors_rrmse_10 <- Fletcher_stats_invar_width_Qpriors$rrmse[c(6:10)]
Fletcher_invar_width_Qpriors_n_rmse_10 <- Fletcher_stats_invar_width_Qpriors$n_rmse[c(6:10)]
Fletcher_invar_width_Qpriors_p_bias_10 <- Fletcher_stats_invar_width_Qpriors$p_bias[c(6:10)]

boxplot(Fletcher_temp_gauge_all_kge_10, Fletcher_invar_width_kge_10, Fletcher_invar_width_priors_kge_10, 
        Fletcher_invar_width_Qpriors_kge_10, Fletcher_var_width_kge_10, 
        Fletcher_temp_gauge_all_nash_10, Fletcher_invar_width_nash_10, Fletcher_invar_width_priors_nash_10, 
        Fletcher_invar_width_Qpriors_nash_10, Fletcher_var_width_nash_10, 
        Fletcher_temp_gauge_all_rrmse_10, Fletcher_invar_width_rrmse_10, Fletcher_invar_width_priors_rrmse_10, 
        Fletcher_invar_width_Qpriors_rrmse_10, Fletcher_var_width_rrmse_10, 
        Fletcher_temp_gauge_all_n_rmse_10, Fletcher_invar_width_n_rmse_10, Fletcher_invar_width_priors_n_rmse_10, 
        Fletcher_invar_width_Qpriors_n_rmse_10, Fletcher_var_width_n_rmse_10, 
        Fletcher_temp_gauge_all_p_bias_10, Fletcher_invar_width_p_bias_10, Fletcher_invar_width_priors_p_bias_10, 
        Fletcher_invar_width_Qpriors_p_bias_10, Fletcher_var_width_p_bias_10, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#11-46 discharge samples
Fletcher_temp_gauge_all_kge_46 <- na.omit(Fletcher_gauge_all$kge[Fletcher_gauge_all$num_xs > 10.9])
Fletcher_temp_gauge_all_nash_46 <- na.omit(Fletcher_gauge_all$nash[Fletcher_gauge_all$num_xs > 10.9])
Fletcher_temp_gauge_all_rrmse_46 <- na.omit(Fletcher_gauge_all$rrmse[Fletcher_gauge_all$num_xs > 10.9])
Fletcher_temp_gauge_all_n_rmse_46 <- na.omit(Fletcher_gauge_all$r_rmse[Fletcher_gauge_all$num_xs > 10.9])
Fletcher_temp_gauge_all_p_bias_46 <- na.omit(Fletcher_gauge_all$p_bias[Fletcher_gauge_all$num_xs > 10.9])

Fletcher_invar_width_kge_46 <- Fletcher_stats_invar_width$kge[c(11:46)]
Fletcher_invar_width_nash_46 <- Fletcher_stats_invar_width$nash[c(11:46)]
Fletcher_invar_width_rrmse_46 <- Fletcher_stats_invar_width$rrmse[c(11:46)]
Fletcher_invar_width_n_rmse_46 <- Fletcher_stats_invar_width$n_rmse[c(11:46)]
Fletcher_invar_width_p_bias_46 <- Fletcher_stats_invar_width$p_bias[c(11:46)]

Fletcher_var_width_kge_46 <- Fletcher_stats_var_width$kge[c(11:46)]
Fletcher_var_width_nash_46 <- Fletcher_stats_var_width$nash[c(11:46)]
Fletcher_var_width_rrmse_46 <- Fletcher_stats_var_width$rrmse[c(11:46)]
Fletcher_var_width_n_rmse_46 <- Fletcher_stats_var_width$n_rmse[c(11:46)]
Fletcher_var_width_p_bias_46 <- Fletcher_stats_var_width$p_bias[c(11:46)]

Fletcher_invar_width_priors_kge_46 <- Fletcher_stats_invar_width_priors$kge[c(11:46)]
Fletcher_invar_width_priors_nash_46 <- Fletcher_stats_invar_width_priors$nash[c(11:46)]
Fletcher_invar_width_priors_rrmse_46 <- Fletcher_stats_invar_width_priors$rrmse[c(11:46)]
Fletcher_invar_width_priors_n_rmse_46 <- Fletcher_stats_invar_width_priors$n_rmse[c(11:46)]
Fletcher_invar_width_priors_p_bias_46 <- Fletcher_stats_invar_width_priors$p_bias[c(11:46)]

Fletcher_invar_width_Qpriors_kge_46 <- Fletcher_stats_invar_width_Qpriors$kge[c(11:46)]
Fletcher_invar_width_Qpriors_nash_46 <- Fletcher_stats_invar_width_Qpriors$nash[c(11:46)]
Fletcher_invar_width_Qpriors_rrmse_46 <- Fletcher_stats_invar_width_Qpriors$rrmse[c(11:46)]
Fletcher_invar_width_Qpriors_n_rmse_46 <- Fletcher_stats_invar_width_Qpriors$n_rmse[c(11:46)]
Fletcher_invar_width_Qpriors_p_bias_46 <- Fletcher_stats_invar_width_Qpriors$p_bias[c(11:46)]

boxplot(Fletcher_temp_gauge_all_kge_46, Fletcher_invar_width_kge_46, Fletcher_invar_width_priors_kge_46, 
        Fletcher_invar_width_Qpriors_kge_46, Fletcher_var_width_kge_46, 
        Fletcher_temp_gauge_all_nash_46, Fletcher_invar_width_nash_46, Fletcher_invar_width_priors_nash_46, 
        Fletcher_invar_width_Qpriors_nash_46, Fletcher_var_width_nash_46, 
        Fletcher_temp_gauge_all_rrmse_46, Fletcher_invar_width_rrmse_46, Fletcher_invar_width_priors_rrmse_46, 
        Fletcher_invar_width_Qpriors_rrmse_46, Fletcher_var_width_rrmse_46, 
        Fletcher_temp_gauge_all_n_rmse_46, Fletcher_invar_width_n_rmse_46, Fletcher_invar_width_priors_n_rmse_46, 
        Fletcher_invar_width_Qpriors_n_rmse_46, Fletcher_var_width_n_rmse_46, 
        Fletcher_temp_gauge_all_p_bias_46, Fletcher_invar_width_p_bias_46, Fletcher_invar_width_priors_p_bias_46, 
        Fletcher_invar_width_Qpriors_p_bias_46, Fletcher_var_width_p_bias_46, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
legend("bottomleft", legend = c("Temporary Gauge", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                                "Var width new priors"), pch = c(15), 
       cex = 1,
       col = c("aquamarine4", "blue", "purple", "magenta","orange"))
#Remake plots only ranging from -1 to 0.5
boxplot(Fletcher_temp_gauge_all_kge_2, Fletcher_invar_width_kge_2, Fletcher_invar_width_priors_kge_2, 
        Fletcher_invar_width_Qpriors_kge_2, Fletcher_var_width_kge_2, 
        Fletcher_temp_gauge_all_nash_2, Fletcher_invar_width_nash_2, Fletcher_invar_width_priors_nash_2, 
        Fletcher_invar_width_Qpriors_nash_2, Fletcher_var_width_nash_2, 
        Fletcher_temp_gauge_all_rrmse_2, Fletcher_invar_width_rrmse_2, Fletcher_invar_width_priors_rrmse_2, 
        Fletcher_invar_width_Qpriors_rrmse_2, Fletcher_var_width_rrmse_2, 
        Fletcher_temp_gauge_all_n_rmse_2, Fletcher_invar_width_n_rmse_2, Fletcher_invar_width_priors_n_rmse_2, 
        Fletcher_invar_width_Qpriors_n_rmse_2, Fletcher_var_width_n_rmse_2, 
        Fletcher_temp_gauge_all_p_bias_2, Fletcher_invar_width_p_bias_2, Fletcher_invar_width_priors_p_bias_2, 
        Fletcher_invar_width_Qpriors_p_bias_2, Fletcher_var_width_p_bias_2, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Fletcher_temp_gauge_all_kge_5, Fletcher_invar_width_kge_5, Fletcher_invar_width_priors_kge_5, 
        Fletcher_invar_width_Qpriors_kge_5, Fletcher_var_width_kge_5, 
        Fletcher_temp_gauge_all_nash_5, Fletcher_invar_width_nash_5, Fletcher_invar_width_priors_nash_5, 
        Fletcher_invar_width_Qpriors_nash_5, Fletcher_var_width_nash_5, 
        Fletcher_temp_gauge_all_rrmse_5, Fletcher_invar_width_rrmse_5, Fletcher_invar_width_priors_rrmse_5, 
        Fletcher_invar_width_Qpriors_rrmse_5, Fletcher_var_width_rrmse_5, 
        Fletcher_temp_gauge_all_n_rmse_5, Fletcher_invar_width_n_rmse_5, Fletcher_invar_width_priors_n_rmse_5, 
        Fletcher_invar_width_Qpriors_n_rmse_5, Fletcher_var_width_n_rmse_5, 
        Fletcher_temp_gauge_all_p_bias_5, Fletcher_invar_width_p_bias_5, Fletcher_invar_width_priors_p_bias_5, 
        Fletcher_invar_width_Qpriors_p_bias_5, Fletcher_var_width_p_bias_5, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Fletcher_temp_gauge_all_kge_10, Fletcher_invar_width_kge_10, Fletcher_invar_width_priors_kge_10, 
        Fletcher_invar_width_Qpriors_kge_10, Fletcher_var_width_kge_10, 
        Fletcher_temp_gauge_all_nash_10, Fletcher_invar_width_nash_10, Fletcher_invar_width_priors_nash_10, 
        Fletcher_invar_width_Qpriors_nash_10, Fletcher_var_width_nash_10, 
        Fletcher_temp_gauge_all_rrmse_10, Fletcher_invar_width_rrmse_10, Fletcher_invar_width_priors_rrmse_10, 
        Fletcher_invar_width_Qpriors_rrmse_10, Fletcher_var_width_rrmse_10, 
        Fletcher_temp_gauge_all_n_rmse_10, Fletcher_invar_width_n_rmse_10, Fletcher_invar_width_priors_n_rmse_10, 
        Fletcher_invar_width_Qpriors_n_rmse_10, Fletcher_var_width_n_rmse_10, 
        Fletcher_temp_gauge_all_p_bias_10, Fletcher_invar_width_p_bias_10, Fletcher_invar_width_priors_p_bias_10, 
        Fletcher_invar_width_Qpriors_p_bias_10, Fletcher_var_width_p_bias_10, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Fletcher_temp_gauge_all_kge_46, Fletcher_invar_width_kge_46, Fletcher_invar_width_priors_kge_46, 
        Fletcher_invar_width_Qpriors_kge_46, Fletcher_var_width_kge_46, 
        Fletcher_temp_gauge_all_nash_46, Fletcher_invar_width_nash_46, Fletcher_invar_width_priors_nash_46, 
        Fletcher_invar_width_Qpriors_nash_46, Fletcher_var_width_nash_46, 
        Fletcher_temp_gauge_all_rrmse_46, Fletcher_invar_width_rrmse_46, Fletcher_invar_width_priors_rrmse_46, 
        Fletcher_invar_width_Qpriors_rrmse_46, Fletcher_var_width_rrmse_46, 
        Fletcher_temp_gauge_all_n_rmse_46, Fletcher_invar_width_n_rmse_46, Fletcher_invar_width_priors_n_rmse_46, 
        Fletcher_invar_width_Qpriors_n_rmse_46, Fletcher_var_width_n_rmse_46, 
        Fletcher_temp_gauge_all_p_bias_46, Fletcher_invar_width_p_bias_46, Fletcher_invar_width_priors_p_bias_46, 
        Fletcher_invar_width_Qpriors_p_bias_46, Fletcher_var_width_p_bias_46, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")



###Mamawi------
#load WSE
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT/Mamawi/WSE")
Mamawi_WSE <- read.csv("Mamawi_WSE_PPP_corr.csv")
Mamawi_WSE <- Mamawi_WSE %>%
  mutate(day = as.Date(new_time, format="%Y-%m-%d"))
Mamawi_WSE_daily <- aggregate(. ~day, data = Mamawi_WSE, mean, na.rm = TRUE)[1,c(3:ncol(Mamawi_WSE))]

#load Q
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi")
Mamawi_corr_Q <- read.csv("Mamawi_corr_Q.csv")
Mamawi_corr_Q <- Mamawi_corr_Q %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Mamawi_qobs_daily <- aggregate(. ~day, data = Mamawi_corr_Q[,c(6,8,9,14)], 
                                 mean, na.rm = TRUE)[,2]
par(family = "serif")
plot(as.POSIXct(Mamawi_corr_Q$new_date), Mamawi_corr_Q$Q, xlab = "Date", ylab = "Discharge (m^3/s)", 
     main = "Mamawi ADCP hydrograph", pch = 19)
#load cl and PT coords
setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi", sep =""))
Mamawi_cl <-readOGR(dsn = ".", layer = "Mamawi_CL_UTM")

setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT", sep =""))
Mamawi_PT_coords <- read.csv("Mamawi_PT_coords.csv")
Mamawi_PT_coords_sp <-SpatialPoints(Mamawi_PT_coords[,4:5], 
                                      proj4string = crs('+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0' ))
#calculate the distance between pts
Mamawi_xvec <- calc_xvec(Mamawi_PT_coords_sp, Mamawi_cl)
save(Mamawi_xvec, file = "Mamawi_xvec.RData")
#find overlapping ADCP and PT times
Mamawi_closest_time <- vector(length = length(Mamawi_corr_Q$new_date))
for(i in 1:length(Mamawi_corr_Q$new_date)){
  Mamawi_closest_time[i] = which.min(abs(as.POSIXct(Mamawi_WSE$new_time, tz = "MST") - 
                                             as.POSIXct(Mamawi_corr_Q$new_date[i], tz = "MST")))
}

Mamawi_WSE_corrQ <- Mamawi_WSE[c(Mamawi_closest_time[order(Mamawi_closest_time)]),c(3,4,6,8)]

#Calculate slope
Mamawi_slope <- -1*calcslope(sort(Mamawi_xvec[c(1,2,4,6)]), hmat = t(Mamawi_WSE_corrQ[, order(Mamawi_xvec[c(1,2,4,6)])]))
Mamawi_slope[1,] <- colMeans(Mamawi_slope, na.rm = TRUE)

#Run BAM
pt = proc.time()
Mamawi_bam_invar_width <- run_bam_invar_width_default(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_invar_width",
                                                        slope =  Mamawi_slope, qobs = Mamawi_corr_Q, rivname = "Mamawi",
                                                        minQ = min(Mamawi_corr_Q$Q), maxQ = max(Mamawi_corr_Q$Q),
                                                        wse = Mamawi_WSE_corrQ)
library(hydroGOF)
Mamawi_val_invar_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_invar_width",
                                    Mamawi_corr_Q$Q)
Mamawi_val_invar_width <- Mamawi_val_invar_width[order(Mamawi_val_invar_width$num_xs),]
Mamawi_stats_invar_width <- bam_val_stats(Mamawi_val_invar_width)
Mamawi_plot_invar_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_invar_width",
                                      Mamawi_corr_Q$Q)
proc.time()-pt

#With new priors
pt = proc.time()
Mamawi_bam_invar_width_priors <- run_bam_invar_width_Q(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_invar_width_priors",
                                                         slope =  Mamawi_slope, qobs = Mamawi_corr_Q, rivname = "Mamawi",
                                                         minQ = min(Mamawi_corr_Q$Q), maxQ = max(Mamawi_corr_Q$Q),
                                                         wse = Mamawi_WSE_corrQ)
library(hydroGOF)
Mamawi_val_invar_width_priors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_invar_width_priors",
                                           Mamawi_corr_Q$Q)
Mamawi_val_invar_width_priors <- Mamawi_val_invar_width_priors[order(Mamawi_val_invar_width_priors$num_xs),]
Mamawi_stats_invar_width_priors <- bam_val_stats(Mamawi_val_invar_width_priors)
Mamawi_plot_invar_width_priors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_invar_width_priors",
                                             Mamawi_corr_Q$Q)
proc.time()-pt


#With new priors and Q prior
pt = proc.time()
Mamawi_bam_invar_width_Qpriors <- run_bam_invar_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_invar_width_Qpriors",
                                                        slope =  Mamawi_slope, qobs = Mamawi_corr_Q, rivname = "Mamawi",
                                                        wse = Mamawi_WSE_corrQ)
library(hydroGOF)
Mamawi_val_invar_width_Qpriors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_invar_width_Qpriors",
                                            Mamawi_corr_Q$Q)
Mamawi_val_invar_width_Qpriors <- Mamawi_val_invar_width_Qpriors[order(Mamawi_val_invar_width_Qpriors$num_xs),]
Mamawi_stats_invar_width_Qpriors <- bam_val_stats(Mamawi_val_invar_width_Qpriors)
Mamawi_plot_invar_width_Qpriors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_invar_width_Qpriors",
                                              Mamawi_corr_Q$Q)
proc.time()-pt

#var width
pt = proc.time()
Mamawi_bam_var_width <- run_bam_var_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_var_width",
                                            slope =  Mamawi_slope, qobs = Mamawi_corr_Q, rivname = "Mamawi",
                                            wse = Mamawi_WSE_corrQ)
library(hydroGOF)
Mamawi_val_var_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_var_width",
                                  Mamawi_corr_Q$Q)
Mamawi_val_var_width <- Mamawi_val_var_width[order(Mamawi_val_var_width$num_xs),]
Mamawi_stats_var_width <- bam_val_stats(Mamawi_val_var_width)
Mamawi_plot_var_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_var_width",
                                    Mamawi_corr_Q$Q)
proc.time()-pt


#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/Gauge_All")
Mamawi_temp_gauge_all <- temporary_gauge_all(num_days = nrow(Mamawi_WSE_corrQ), 
                                               pt_count = ncol(Mamawi_WSE_corrQ), 
                                               file_name = "Mamawi",
                                               WSE_mat = t(Mamawi_WSE_corrQ), 
                                               Qobs = Mamawi_corr_Q$Q)
Mamawi_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/Gauge_All",
                                      Mamawi_corr_Q$Q)

#Load BAM results from old method of estimating width from DEM
library(hydroGOF)
Mamawi_val_corr_Q <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Mamawi/BAM_corrQ",
                               Mamawi_corr_Q$Q)
Mamawi_val_corr_Q <- Mamawi_val_corr_Q[order(Mamawi_val_corr_Q$num_xs),]
Mamawi_stats_corr_Q <- bam_val_stats(Mamawi_val_corr_Q)

#Plot total time and all error metrics--------
#KGE
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Mamawi_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Mamawi_corr_Q$Q)), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$kge - Mamawi_stats_invar_width$kge_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$kge + Mamawi_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$kge - Mamawi_stats_invar_width_priors$kge_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$kge + Mamawi_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$kge - Mamawi_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$kge + Mamawi_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$kge - Mamawi_stats_var_width$kge_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$kge + Mamawi_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Mamawi_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Mamawi_corr_Q$Q)), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$nash - Mamawi_stats_invar_width$nash_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$nash + Mamawi_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$nash - Mamawi_stats_invar_width_priors$nash_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$nash + Mamawi_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$nash - Mamawi_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$nash + Mamawi_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$nash - Mamawi_stats_var_width$nash_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$nash + Mamawi_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Mamawi_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Mamawi_corr_Q$Q)), 
        ylim= c(0.15, 0.25)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$rrmse - Mamawi_stats_invar_width$rrmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$rrmse + Mamawi_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$rrmse - Mamawi_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$rrmse + Mamawi_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$rrmse - Mamawi_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$rrmse + Mamawi_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$rrmse - Mamawi_stats_var_width$rrmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$rrmse + Mamawi_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Mamawi_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Mamawi_corr_Q$Q)), 
        ylim= c(0.8, 1.6)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$n_rmse - Mamawi_stats_invar_width$n_rmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$n_rmse + Mamawi_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$n_rmse - Mamawi_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$n_rmse + Mamawi_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$n_rmse - Mamawi_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$n_rmse + Mamawi_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$n_rmse - Mamawi_stats_var_width$n_rmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$n_rmse + Mamawi_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Mamawi_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Mamawi_corr_Q$Q)), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$p_bias - Mamawi_stats_invar_width$p_bias_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$p_bias + Mamawi_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$p_bias - Mamawi_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$p_bias + Mamawi_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$p_bias - Mamawi_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$p_bias + Mamawi_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$p_bias - Mamawi_stats_var_width$p_bias_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$p_bias + Mamawi_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(63, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot 10 time steps to show tradeoff better-------------
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Mamawi_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$kge - Mamawi_stats_invar_width$kge_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$kge + Mamawi_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$kge - Mamawi_stats_invar_width_priors$kge_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$kge + Mamawi_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$kge - Mamawi_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$kge + Mamawi_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$kge - Mamawi_stats_var_width$kge_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$kge + Mamawi_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Mamawi_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$nash - Mamawi_stats_invar_width$nash_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$nash + Mamawi_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$nash - Mamawi_stats_invar_width_priors$nash_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$nash + Mamawi_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$nash - Mamawi_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$nash + Mamawi_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$nash - Mamawi_stats_var_width$nash_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$nash + Mamawi_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Mamawi_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$rrmse - Mamawi_stats_invar_width$rrmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$rrmse + Mamawi_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$rrmse - Mamawi_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$rrmse + Mamawi_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$rrmse - Mamawi_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$rrmse + Mamawi_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$rrmse - Mamawi_stats_var_width$rrmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$rrmse + Mamawi_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Mamawi_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(80, 200)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$n_rmse - Mamawi_stats_invar_width$n_rmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$n_rmse + Mamawi_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$n_rmse - Mamawi_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$n_rmse + Mamawi_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$n_rmse - Mamawi_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$n_rmse + Mamawi_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$n_rmse - Mamawi_stats_var_width$n_rmse_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$n_rmse + Mamawi_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Mamawi_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Mamawi_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$p_bias - Mamawi_stats_invar_width$p_bias_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width$p_bias + Mamawi_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$p_bias - Mamawi_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_priors$p_bias + Mamawi_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$p_bias - Mamawi_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_invar_width_Qpriors$p_bias + Mamawi_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Mamawi_WSE_corrQ)-1)), Mamawi_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$p_bias - Mamawi_stats_var_width$p_bias_sd, c(0:(nrow(Mamawi_WSE_corrQ)-1)), 
       Mamawi_stats_var_width$p_bias + Mamawi_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(14, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot multiple error metric comparison------
#2 discharge samples-----
Mamawi_temp_gauge_all_kge_2 <- na.omit(Mamawi_gauge_all$kge[Mamawi_gauge_all$num_xs == 1.9])
Mamawi_temp_gauge_all_nash_2 <- na.omit(Mamawi_gauge_all$nash[Mamawi_gauge_all$num_xs == 1.9])
Mamawi_temp_gauge_all_rrmse_2 <- na.omit(Mamawi_gauge_all$rrmse[Mamawi_gauge_all$num_xs == 1.9])
Mamawi_temp_gauge_all_n_rmse_2 <- na.omit(Mamawi_gauge_all$n_rmse[Mamawi_gauge_all$num_xs == 1.9])
Mamawi_temp_gauge_all_p_bias_2 <- na.omit(Mamawi_gauge_all$p_bias[Mamawi_gauge_all$num_xs == 1.9])

Mamawi_invar_width_kge_2 <- Mamawi_stats_invar_width$kge[c(1,2)]
Mamawi_invar_width_nash_2 <- Mamawi_stats_invar_width$nash[c(1,2)]
Mamawi_invar_width_rrmse_2 <- Mamawi_stats_invar_width$rrmse[c(1,2)]
Mamawi_invar_width_n_rmse_2 <- Mamawi_stats_invar_width$n_rmse[c(1,2)]
Mamawi_invar_width_p_bias_2 <- Mamawi_stats_invar_width$p_bias[c(1,2)]

Mamawi_var_width_kge_2 <- Mamawi_stats_var_width$kge[c(1,2)]
Mamawi_var_width_nash_2 <- Mamawi_stats_var_width$nash[c(1,2)]
Mamawi_var_width_rrmse_2 <- Mamawi_stats_var_width$rrmse[c(1,2)]
Mamawi_var_width_n_rmse_2 <- Mamawi_stats_var_width$n_rmse[c(1,2)]
Mamawi_var_width_p_bias_2 <- Mamawi_stats_var_width$p_bias[c(1,2)]

Mamawi_invar_width_priors_kge_2 <- Mamawi_stats_invar_width_priors$kge[c(1,2)]
Mamawi_invar_width_priors_nash_2 <- Mamawi_stats_invar_width_priors$nash[c(1,2)]
Mamawi_invar_width_priors_rrmse_2 <- Mamawi_stats_invar_width_priors$rrmse[c(1,2)]
Mamawi_invar_width_priors_n_rmse_2 <- Mamawi_stats_invar_width_priors$n_rmse[c(1,2)]
Mamawi_invar_width_priors_p_bias_2 <- Mamawi_stats_invar_width_priors$p_bias[c(1,2)]

Mamawi_invar_width_Qpriors_kge_2 <- Mamawi_stats_invar_width_Qpriors$kge[c(1,2)]
Mamawi_invar_width_Qpriors_nash_2 <- Mamawi_stats_invar_width_Qpriors$nash[c(1,2)]
Mamawi_invar_width_Qpriors_rrmse_2 <- Mamawi_stats_invar_width_Qpriors$rrmse[c(1,2)]
Mamawi_invar_width_Qpriors_n_rmse_2 <- Mamawi_stats_invar_width_Qpriors$n_rmse[c(1,2)]
Mamawi_invar_width_Qpriors_p_bias_2 <- Mamawi_stats_invar_width_Qpriors$p_bias[c(1,2)]

dev.off()
par(mfrow = c(2,2))
par(family = "serif")
boxplot(Mamawi_temp_gauge_all_kge_2, Mamawi_invar_width_kge_2, Mamawi_invar_width_priors_kge_2, 
        Mamawi_invar_width_Qpriors_kge_2, Mamawi_var_width_kge_2, 
        Mamawi_temp_gauge_all_nash_2, Mamawi_invar_width_nash_2, Mamawi_invar_width_priors_nash_2, 
        Mamawi_invar_width_Qpriors_nash_2, Mamawi_var_width_nash_2, 
        Mamawi_temp_gauge_all_rrmse_2, Mamawi_invar_width_rrmse_2, Mamawi_invar_width_priors_rrmse_2, 
        Mamawi_invar_width_Qpriors_rrmse_2, Mamawi_var_width_rrmse_2, 
        Mamawi_temp_gauge_all_n_rmse_2, Mamawi_invar_width_n_rmse_2, Mamawi_invar_width_priors_n_rmse_2, 
        Mamawi_invar_width_Qpriors_n_rmse_2, Mamawi_var_width_n_rmse_2, 
        Mamawi_temp_gauge_all_p_bias_2, Mamawi_invar_width_p_bias_2, Mamawi_invar_width_priors_p_bias_2, 
        Mamawi_invar_width_Qpriors_p_bias_2, Mamawi_var_width_p_bias_2, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
#3-5 discharge samples------
Mamawi_temp_gauge_all_kge_5 <- na.omit(Mamawi_gauge_all$kge[Mamawi_gauge_all$num_xs > 1.9 & Mamawi_gauge_all$num_xs < 6.9])
Mamawi_temp_gauge_all_nash_5 <- na.omit(Mamawi_gauge_all$nash[Mamawi_gauge_all$num_xs > 1.9 & Mamawi_gauge_all$num_xs < 6.9])
Mamawi_temp_gauge_all_rrmse_5 <- na.omit(Mamawi_gauge_all$rrmse[Mamawi_gauge_all$num_xs > 1.9 & Mamawi_gauge_all$num_xs < 6.9])
Mamawi_temp_gauge_all_n_rmse_5 <- na.omit(Mamawi_gauge_all$n_rmse[Mamawi_gauge_all$num_xs > 1.9 & Mamawi_gauge_all$num_xs < 6.9])
Mamawi_temp_gauge_all_p_bias_5 <- na.omit(Mamawi_gauge_all$p_bias[Mamawi_gauge_all$num_xs > 1.9 & Mamawi_gauge_all$num_xs < 6.9])

Mamawi_invar_width_kge_5 <- Mamawi_stats_invar_width$kge[c(3:5)]
Mamawi_invar_width_nash_5 <- Mamawi_stats_invar_width$nash[c(3:5)]
Mamawi_invar_width_rrmse_5 <- Mamawi_stats_invar_width$rrmse[c(3:5)]
Mamawi_invar_width_n_rmse_5 <- Mamawi_stats_invar_width$n_rmse[c(3:5)]
Mamawi_invar_width_p_bias_5 <- Mamawi_stats_invar_width$p_bias[c(3:5)]

Mamawi_var_width_kge_5 <- Mamawi_stats_var_width$kge[c(3:5)]
Mamawi_var_width_nash_5 <- Mamawi_stats_var_width$nash[c(3:5)]
Mamawi_var_width_rrmse_5 <- Mamawi_stats_var_width$rrmse[c(3:5)]
Mamawi_var_width_n_rmse_5 <- Mamawi_stats_var_width$n_rmse[c(3:5)]
Mamawi_var_width_p_bias_5 <- Mamawi_stats_var_width$p_bias[c(3:5)]

Mamawi_invar_width_priors_kge_5 <- Mamawi_stats_invar_width_priors$kge[c(3:5)]
Mamawi_invar_width_priors_nash_5 <- Mamawi_stats_invar_width_priors$nash[c(3:5)]
Mamawi_invar_width_priors_rrmse_5 <- Mamawi_stats_invar_width_priors$rrmse[c(3:5)]
Mamawi_invar_width_priors_n_rmse_5 <- Mamawi_stats_invar_width_priors$n_rmse[c(3:5)]
Mamawi_invar_width_priors_p_bias_5 <- Mamawi_stats_invar_width_priors$p_bias[c(3:5)]

Mamawi_invar_width_Qpriors_kge_5 <- Mamawi_stats_invar_width_Qpriors$kge[c(3:5)]
Mamawi_invar_width_Qpriors_nash_5 <- Mamawi_stats_invar_width_Qpriors$nash[c(3:5)]
Mamawi_invar_width_Qpriors_rrmse_5 <- Mamawi_stats_invar_width_Qpriors$rrmse[c(3:5)]
Mamawi_invar_width_Qpriors_n_rmse_5 <- Mamawi_stats_invar_width_Qpriors$n_rmse[c(3:5)]
Mamawi_invar_width_Qpriors_p_bias_5 <- Mamawi_stats_invar_width_Qpriors$p_bias[c(3:5)]

boxplot(Mamawi_temp_gauge_all_kge_5, Mamawi_invar_width_kge_5, Mamawi_invar_width_priors_kge_5, 
        Mamawi_invar_width_Qpriors_kge_5, Mamawi_var_width_kge_5, 
        Mamawi_temp_gauge_all_nash_5, Mamawi_invar_width_nash_5, Mamawi_invar_width_priors_nash_5, 
        Mamawi_invar_width_Qpriors_nash_5, Mamawi_var_width_nash_5, 
        Mamawi_temp_gauge_all_rrmse_5, Mamawi_invar_width_rrmse_5, Mamawi_invar_width_priors_rrmse_5, 
        Mamawi_invar_width_Qpriors_rrmse_5, Mamawi_var_width_rrmse_5, 
        Mamawi_temp_gauge_all_n_rmse_5, Mamawi_invar_width_n_rmse_5, Mamawi_invar_width_priors_n_rmse_5, 
        Mamawi_invar_width_Qpriors_n_rmse_5, Mamawi_var_width_n_rmse_5, 
        Mamawi_temp_gauge_all_p_bias_5, Mamawi_invar_width_p_bias_5, Mamawi_invar_width_priors_p_bias_5, 
        Mamawi_invar_width_Qpriors_p_bias_5, Mamawi_var_width_p_bias_5, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#6-10 discharge samples
Mamawi_temp_gauge_all_kge_10 <- na.omit(Mamawi_gauge_all$kge[Mamawi_gauge_all$num_xs > 5.9 & Mamawi_gauge_all$num_xs < 11.9])
Mamawi_temp_gauge_all_nash_10 <- na.omit(Mamawi_gauge_all$nash[Mamawi_gauge_all$num_xs > 5.9 & Mamawi_gauge_all$num_xs < 11.9])
Mamawi_temp_gauge_all_rrmse_10 <- na.omit(Mamawi_gauge_all$rrmse[Mamawi_gauge_all$num_xs > 5.9 & Mamawi_gauge_all$num_xs < 11.9])
Mamawi_temp_gauge_all_n_rmse_10 <- na.omit(Mamawi_gauge_all$n_rmse[Mamawi_gauge_all$num_xs > 5.9 & Mamawi_gauge_all$num_xs < 11.9])
Mamawi_temp_gauge_all_p_bias_10 <- na.omit(Mamawi_gauge_all$p_bias[Mamawi_gauge_all$num_xs > 5.9 & Mamawi_gauge_all$num_xs < 11.9])

Mamawi_invar_width_kge_10 <- Mamawi_stats_invar_width$kge[c(6:10)]
Mamawi_invar_width_nash_10 <- Mamawi_stats_invar_width$nash[c(6:10)]
Mamawi_invar_width_rrmse_10 <- Mamawi_stats_invar_width$rrmse[c(6:10)]
Mamawi_invar_width_n_rmse_10 <- Mamawi_stats_invar_width$n_rmse[c(6:10)]
Mamawi_invar_width_p_bias_10 <- Mamawi_stats_invar_width$p_bias[c(6:10)]

Mamawi_var_width_kge_10 <- Mamawi_stats_var_width$kge[c(6:10)]
Mamawi_var_width_nash_10 <- Mamawi_stats_var_width$nash[c(6:10)]
Mamawi_var_width_rrmse_10 <- Mamawi_stats_var_width$rrmse[c(6:10)]
Mamawi_var_width_n_rmse_10 <- Mamawi_stats_var_width$n_rmse[c(6:10)]
Mamawi_var_width_p_bias_10 <- Mamawi_stats_var_width$p_bias[c(6:10)]

Mamawi_invar_width_priors_kge_10 <- Mamawi_stats_invar_width_priors$kge[c(6:10)]
Mamawi_invar_width_priors_nash_10 <- Mamawi_stats_invar_width_priors$nash[c(6:10)]
Mamawi_invar_width_priors_rrmse_10 <- Mamawi_stats_invar_width_priors$rrmse[c(6:10)]
Mamawi_invar_width_priors_n_rmse_10 <- Mamawi_stats_invar_width_priors$n_rmse[c(6:10)]
Mamawi_invar_width_priors_p_bias_10 <- Mamawi_stats_invar_width_priors$p_bias[c(6:10)]

Mamawi_invar_width_Qpriors_kge_10 <- Mamawi_stats_invar_width_Qpriors$kge[c(6:10)]
Mamawi_invar_width_Qpriors_nash_10 <- Mamawi_stats_invar_width_Qpriors$nash[c(6:10)]
Mamawi_invar_width_Qpriors_rrmse_10 <- Mamawi_stats_invar_width_Qpriors$rrmse[c(6:10)]
Mamawi_invar_width_Qpriors_n_rmse_10 <- Mamawi_stats_invar_width_Qpriors$n_rmse[c(6:10)]
Mamawi_invar_width_Qpriors_p_bias_10 <- Mamawi_stats_invar_width_Qpriors$p_bias[c(6:10)]

boxplot(Mamawi_temp_gauge_all_kge_10, Mamawi_invar_width_kge_10, Mamawi_invar_width_priors_kge_10, 
        Mamawi_invar_width_Qpriors_kge_10, Mamawi_var_width_kge_10, 
        Mamawi_temp_gauge_all_nash_10, Mamawi_invar_width_nash_10, Mamawi_invar_width_priors_nash_10, 
        Mamawi_invar_width_Qpriors_nash_10, Mamawi_var_width_nash_10, 
        Mamawi_temp_gauge_all_rrmse_10, Mamawi_invar_width_rrmse_10, Mamawi_invar_width_priors_rrmse_10, 
        Mamawi_invar_width_Qpriors_rrmse_10, Mamawi_var_width_rrmse_10, 
        Mamawi_temp_gauge_all_n_rmse_10, Mamawi_invar_width_n_rmse_10, Mamawi_invar_width_priors_n_rmse_10, 
        Mamawi_invar_width_Qpriors_n_rmse_10, Mamawi_var_width_n_rmse_10, 
        Mamawi_temp_gauge_all_p_bias_10, Mamawi_invar_width_p_bias_10, Mamawi_invar_width_priors_p_bias_10, 
        Mamawi_invar_width_Qpriors_p_bias_10, Mamawi_var_width_p_bias_10, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#11-46 discharge samples
Mamawi_temp_gauge_all_kge_46 <- na.omit(Mamawi_gauge_all$kge[Mamawi_gauge_all$num_xs > 10.9])
Mamawi_temp_gauge_all_nash_46 <- na.omit(Mamawi_gauge_all$nash[Mamawi_gauge_all$num_xs > 10.9])
Mamawi_temp_gauge_all_rrmse_46 <- na.omit(Mamawi_gauge_all$rrmse[Mamawi_gauge_all$num_xs > 10.9])
Mamawi_temp_gauge_all_n_rmse_46 <- na.omit(Mamawi_gauge_all$r_rmse[Mamawi_gauge_all$num_xs > 10.9])
Mamawi_temp_gauge_all_p_bias_46 <- na.omit(Mamawi_gauge_all$p_bias[Mamawi_gauge_all$num_xs > 10.9])

Mamawi_invar_width_kge_46 <- Mamawi_stats_invar_width$kge[c(11:46)]
Mamawi_invar_width_nash_46 <- Mamawi_stats_invar_width$nash[c(11:46)]
Mamawi_invar_width_rrmse_46 <- Mamawi_stats_invar_width$rrmse[c(11:46)]
Mamawi_invar_width_n_rmse_46 <- Mamawi_stats_invar_width$n_rmse[c(11:46)]
Mamawi_invar_width_p_bias_46 <- Mamawi_stats_invar_width$p_bias[c(11:46)]

Mamawi_var_width_kge_46 <- Mamawi_stats_var_width$kge[c(11:46)]
Mamawi_var_width_nash_46 <- Mamawi_stats_var_width$nash[c(11:46)]
Mamawi_var_width_rrmse_46 <- Mamawi_stats_var_width$rrmse[c(11:46)]
Mamawi_var_width_n_rmse_46 <- Mamawi_stats_var_width$n_rmse[c(11:46)]
Mamawi_var_width_p_bias_46 <- Mamawi_stats_var_width$p_bias[c(11:46)]

Mamawi_invar_width_priors_kge_46 <- Mamawi_stats_invar_width_priors$kge[c(11:46)]
Mamawi_invar_width_priors_nash_46 <- Mamawi_stats_invar_width_priors$nash[c(11:46)]
Mamawi_invar_width_priors_rrmse_46 <- Mamawi_stats_invar_width_priors$rrmse[c(11:46)]
Mamawi_invar_width_priors_n_rmse_46 <- Mamawi_stats_invar_width_priors$n_rmse[c(11:46)]
Mamawi_invar_width_priors_p_bias_46 <- Mamawi_stats_invar_width_priors$p_bias[c(11:46)]

Mamawi_invar_width_Qpriors_kge_46 <- Mamawi_stats_invar_width_Qpriors$kge[c(11:46)]
Mamawi_invar_width_Qpriors_nash_46 <- Mamawi_stats_invar_width_Qpriors$nash[c(11:46)]
Mamawi_invar_width_Qpriors_rrmse_46 <- Mamawi_stats_invar_width_Qpriors$rrmse[c(11:46)]
Mamawi_invar_width_Qpriors_n_rmse_46 <- Mamawi_stats_invar_width_Qpriors$n_rmse[c(11:46)]
Mamawi_invar_width_Qpriors_p_bias_46 <- Mamawi_stats_invar_width_Qpriors$p_bias[c(11:46)]

boxplot(Mamawi_temp_gauge_all_kge_46, Mamawi_invar_width_kge_46, Mamawi_invar_width_priors_kge_46, 
        Mamawi_invar_width_Qpriors_kge_46, Mamawi_var_width_kge_46, 
        Mamawi_temp_gauge_all_nash_46, Mamawi_invar_width_nash_46, Mamawi_invar_width_priors_nash_46, 
        Mamawi_invar_width_Qpriors_nash_46, Mamawi_var_width_nash_46, 
        Mamawi_temp_gauge_all_rrmse_46, Mamawi_invar_width_rrmse_46, Mamawi_invar_width_priors_rrmse_46, 
        Mamawi_invar_width_Qpriors_rrmse_46, Mamawi_var_width_rrmse_46, 
        Mamawi_temp_gauge_all_n_rmse_46, Mamawi_invar_width_n_rmse_46, Mamawi_invar_width_priors_n_rmse_46, 
        Mamawi_invar_width_Qpriors_n_rmse_46, Mamawi_var_width_n_rmse_46, 
        Mamawi_temp_gauge_all_p_bias_46, Mamawi_invar_width_p_bias_46, Mamawi_invar_width_priors_p_bias_46, 
        Mamawi_invar_width_Qpriors_p_bias_46, Mamawi_var_width_p_bias_46, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
legend("bottomleft", legend = c("Temporary Gauge", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                                "Var width new priors"), pch = c(15), 
       cex = 1,
       col = c("aquamarine4", "blue", "purple", "magenta","orange"))
#Remake plots only ranging from -1 to 0.5
boxplot(Mamawi_temp_gauge_all_kge_2, Mamawi_invar_width_kge_2, Mamawi_invar_width_priors_kge_2, 
        Mamawi_invar_width_Qpriors_kge_2, Mamawi_var_width_kge_2, 
        Mamawi_temp_gauge_all_nash_2, Mamawi_invar_width_nash_2, Mamawi_invar_width_priors_nash_2, 
        Mamawi_invar_width_Qpriors_nash_2, Mamawi_var_width_nash_2, 
        Mamawi_temp_gauge_all_rrmse_2, Mamawi_invar_width_rrmse_2, Mamawi_invar_width_priors_rrmse_2, 
        Mamawi_invar_width_Qpriors_rrmse_2, Mamawi_var_width_rrmse_2, 
        Mamawi_temp_gauge_all_n_rmse_2, Mamawi_invar_width_n_rmse_2, Mamawi_invar_width_priors_n_rmse_2, 
        Mamawi_invar_width_Qpriors_n_rmse_2, Mamawi_var_width_n_rmse_2, 
        Mamawi_temp_gauge_all_p_bias_2, Mamawi_invar_width_p_bias_2, Mamawi_invar_width_priors_p_bias_2, 
        Mamawi_invar_width_Qpriors_p_bias_2, Mamawi_var_width_p_bias_2, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Mamawi_temp_gauge_all_kge_5, Mamawi_invar_width_kge_5, Mamawi_invar_width_priors_kge_5, 
        Mamawi_invar_width_Qpriors_kge_5, Mamawi_var_width_kge_5, 
        Mamawi_temp_gauge_all_nash_5, Mamawi_invar_width_nash_5, Mamawi_invar_width_priors_nash_5, 
        Mamawi_invar_width_Qpriors_nash_5, Mamawi_var_width_nash_5, 
        Mamawi_temp_gauge_all_rrmse_5, Mamawi_invar_width_rrmse_5, Mamawi_invar_width_priors_rrmse_5, 
        Mamawi_invar_width_Qpriors_rrmse_5, Mamawi_var_width_rrmse_5, 
        Mamawi_temp_gauge_all_n_rmse_5, Mamawi_invar_width_n_rmse_5, Mamawi_invar_width_priors_n_rmse_5, 
        Mamawi_invar_width_Qpriors_n_rmse_5, Mamawi_var_width_n_rmse_5, 
        Mamawi_temp_gauge_all_p_bias_5, Mamawi_invar_width_p_bias_5, Mamawi_invar_width_priors_p_bias_5, 
        Mamawi_invar_width_Qpriors_p_bias_5, Mamawi_var_width_p_bias_5, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Mamawi_temp_gauge_all_kge_10, Mamawi_invar_width_kge_10, Mamawi_invar_width_priors_kge_10, 
        Mamawi_invar_width_Qpriors_kge_10, Mamawi_var_width_kge_10, 
        Mamawi_temp_gauge_all_nash_10, Mamawi_invar_width_nash_10, Mamawi_invar_width_priors_nash_10, 
        Mamawi_invar_width_Qpriors_nash_10, Mamawi_var_width_nash_10, 
        Mamawi_temp_gauge_all_rrmse_10, Mamawi_invar_width_rrmse_10, Mamawi_invar_width_priors_rrmse_10, 
        Mamawi_invar_width_Qpriors_rrmse_10, Mamawi_var_width_rrmse_10, 
        Mamawi_temp_gauge_all_n_rmse_10, Mamawi_invar_width_n_rmse_10, Mamawi_invar_width_priors_n_rmse_10, 
        Mamawi_invar_width_Qpriors_n_rmse_10, Mamawi_var_width_n_rmse_10, 
        Mamawi_temp_gauge_all_p_bias_10, Mamawi_invar_width_p_bias_10, Mamawi_invar_width_priors_p_bias_10, 
        Mamawi_invar_width_Qpriors_p_bias_10, Mamawi_var_width_p_bias_10, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Mamawi_temp_gauge_all_kge_46, Mamawi_invar_width_kge_46, Mamawi_invar_width_priors_kge_46, 
        Mamawi_invar_width_Qpriors_kge_46, Mamawi_var_width_kge_46, 
        Mamawi_temp_gauge_all_nash_46, Mamawi_invar_width_nash_46, Mamawi_invar_width_priors_nash_46, 
        Mamawi_invar_width_Qpriors_nash_46, Mamawi_var_width_nash_46, 
        Mamawi_temp_gauge_all_rrmse_46, Mamawi_invar_width_rrmse_46, Mamawi_invar_width_priors_rrmse_46, 
        Mamawi_invar_width_Qpriors_rrmse_46, Mamawi_var_width_rrmse_46, 
        Mamawi_temp_gauge_all_n_rmse_46, Mamawi_invar_width_n_rmse_46, Mamawi_invar_width_priors_n_rmse_46, 
        Mamawi_invar_width_Qpriors_n_rmse_46, Mamawi_var_width_n_rmse_46, 
        Mamawi_temp_gauge_all_p_bias_46, Mamawi_invar_width_p_bias_46, Mamawi_invar_width_priors_p_bias_46, 
        Mamawi_invar_width_Qpriors_p_bias_46, Mamawi_var_width_p_bias_46, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")



###QF------
#load WSE
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT/QF/WSE")
QF_WSE <- read.csv("QF_WSE_PPP_corr.csv")
QF_WSE <- QF_WSE %>%
  mutate(day = as.Date(new_time, format="%Y-%m-%d"))
QF_WSE_daily <- aggregate(. ~day, data = QF_WSE, mean, na.rm = TRUE)[1,c(3:ncol(QF_WSE))]

#load Q
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF")
QF_corr_Q <- read.csv("QF_corr_Q.csv")
QF_corr_Q <- QF_corr_Q[QF_corr_Q$Q > 300 & QF_corr_Q$Q < 400,]
QF_corr_Q <- QF_corr_Q %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
QF_qobs_daily <- aggregate(. ~day, data = QF_corr_Q[,c(6,8,9,14)], 
                               mean, na.rm = TRUE)[,2]

#load cl and PT coords
setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF", sep =""))
QF_cl <-readOGR(dsn = ".", layer = "QF_CL_UTM")

setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT", sep =""))
QF_PT_coords <- read.csv("QF_PT_coords.csv")
QF_PT_coords_sp <-SpatialPoints(QF_PT_coords[,4:5], 
                                    proj4string = crs('+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0' ))
#calculate the distance between pts
QF_xvec <- calc_xvec(QF_PT_coords_sp, QF_cl)
save(QF_xvec, file = "QF_xvec.RData")
#find overlapping ADCP and PT times
QF_closest_time <- vector(length = length(QF_corr_Q$new_date))
for(i in 1:length(QF_corr_Q$new_date)){
  QF_closest_time[i] = which.min(abs(as.POSIXct(QF_WSE$new_time, tz = "MST") - 
                                           as.POSIXct(QF_corr_Q$new_date[i], tz = "MST")))
}

QF_WSE_corrQ <- QF_WSE[c(QF_closest_time[order(QF_closest_time)]),c(3:8)]

#Calculate slope
QF_slope <- -1*calcslope(sort(QF_xvec[c(1:6)]), hmat = t(QF_WSE_corrQ[, order(QF_xvec[c(1:6)])]))
QF_slope[1,] <- colMeans(QF_slope, na.rm = TRUE)

#Run BAM
pt = proc.time()
QF_bam_invar_width <- run_bam_invar_width_default(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_invar_width",
                                                      slope =  QF_slope, qobs = QF_corr_Q, rivname = "QF",
                                                      minQ = min(QF_corr_Q$Q), maxQ = max(QF_corr_Q$Q),
                                                      wse = QF_WSE_corrQ)
library(hydroGOF)
QF_val_invar_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_invar_width",
                                  QF_corr_Q$Q)
QF_val_invar_width <- QF_val_invar_width[order(QF_val_invar_width$num_xs),]
QF_stats_invar_width <- bam_val_stats(QF_val_invar_width)
QF_plot_invar_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_invar_width",
                                    QF_corr_Q$Q)
proc.time()-pt

#With new priors
pt = proc.time()
QF_bam_invar_width_priors <- run_bam_invar_width_Q(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_invar_width_priors",
                                                       slope =  QF_slope, qobs = QF_corr_Q, rivname = "QF",
                                                       minQ = min(QF_corr_Q$Q), maxQ = max(QF_corr_Q$Q),
                                                       wse = QF_WSE_corrQ)
library(hydroGOF)
QF_val_invar_width_priors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_invar_width_priors",
                                         QF_corr_Q$Q)
QF_val_invar_width_priors <- QF_val_invar_width_priors[order(QF_val_invar_width_priors$num_xs),]
QF_stats_invar_width_priors <- bam_val_stats(QF_val_invar_width_priors)
QF_plot_invar_width_priors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_invar_width_priors",
                                           QF_corr_Q$Q)
proc.time()-pt


#With new priors and Q prior
pt = proc.time()
QF_bam_invar_width_Qpriors <- run_bam_invar_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_invar_width_Qpriors",
                                                      slope =  QF_slope, qobs = QF_corr_Q, rivname = "QF",
                                                      wse = QF_WSE_corrQ)
library(hydroGOF)
QF_val_invar_width_Qpriors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_invar_width_Qpriors",
                                          QF_corr_Q$Q)
QF_val_invar_width_Qpriors <- QF_val_invar_width_Qpriors[order(QF_val_invar_width_Qpriors$num_xs),]
QF_stats_invar_width_Qpriors <- bam_val_stats(QF_val_invar_width_Qpriors)
QF_plot_invar_width_Qpriors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_invar_width_Qpriors",
                                            QF_corr_Q$Q)
proc.time()-pt

#var width
pt = proc.time()
QF_bam_var_width <- run_bam_var_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_var_width",
                                          slope =  QF_slope, qobs = QF_corr_Q, rivname = "QF",
                                          wse = QF_WSE_corrQ)
library(hydroGOF)
QF_val_var_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_var_width",
                                QF_corr_Q$Q)
QF_val_var_width <- QF_val_var_width[order(QF_val_var_width$num_xs),]
QF_stats_var_width <- bam_val_stats(QF_val_var_width)
QF_plot_var_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_var_width",
                                  QF_corr_Q$Q)
proc.time()-pt


#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/Gauge_All")
QF_temp_gauge_all <- temporary_gauge_all(num_days = nrow(QF_WSE_corrQ), 
                                             pt_count = ncol(QF_WSE_corrQ), 
                                             file_name = "QF",
                                             WSE_mat = t(QF_WSE_corrQ), 
                                             Qobs = QF_corr_Q$Q)
QF_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/Gauge_All",
                                    QF_corr_Q$Q)

#Load BAM results from old method of estimating width from DEM
library(hydroGOF)
QF_val_corr_Q <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/QF/BAM_corrQ",
                             QF_corr_Q$Q)
QF_val_corr_Q <- QF_val_corr_Q[order(QF_val_corr_Q$num_xs),]
QF_stats_corr_Q <- bam_val_stats(QF_val_corr_Q)

#Plot total time and all error metrics--------
#KGE
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= QF_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(QF_corr_Q$Q)), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$kge - QF_stats_invar_width$kge_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$kge + QF_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$kge - QF_stats_invar_width_priors$kge_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$kge + QF_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$kge - QF_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$kge + QF_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$kge - QF_stats_var_width$kge_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$kge + QF_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= QF_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(QF_corr_Q$Q)), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$nash - QF_stats_invar_width$nash_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$nash + QF_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$nash - QF_stats_invar_width_priors$nash_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$nash + QF_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$nash - QF_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$nash + QF_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$nash - QF_stats_var_width$nash_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$nash + QF_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= QF_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(QF_corr_Q$Q)), 
        ylim= c(0.15, 0.25)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$rrmse - QF_stats_invar_width$rrmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$rrmse + QF_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$rrmse - QF_stats_invar_width_priors$rrmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$rrmse + QF_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$rrmse - QF_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$rrmse + QF_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$rrmse - QF_stats_var_width$rrmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$rrmse + QF_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= QF_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(QF_corr_Q$Q)), 
        ylim= c(0.8, 1.6)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$n_rmse - QF_stats_invar_width$n_rmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$n_rmse + QF_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$n_rmse - QF_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$n_rmse + QF_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$n_rmse - QF_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$n_rmse + QF_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$n_rmse - QF_stats_var_width$n_rmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$n_rmse + QF_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= QF_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(QF_corr_Q$Q)), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$p_bias - QF_stats_invar_width$p_bias_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$p_bias + QF_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$p_bias - QF_stats_invar_width_priors$p_bias_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$p_bias + QF_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$p_bias - QF_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$p_bias + QF_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$p_bias - QF_stats_var_width$p_bias_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$p_bias + QF_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(63, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot 10 time steps to show tradeoff better-------------
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= QF_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$kge - QF_stats_invar_width$kge_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$kge + QF_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$kge - QF_stats_invar_width_priors$kge_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$kge + QF_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$kge - QF_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$kge + QF_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$kge - QF_stats_var_width$kge_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$kge + QF_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= QF_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$nash - QF_stats_invar_width$nash_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$nash + QF_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$nash - QF_stats_invar_width_priors$nash_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$nash + QF_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$nash - QF_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$nash + QF_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$nash - QF_stats_var_width$nash_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$nash + QF_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= QF_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$rrmse - QF_stats_invar_width$rrmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$rrmse + QF_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$rrmse - QF_stats_invar_width_priors$rrmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$rrmse + QF_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$rrmse - QF_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$rrmse + QF_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$rrmse - QF_stats_var_width$rrmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$rrmse + QF_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= QF_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(80, 200)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$n_rmse - QF_stats_invar_width$n_rmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$n_rmse + QF_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$n_rmse - QF_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$n_rmse + QF_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$n_rmse - QF_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$n_rmse + QF_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$n_rmse - QF_stats_var_width$n_rmse_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$n_rmse + QF_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= QF_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(QF_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(QF_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$p_bias - QF_stats_invar_width$p_bias_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width$p_bias + QF_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$p_bias - QF_stats_invar_width_priors$p_bias_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_priors$p_bias + QF_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$p_bias - QF_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_invar_width_Qpriors$p_bias + QF_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(QF_WSE_corrQ)-1)), QF_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$p_bias - QF_stats_var_width$p_bias_sd, c(0:(nrow(QF_WSE_corrQ)-1)), 
       QF_stats_var_width$p_bias + QF_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(14, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot multiple error metric comparison------
#2 discharge samples-----
QF_temp_gauge_all_kge_2 <- na.omit(QF_gauge_all$kge[QF_gauge_all$num_xs == 1.9])
QF_temp_gauge_all_nash_2 <- na.omit(QF_gauge_all$nash[QF_gauge_all$num_xs == 1.9])
QF_temp_gauge_all_rrmse_2 <- na.omit(QF_gauge_all$rrmse[QF_gauge_all$num_xs == 1.9])
QF_temp_gauge_all_n_rmse_2 <- na.omit(QF_gauge_all$n_rmse[QF_gauge_all$num_xs == 1.9])
QF_temp_gauge_all_p_bias_2 <- na.omit(QF_gauge_all$p_bias[QF_gauge_all$num_xs == 1.9])

QF_invar_width_kge_2 <- QF_stats_invar_width$kge[c(1,2)]
QF_invar_width_nash_2 <- QF_stats_invar_width$nash[c(1,2)]
QF_invar_width_rrmse_2 <- QF_stats_invar_width$rrmse[c(1,2)]
QF_invar_width_n_rmse_2 <- QF_stats_invar_width$n_rmse[c(1,2)]
QF_invar_width_p_bias_2 <- QF_stats_invar_width$p_bias[c(1,2)]

QF_var_width_kge_2 <- QF_stats_var_width$kge[c(1,2)]
QF_var_width_nash_2 <- QF_stats_var_width$nash[c(1,2)]
QF_var_width_rrmse_2 <- QF_stats_var_width$rrmse[c(1,2)]
QF_var_width_n_rmse_2 <- QF_stats_var_width$n_rmse[c(1,2)]
QF_var_width_p_bias_2 <- QF_stats_var_width$p_bias[c(1,2)]

QF_invar_width_priors_kge_2 <- QF_stats_invar_width_priors$kge[c(1,2)]
QF_invar_width_priors_nash_2 <- QF_stats_invar_width_priors$nash[c(1,2)]
QF_invar_width_priors_rrmse_2 <- QF_stats_invar_width_priors$rrmse[c(1,2)]
QF_invar_width_priors_n_rmse_2 <- QF_stats_invar_width_priors$n_rmse[c(1,2)]
QF_invar_width_priors_p_bias_2 <- QF_stats_invar_width_priors$p_bias[c(1,2)]

QF_invar_width_Qpriors_kge_2 <- QF_stats_invar_width_Qpriors$kge[c(1,2)]
QF_invar_width_Qpriors_nash_2 <- QF_stats_invar_width_Qpriors$nash[c(1,2)]
QF_invar_width_Qpriors_rrmse_2 <- QF_stats_invar_width_Qpriors$rrmse[c(1,2)]
QF_invar_width_Qpriors_n_rmse_2 <- QF_stats_invar_width_Qpriors$n_rmse[c(1,2)]
QF_invar_width_Qpriors_p_bias_2 <- QF_stats_invar_width_Qpriors$p_bias[c(1,2)]

dev.off()
par(mfrow = c(2,2))
par(family = "serif")
boxplot(QF_temp_gauge_all_kge_2, QF_invar_width_kge_2, QF_invar_width_priors_kge_2, 
        QF_invar_width_Qpriors_kge_2, QF_var_width_kge_2, 
        QF_temp_gauge_all_nash_2, QF_invar_width_nash_2, QF_invar_width_priors_nash_2, 
        QF_invar_width_Qpriors_nash_2, QF_var_width_nash_2, 
        QF_temp_gauge_all_rrmse_2, QF_invar_width_rrmse_2, QF_invar_width_priors_rrmse_2, 
        QF_invar_width_Qpriors_rrmse_2, QF_var_width_rrmse_2, 
        QF_temp_gauge_all_n_rmse_2, QF_invar_width_n_rmse_2, QF_invar_width_priors_n_rmse_2, 
        QF_invar_width_Qpriors_n_rmse_2, QF_var_width_n_rmse_2, 
        QF_temp_gauge_all_p_bias_2, QF_invar_width_p_bias_2, QF_invar_width_priors_p_bias_2, 
        QF_invar_width_Qpriors_p_bias_2, QF_var_width_p_bias_2, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
#3-5 discharge samples------
QF_temp_gauge_all_kge_5 <- na.omit(QF_gauge_all$kge[QF_gauge_all$num_xs > 1.9 & QF_gauge_all$num_xs < 6.9])
QF_temp_gauge_all_nash_5 <- na.omit(QF_gauge_all$nash[QF_gauge_all$num_xs > 1.9 & QF_gauge_all$num_xs < 6.9])
QF_temp_gauge_all_rrmse_5 <- na.omit(QF_gauge_all$rrmse[QF_gauge_all$num_xs > 1.9 & QF_gauge_all$num_xs < 6.9])
QF_temp_gauge_all_n_rmse_5 <- na.omit(QF_gauge_all$n_rmse[QF_gauge_all$num_xs > 1.9 & QF_gauge_all$num_xs < 6.9])
QF_temp_gauge_all_p_bias_5 <- na.omit(QF_gauge_all$p_bias[QF_gauge_all$num_xs > 1.9 & QF_gauge_all$num_xs < 6.9])

QF_invar_width_kge_5 <- QF_stats_invar_width$kge[c(3:5)]
QF_invar_width_nash_5 <- QF_stats_invar_width$nash[c(3:5)]
QF_invar_width_rrmse_5 <- QF_stats_invar_width$rrmse[c(3:5)]
QF_invar_width_n_rmse_5 <- QF_stats_invar_width$n_rmse[c(3:5)]
QF_invar_width_p_bias_5 <- QF_stats_invar_width$p_bias[c(3:5)]

QF_var_width_kge_5 <- QF_stats_var_width$kge[c(3:5)]
QF_var_width_nash_5 <- QF_stats_var_width$nash[c(3:5)]
QF_var_width_rrmse_5 <- QF_stats_var_width$rrmse[c(3:5)]
QF_var_width_n_rmse_5 <- QF_stats_var_width$n_rmse[c(3:5)]
QF_var_width_p_bias_5 <- QF_stats_var_width$p_bias[c(3:5)]

QF_invar_width_priors_kge_5 <- QF_stats_invar_width_priors$kge[c(3:5)]
QF_invar_width_priors_nash_5 <- QF_stats_invar_width_priors$nash[c(3:5)]
QF_invar_width_priors_rrmse_5 <- QF_stats_invar_width_priors$rrmse[c(3:5)]
QF_invar_width_priors_n_rmse_5 <- QF_stats_invar_width_priors$n_rmse[c(3:5)]
QF_invar_width_priors_p_bias_5 <- QF_stats_invar_width_priors$p_bias[c(3:5)]

QF_invar_width_Qpriors_kge_5 <- QF_stats_invar_width_Qpriors$kge[c(3:5)]
QF_invar_width_Qpriors_nash_5 <- QF_stats_invar_width_Qpriors$nash[c(3:5)]
QF_invar_width_Qpriors_rrmse_5 <- QF_stats_invar_width_Qpriors$rrmse[c(3:5)]
QF_invar_width_Qpriors_n_rmse_5 <- QF_stats_invar_width_Qpriors$n_rmse[c(3:5)]
QF_invar_width_Qpriors_p_bias_5 <- QF_stats_invar_width_Qpriors$p_bias[c(3:5)]

boxplot(QF_temp_gauge_all_kge_5, QF_invar_width_kge_5, QF_invar_width_priors_kge_5, 
        QF_invar_width_Qpriors_kge_5, QF_var_width_kge_5, 
        QF_temp_gauge_all_nash_5, QF_invar_width_nash_5, QF_invar_width_priors_nash_5, 
        QF_invar_width_Qpriors_nash_5, QF_var_width_nash_5, 
        QF_temp_gauge_all_rrmse_5, QF_invar_width_rrmse_5, QF_invar_width_priors_rrmse_5, 
        QF_invar_width_Qpriors_rrmse_5, QF_var_width_rrmse_5, 
        QF_temp_gauge_all_n_rmse_5, QF_invar_width_n_rmse_5, QF_invar_width_priors_n_rmse_5, 
        QF_invar_width_Qpriors_n_rmse_5, QF_var_width_n_rmse_5, 
        QF_temp_gauge_all_p_bias_5, QF_invar_width_p_bias_5, QF_invar_width_priors_p_bias_5, 
        QF_invar_width_Qpriors_p_bias_5, QF_var_width_p_bias_5, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#6-10 discharge samples
QF_temp_gauge_all_kge_10 <- na.omit(QF_gauge_all$kge[QF_gauge_all$num_xs > 5.9 & QF_gauge_all$num_xs < 11.9])
QF_temp_gauge_all_nash_10 <- na.omit(QF_gauge_all$nash[QF_gauge_all$num_xs > 5.9 & QF_gauge_all$num_xs < 11.9])
QF_temp_gauge_all_rrmse_10 <- na.omit(QF_gauge_all$rrmse[QF_gauge_all$num_xs > 5.9 & QF_gauge_all$num_xs < 11.9])
QF_temp_gauge_all_n_rmse_10 <- na.omit(QF_gauge_all$n_rmse[QF_gauge_all$num_xs > 5.9 & QF_gauge_all$num_xs < 11.9])
QF_temp_gauge_all_p_bias_10 <- na.omit(QF_gauge_all$p_bias[QF_gauge_all$num_xs > 5.9 & QF_gauge_all$num_xs < 11.9])

QF_invar_width_kge_10 <- QF_stats_invar_width$kge[c(6:10)]
QF_invar_width_nash_10 <- QF_stats_invar_width$nash[c(6:10)]
QF_invar_width_rrmse_10 <- QF_stats_invar_width$rrmse[c(6:10)]
QF_invar_width_n_rmse_10 <- QF_stats_invar_width$n_rmse[c(6:10)]
QF_invar_width_p_bias_10 <- QF_stats_invar_width$p_bias[c(6:10)]

QF_var_width_kge_10 <- QF_stats_var_width$kge[c(6:10)]
QF_var_width_nash_10 <- QF_stats_var_width$nash[c(6:10)]
QF_var_width_rrmse_10 <- QF_stats_var_width$rrmse[c(6:10)]
QF_var_width_n_rmse_10 <- QF_stats_var_width$n_rmse[c(6:10)]
QF_var_width_p_bias_10 <- QF_stats_var_width$p_bias[c(6:10)]

QF_invar_width_priors_kge_10 <- QF_stats_invar_width_priors$kge[c(6:10)]
QF_invar_width_priors_nash_10 <- QF_stats_invar_width_priors$nash[c(6:10)]
QF_invar_width_priors_rrmse_10 <- QF_stats_invar_width_priors$rrmse[c(6:10)]
QF_invar_width_priors_n_rmse_10 <- QF_stats_invar_width_priors$n_rmse[c(6:10)]
QF_invar_width_priors_p_bias_10 <- QF_stats_invar_width_priors$p_bias[c(6:10)]

QF_invar_width_Qpriors_kge_10 <- QF_stats_invar_width_Qpriors$kge[c(6:10)]
QF_invar_width_Qpriors_nash_10 <- QF_stats_invar_width_Qpriors$nash[c(6:10)]
QF_invar_width_Qpriors_rrmse_10 <- QF_stats_invar_width_Qpriors$rrmse[c(6:10)]
QF_invar_width_Qpriors_n_rmse_10 <- QF_stats_invar_width_Qpriors$n_rmse[c(6:10)]
QF_invar_width_Qpriors_p_bias_10 <- QF_stats_invar_width_Qpriors$p_bias[c(6:10)]

boxplot(QF_temp_gauge_all_kge_10, QF_invar_width_kge_10, QF_invar_width_priors_kge_10, 
        QF_invar_width_Qpriors_kge_10, QF_var_width_kge_10, 
        QF_temp_gauge_all_nash_10, QF_invar_width_nash_10, QF_invar_width_priors_nash_10, 
        QF_invar_width_Qpriors_nash_10, QF_var_width_nash_10, 
        QF_temp_gauge_all_rrmse_10, QF_invar_width_rrmse_10, QF_invar_width_priors_rrmse_10, 
        QF_invar_width_Qpriors_rrmse_10, QF_var_width_rrmse_10, 
        QF_temp_gauge_all_n_rmse_10, QF_invar_width_n_rmse_10, QF_invar_width_priors_n_rmse_10, 
        QF_invar_width_Qpriors_n_rmse_10, QF_var_width_n_rmse_10, 
        QF_temp_gauge_all_p_bias_10, QF_invar_width_p_bias_10, QF_invar_width_priors_p_bias_10, 
        QF_invar_width_Qpriors_p_bias_10, QF_var_width_p_bias_10, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#11-46 discharge samples
QF_temp_gauge_all_kge_46 <- na.omit(QF_gauge_all$kge[QF_gauge_all$num_xs > 10.9])
QF_temp_gauge_all_nash_46 <- na.omit(QF_gauge_all$nash[QF_gauge_all$num_xs > 10.9])
QF_temp_gauge_all_rrmse_46 <- na.omit(QF_gauge_all$rrmse[QF_gauge_all$num_xs > 10.9])
QF_temp_gauge_all_n_rmse_46 <- na.omit(QF_gauge_all$r_rmse[QF_gauge_all$num_xs > 10.9])
QF_temp_gauge_all_p_bias_46 <- na.omit(QF_gauge_all$p_bias[QF_gauge_all$num_xs > 10.9])

QF_invar_width_kge_46 <- QF_stats_invar_width$kge[c(11:46)]
QF_invar_width_nash_46 <- QF_stats_invar_width$nash[c(11:46)]
QF_invar_width_rrmse_46 <- QF_stats_invar_width$rrmse[c(11:46)]
QF_invar_width_n_rmse_46 <- QF_stats_invar_width$n_rmse[c(11:46)]
QF_invar_width_p_bias_46 <- QF_stats_invar_width$p_bias[c(11:46)]

QF_var_width_kge_46 <- QF_stats_var_width$kge[c(11:46)]
QF_var_width_nash_46 <- QF_stats_var_width$nash[c(11:46)]
QF_var_width_rrmse_46 <- QF_stats_var_width$rrmse[c(11:46)]
QF_var_width_n_rmse_46 <- QF_stats_var_width$n_rmse[c(11:46)]
QF_var_width_p_bias_46 <- QF_stats_var_width$p_bias[c(11:46)]

QF_invar_width_priors_kge_46 <- QF_stats_invar_width_priors$kge[c(11:46)]
QF_invar_width_priors_nash_46 <- QF_stats_invar_width_priors$nash[c(11:46)]
QF_invar_width_priors_rrmse_46 <- QF_stats_invar_width_priors$rrmse[c(11:46)]
QF_invar_width_priors_n_rmse_46 <- QF_stats_invar_width_priors$n_rmse[c(11:46)]
QF_invar_width_priors_p_bias_46 <- QF_stats_invar_width_priors$p_bias[c(11:46)]

QF_invar_width_Qpriors_kge_46 <- QF_stats_invar_width_Qpriors$kge[c(11:46)]
QF_invar_width_Qpriors_nash_46 <- QF_stats_invar_width_Qpriors$nash[c(11:46)]
QF_invar_width_Qpriors_rrmse_46 <- QF_stats_invar_width_Qpriors$rrmse[c(11:46)]
QF_invar_width_Qpriors_n_rmse_46 <- QF_stats_invar_width_Qpriors$n_rmse[c(11:46)]
QF_invar_width_Qpriors_p_bias_46 <- QF_stats_invar_width_Qpriors$p_bias[c(11:46)]

boxplot(QF_temp_gauge_all_kge_46, QF_invar_width_kge_46, QF_invar_width_priors_kge_46, 
        QF_invar_width_Qpriors_kge_46, QF_var_width_kge_46, 
        QF_temp_gauge_all_nash_46, QF_invar_width_nash_46, QF_invar_width_priors_nash_46, 
        QF_invar_width_Qpriors_nash_46, QF_var_width_nash_46, 
        QF_temp_gauge_all_rrmse_46, QF_invar_width_rrmse_46, QF_invar_width_priors_rrmse_46, 
        QF_invar_width_Qpriors_rrmse_46, QF_var_width_rrmse_46, 
        QF_temp_gauge_all_n_rmse_46, QF_invar_width_n_rmse_46, QF_invar_width_priors_n_rmse_46, 
        QF_invar_width_Qpriors_n_rmse_46, QF_var_width_n_rmse_46, 
        QF_temp_gauge_all_p_bias_46, QF_invar_width_p_bias_46, QF_invar_width_priors_p_bias_46, 
        QF_invar_width_Qpriors_p_bias_46, QF_var_width_p_bias_46, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
legend("bottomleft", legend = c("Temporary Gauge", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                                "Var width new priors"), pch = c(15), 
       cex = 1,
       col = c("aquamarine4", "blue", "purple", "magenta","orange"))
#Remake plots only ranging from -1 to 0.5
boxplot(QF_temp_gauge_all_kge_2, QF_invar_width_kge_2, QF_invar_width_priors_kge_2, 
        QF_invar_width_Qpriors_kge_2, QF_var_width_kge_2, 
        QF_temp_gauge_all_nash_2, QF_invar_width_nash_2, QF_invar_width_priors_nash_2, 
        QF_invar_width_Qpriors_nash_2, QF_var_width_nash_2, 
        QF_temp_gauge_all_rrmse_2, QF_invar_width_rrmse_2, QF_invar_width_priors_rrmse_2, 
        QF_invar_width_Qpriors_rrmse_2, QF_var_width_rrmse_2, 
        QF_temp_gauge_all_n_rmse_2, QF_invar_width_n_rmse_2, QF_invar_width_priors_n_rmse_2, 
        QF_invar_width_Qpriors_n_rmse_2, QF_var_width_n_rmse_2, 
        QF_temp_gauge_all_p_bias_2, QF_invar_width_p_bias_2, QF_invar_width_priors_p_bias_2, 
        QF_invar_width_Qpriors_p_bias_2, QF_var_width_p_bias_2, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(QF_temp_gauge_all_kge_5, QF_invar_width_kge_5, QF_invar_width_priors_kge_5, 
        QF_invar_width_Qpriors_kge_5, QF_var_width_kge_5, 
        QF_temp_gauge_all_nash_5, QF_invar_width_nash_5, QF_invar_width_priors_nash_5, 
        QF_invar_width_Qpriors_nash_5, QF_var_width_nash_5, 
        QF_temp_gauge_all_rrmse_5, QF_invar_width_rrmse_5, QF_invar_width_priors_rrmse_5, 
        QF_invar_width_Qpriors_rrmse_5, QF_var_width_rrmse_5, 
        QF_temp_gauge_all_n_rmse_5, QF_invar_width_n_rmse_5, QF_invar_width_priors_n_rmse_5, 
        QF_invar_width_Qpriors_n_rmse_5, QF_var_width_n_rmse_5, 
        QF_temp_gauge_all_p_bias_5, QF_invar_width_p_bias_5, QF_invar_width_priors_p_bias_5, 
        QF_invar_width_Qpriors_p_bias_5, QF_var_width_p_bias_5, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(QF_temp_gauge_all_kge_10, QF_invar_width_kge_10, QF_invar_width_priors_kge_10, 
        QF_invar_width_Qpriors_kge_10, QF_var_width_kge_10, 
        QF_temp_gauge_all_nash_10, QF_invar_width_nash_10, QF_invar_width_priors_nash_10, 
        QF_invar_width_Qpriors_nash_10, QF_var_width_nash_10, 
        QF_temp_gauge_all_rrmse_10, QF_invar_width_rrmse_10, QF_invar_width_priors_rrmse_10, 
        QF_invar_width_Qpriors_rrmse_10, QF_var_width_rrmse_10, 
        QF_temp_gauge_all_n_rmse_10, QF_invar_width_n_rmse_10, QF_invar_width_priors_n_rmse_10, 
        QF_invar_width_Qpriors_n_rmse_10, QF_var_width_n_rmse_10, 
        QF_temp_gauge_all_p_bias_10, QF_invar_width_p_bias_10, QF_invar_width_priors_p_bias_10, 
        QF_invar_width_Qpriors_p_bias_10, QF_var_width_p_bias_10, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(QF_temp_gauge_all_kge_46, QF_invar_width_kge_46, QF_invar_width_priors_kge_46, 
        QF_invar_width_Qpriors_kge_46, QF_var_width_kge_46, 
        QF_temp_gauge_all_nash_46, QF_invar_width_nash_46, QF_invar_width_priors_nash_46, 
        QF_invar_width_Qpriors_nash_46, QF_var_width_nash_46, 
        QF_temp_gauge_all_rrmse_46, QF_invar_width_rrmse_46, QF_invar_width_priors_rrmse_46, 
        QF_invar_width_Qpriors_rrmse_46, QF_var_width_rrmse_46, 
        QF_temp_gauge_all_n_rmse_46, QF_invar_width_n_rmse_46, QF_invar_width_priors_n_rmse_46, 
        QF_invar_width_Qpriors_n_rmse_46, QF_var_width_n_rmse_46, 
        QF_temp_gauge_all_p_bias_46, QF_invar_width_p_bias_46, QF_invar_width_priors_p_bias_46, 
        QF_invar_width_Qpriors_p_bias_46, QF_var_width_p_bias_46, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")





###Rochers------
#load WSE
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT/Rochers/WSE")
Rochers_WSE <- read.csv("Rochers_WSE_PPP_corr.csv")
Rochers_WSE <- Rochers_WSE %>%
  mutate(day = as.Date(new_time, format="%m/%d/%Y"))
Rochers_WSE_daily <- aggregate(. ~day, data = Rochers_WSE, mean, na.rm = TRUE)[1,c(4:ncol(Rochers_WSE))]
head(Rochers_WSE)
#load Q
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers")
Rochers_corr_Q <- read.csv("Rochers_corr_Q.csv")
Rochers_corr_Q <- Rochers_corr_Q %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Rochers_qobs_daily <- aggregate(. ~day, data = Rochers_corr_Q[,c(6,8,9,14)], 
                           mean, na.rm = TRUE)[,2]

#load cl and PT coords
setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers", sep =""))
Rochers_cl <-readOGR(dsn = ".", layer = "Rochers_CL_UTM")

setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT", sep =""))
Rochers_PT_coords <- read.csv("Rochers_PT_coords.csv")
Rochers_PT_coords_sp <-SpatialPoints(Rochers_PT_coords[,4:5], 
                                proj4string = crs('+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0' ))
#calculate the distance between pts
Rochers_xvec <- calc_xvec(Rochers_PT_coords_sp, Rochers_cl)
save(Rochers_xvec, file = "Rochers_xvec.RData")
#find overlapping ADCP and PT times
Rochers_closest_time <- vector(length = length(Rochers_corr_Q$new_date))
for(i in 1:length(Rochers_corr_Q$new_date)){
  Rochers_closest_time[i] = which.min(abs(as.POSIXct(Rochers_WSE$new_time, 
                                                     format = "%m/%d/%Y %H:%M", tz = "MST") - 
                                       as.POSIXct(Rochers_corr_Q$new_date[i], tz = "MST")))
}

Rochers_WSE_corrQ <- Rochers_WSE[c(Rochers_closest_time[order(Rochers_closest_time)]),c(3:7)]

#Calculate slope
Rochers_slope <- calcslope(rev(sort(Rochers_xvec[c(1:3,5,6)])), hmat = t(Rochers_WSE_corrQ[, order(Rochers_xvec[c(1:3,5,6)])]))
Rochers_slope[1,] <- colMeans(Rochers_slope, na.rm = TRUE)

#Run BAM
pt = proc.time()
Rochers_bam_invar_width <- run_bam_invar_width_default(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_invar_width",
                                                  slope =  Rochers_slope, qobs = Rochers_corr_Q, rivname = "Rochers",
                                                  minQ = min(Rochers_corr_Q$Q), maxQ = max(Rochers_corr_Q$Q),
                                                  wse = Rochers_WSE_corrQ)
library(hydroGOF)
Rochers_val_invar_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_invar_width",
                              Rochers_corr_Q$Q)
Rochers_val_invar_width <- Rochers_val_invar_width[order(Rochers_val_invar_width$num_xs),]
Rochers_stats_invar_width <- bam_val_stats(Rochers_val_invar_width)
Rochers_plot_invar_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_invar_width",
                                Rochers_corr_Q$Q)
proc.time()-pt

#With new priors
pt = proc.time()
Rochers_bam_invar_width_priors <- run_bam_invar_width_Q(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_invar_width_priors",
                                                   slope =  Rochers_slope, qobs = Rochers_corr_Q, rivname = "Rochers",
                                                   minQ = min(Rochers_corr_Q$Q), maxQ = max(Rochers_corr_Q$Q),
                                                   wse = Rochers_WSE_corrQ)
library(hydroGOF)
Rochers_val_invar_width_priors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_invar_width_priors",
                                     Rochers_corr_Q$Q)
Rochers_val_invar_width_priors <- Rochers_val_invar_width_priors[order(Rochers_val_invar_width_priors$num_xs),]
Rochers_stats_invar_width_priors <- bam_val_stats(Rochers_val_invar_width_priors)
Rochers_plot_invar_width_priors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_invar_width_priors",
                                       Rochers_corr_Q$Q)
proc.time()-pt


#With new priors and Q prior
pt = proc.time()
Rochers_bam_invar_width_Qpriors <- run_bam_invar_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_invar_width_Qpriors",
                                                  slope =  Rochers_slope, qobs = Rochers_corr_Q, rivname = "Rochers",
                                                  wse = Rochers_WSE_corrQ)
library(hydroGOF)
Rochers_val_invar_width_Qpriors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_invar_width_Qpriors",
                                      Rochers_corr_Q$Q)
Rochers_val_invar_width_Qpriors <- Rochers_val_invar_width_Qpriors[order(Rochers_val_invar_width_Qpriors$num_xs),]
Rochers_stats_invar_width_Qpriors <- bam_val_stats(Rochers_val_invar_width_Qpriors)
Rochers_plot_invar_width_Qpriors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_invar_width_Qpriors",
                                        Rochers_corr_Q$Q)
proc.time()-pt

#var width
pt = proc.time()
Rochers_bam_var_width <- run_bam_var_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_var_width",
                                      slope =  Rochers_slope, qobs = Rochers_corr_Q, rivname = "Rochers",
                                      wse = Rochers_WSE_corrQ)
library(hydroGOF)
Rochers_val_var_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_var_width",
                            Rochers_corr_Q$Q)
Rochers_val_var_width <- Rochers_val_var_width[order(Rochers_val_var_width$num_xs),]
Rochers_stats_var_width <- bam_val_stats(Rochers_val_var_width)
Rochers_plot_var_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_var_width",
                              Rochers_corr_Q$Q)
proc.time()-pt


#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/Gauge_All")
Rochers_temp_gauge_all <- temporary_gauge_all(num_days = nrow(Rochers_WSE_corrQ), 
                                         pt_count = ncol(Rochers_WSE_corrQ), 
                                         file_name = "Rochers",
                                         WSE_mat = t(Rochers_WSE_corrQ), 
                                         Qobs = Rochers_corr_Q$Q)
Rochers_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/Gauge_All",
                                Rochers_corr_Q$Q)

#Load BAM results from old method of estimating width from DEM
library(hydroGOF)
Rochers_val_corr_Q <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_corrQ",
                         Rochers_corr_Q$Q)
Rochers_val_corr_Q <- Rochers_val_corr_Q[order(Rochers_val_corr_Q$num_xs),]
Rochers_stats_corr_Q <- bam_val_stats(Rochers_val_corr_Q)

#Plot total time and all error metrics--------
#KGE
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Rochers_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Rochers_corr_Q$Q)), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$kge - Rochers_stats_invar_width$kge_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$kge + Rochers_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$kge - Rochers_stats_invar_width_priors$kge_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$kge + Rochers_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$kge - Rochers_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$kge + Rochers_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$kge - Rochers_stats_var_width$kge_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$kge + Rochers_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Rochers_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Rochers_corr_Q$Q)), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$nash - Rochers_stats_invar_width$nash_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$nash + Rochers_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$nash - Rochers_stats_invar_width_priors$nash_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$nash + Rochers_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$nash - Rochers_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$nash + Rochers_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$nash - Rochers_stats_var_width$nash_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$nash + Rochers_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Rochers_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Rochers_corr_Q$Q)), 
        ylim= c(0.15, 0.25)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$rrmse - Rochers_stats_invar_width$rrmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$rrmse + Rochers_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$rrmse - Rochers_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$rrmse + Rochers_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$rrmse - Rochers_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$rrmse + Rochers_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$rrmse - Rochers_stats_var_width$rrmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$rrmse + Rochers_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Rochers_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Rochers_corr_Q$Q)), 
        ylim= c(0.8, 1.6)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$n_rmse - Rochers_stats_invar_width$n_rmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$n_rmse + Rochers_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$n_rmse - Rochers_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$n_rmse + Rochers_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$n_rmse - Rochers_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$n_rmse + Rochers_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$n_rmse - Rochers_stats_var_width$n_rmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$n_rmse + Rochers_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Rochers_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Rochers_corr_Q$Q)), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$p_bias - Rochers_stats_invar_width$p_bias_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$p_bias + Rochers_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$p_bias - Rochers_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$p_bias + Rochers_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$p_bias - Rochers_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$p_bias + Rochers_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$p_bias - Rochers_stats_var_width$p_bias_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$p_bias + Rochers_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(63, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot 10 time steps to show tradeoff better-------------
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Rochers_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$kge - Rochers_stats_invar_width$kge_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$kge + Rochers_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$kge - Rochers_stats_invar_width_priors$kge_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$kge + Rochers_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$kge - Rochers_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$kge + Rochers_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$kge - Rochers_stats_var_width$kge_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$kge + Rochers_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Rochers_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$nash - Rochers_stats_invar_width$nash_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$nash + Rochers_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$nash - Rochers_stats_invar_width_priors$nash_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$nash + Rochers_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$nash - Rochers_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$nash + Rochers_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$nash - Rochers_stats_var_width$nash_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$nash + Rochers_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Rochers_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$rrmse - Rochers_stats_invar_width$rrmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$rrmse + Rochers_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$rrmse - Rochers_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$rrmse + Rochers_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$rrmse - Rochers_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$rrmse + Rochers_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$rrmse - Rochers_stats_var_width$rrmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$rrmse + Rochers_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Rochers_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(80, 200)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$n_rmse - Rochers_stats_invar_width$n_rmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$n_rmse + Rochers_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$n_rmse - Rochers_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$n_rmse + Rochers_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$n_rmse - Rochers_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$n_rmse + Rochers_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$n_rmse - Rochers_stats_var_width$n_rmse_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$n_rmse + Rochers_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Rochers_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Rochers_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$p_bias - Rochers_stats_invar_width$p_bias_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width$p_bias + Rochers_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$p_bias - Rochers_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_priors$p_bias + Rochers_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$p_bias - Rochers_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_invar_width_Qpriors$p_bias + Rochers_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Rochers_WSE_corrQ)-1)), Rochers_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$p_bias - Rochers_stats_var_width$p_bias_sd, c(0:(nrow(Rochers_WSE_corrQ)-1)), 
       Rochers_stats_var_width$p_bias + Rochers_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(14, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot multiple error metric comparison------
#2 discharge samples-----
Rochers_temp_gauge_all_kge_2 <- na.omit(Rochers_gauge_all$kge[Rochers_gauge_all$num_xs == 1.9])
Rochers_temp_gauge_all_nash_2 <- na.omit(Rochers_gauge_all$nash[Rochers_gauge_all$num_xs == 1.9])
Rochers_temp_gauge_all_rrmse_2 <- na.omit(Rochers_gauge_all$rrmse[Rochers_gauge_all$num_xs == 1.9])
Rochers_temp_gauge_all_n_rmse_2 <- na.omit(Rochers_gauge_all$n_rmse[Rochers_gauge_all$num_xs == 1.9])
Rochers_temp_gauge_all_p_bias_2 <- na.omit(Rochers_gauge_all$p_bias[Rochers_gauge_all$num_xs == 1.9])

Rochers_invar_width_kge_2 <- Rochers_stats_invar_width$kge[c(1,2)]
Rochers_invar_width_nash_2 <- Rochers_stats_invar_width$nash[c(1,2)]
Rochers_invar_width_rrmse_2 <- Rochers_stats_invar_width$rrmse[c(1,2)]
Rochers_invar_width_n_rmse_2 <- Rochers_stats_invar_width$n_rmse[c(1,2)]
Rochers_invar_width_p_bias_2 <- Rochers_stats_invar_width$p_bias[c(1,2)]

Rochers_var_width_kge_2 <- Rochers_stats_var_width$kge[c(1,2)]
Rochers_var_width_nash_2 <- Rochers_stats_var_width$nash[c(1,2)]
Rochers_var_width_rrmse_2 <- Rochers_stats_var_width$rrmse[c(1,2)]
Rochers_var_width_n_rmse_2 <- Rochers_stats_var_width$n_rmse[c(1,2)]
Rochers_var_width_p_bias_2 <- Rochers_stats_var_width$p_bias[c(1,2)]

Rochers_invar_width_priors_kge_2 <- Rochers_stats_invar_width_priors$kge[c(1,2)]
Rochers_invar_width_priors_nash_2 <- Rochers_stats_invar_width_priors$nash[c(1,2)]
Rochers_invar_width_priors_rrmse_2 <- Rochers_stats_invar_width_priors$rrmse[c(1,2)]
Rochers_invar_width_priors_n_rmse_2 <- Rochers_stats_invar_width_priors$n_rmse[c(1,2)]
Rochers_invar_width_priors_p_bias_2 <- Rochers_stats_invar_width_priors$p_bias[c(1,2)]

Rochers_invar_width_Qpriors_kge_2 <- Rochers_stats_invar_width_Qpriors$kge[c(1,2)]
Rochers_invar_width_Qpriors_nash_2 <- Rochers_stats_invar_width_Qpriors$nash[c(1,2)]
Rochers_invar_width_Qpriors_rrmse_2 <- Rochers_stats_invar_width_Qpriors$rrmse[c(1,2)]
Rochers_invar_width_Qpriors_n_rmse_2 <- Rochers_stats_invar_width_Qpriors$n_rmse[c(1,2)]
Rochers_invar_width_Qpriors_p_bias_2 <- Rochers_stats_invar_width_Qpriors$p_bias[c(1,2)]

dev.off()
par(mfrow = c(2,2))
par(family = "serif")
boxplot(Rochers_temp_gauge_all_kge_2, Rochers_invar_width_kge_2, Rochers_invar_width_priors_kge_2, 
        Rochers_invar_width_Qpriors_kge_2, Rochers_var_width_kge_2, 
        Rochers_temp_gauge_all_nash_2, Rochers_invar_width_nash_2, Rochers_invar_width_priors_nash_2, 
        Rochers_invar_width_Qpriors_nash_2, Rochers_var_width_nash_2, 
        Rochers_temp_gauge_all_rrmse_2, Rochers_invar_width_rrmse_2, Rochers_invar_width_priors_rrmse_2, 
        Rochers_invar_width_Qpriors_rrmse_2, Rochers_var_width_rrmse_2, 
        Rochers_temp_gauge_all_n_rmse_2, Rochers_invar_width_n_rmse_2, Rochers_invar_width_priors_n_rmse_2, 
        Rochers_invar_width_Qpriors_n_rmse_2, Rochers_var_width_n_rmse_2, 
        Rochers_temp_gauge_all_p_bias_2, Rochers_invar_width_p_bias_2, Rochers_invar_width_priors_p_bias_2, 
        Rochers_invar_width_Qpriors_p_bias_2, Rochers_var_width_p_bias_2, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
#3-5 discharge samples------
Rochers_temp_gauge_all_kge_5 <- na.omit(Rochers_gauge_all$kge[Rochers_gauge_all$num_xs > 1.9 & Rochers_gauge_all$num_xs < 6.9])
Rochers_temp_gauge_all_nash_5 <- na.omit(Rochers_gauge_all$nash[Rochers_gauge_all$num_xs > 1.9 & Rochers_gauge_all$num_xs < 6.9])
Rochers_temp_gauge_all_rrmse_5 <- na.omit(Rochers_gauge_all$rrmse[Rochers_gauge_all$num_xs > 1.9 & Rochers_gauge_all$num_xs < 6.9])
Rochers_temp_gauge_all_n_rmse_5 <- na.omit(Rochers_gauge_all$n_rmse[Rochers_gauge_all$num_xs > 1.9 & Rochers_gauge_all$num_xs < 6.9])
Rochers_temp_gauge_all_p_bias_5 <- na.omit(Rochers_gauge_all$p_bias[Rochers_gauge_all$num_xs > 1.9 & Rochers_gauge_all$num_xs < 6.9])

Rochers_invar_width_kge_5 <- Rochers_stats_invar_width$kge[c(3:5)]
Rochers_invar_width_nash_5 <- Rochers_stats_invar_width$nash[c(3:5)]
Rochers_invar_width_rrmse_5 <- Rochers_stats_invar_width$rrmse[c(3:5)]
Rochers_invar_width_n_rmse_5 <- Rochers_stats_invar_width$n_rmse[c(3:5)]
Rochers_invar_width_p_bias_5 <- Rochers_stats_invar_width$p_bias[c(3:5)]

Rochers_var_width_kge_5 <- Rochers_stats_var_width$kge[c(3:5)]
Rochers_var_width_nash_5 <- Rochers_stats_var_width$nash[c(3:5)]
Rochers_var_width_rrmse_5 <- Rochers_stats_var_width$rrmse[c(3:5)]
Rochers_var_width_n_rmse_5 <- Rochers_stats_var_width$n_rmse[c(3:5)]
Rochers_var_width_p_bias_5 <- Rochers_stats_var_width$p_bias[c(3:5)]

Rochers_invar_width_priors_kge_5 <- Rochers_stats_invar_width_priors$kge[c(3:5)]
Rochers_invar_width_priors_nash_5 <- Rochers_stats_invar_width_priors$nash[c(3:5)]
Rochers_invar_width_priors_rrmse_5 <- Rochers_stats_invar_width_priors$rrmse[c(3:5)]
Rochers_invar_width_priors_n_rmse_5 <- Rochers_stats_invar_width_priors$n_rmse[c(3:5)]
Rochers_invar_width_priors_p_bias_5 <- Rochers_stats_invar_width_priors$p_bias[c(3:5)]

Rochers_invar_width_Qpriors_kge_5 <- Rochers_stats_invar_width_Qpriors$kge[c(3:5)]
Rochers_invar_width_Qpriors_nash_5 <- Rochers_stats_invar_width_Qpriors$nash[c(3:5)]
Rochers_invar_width_Qpriors_rrmse_5 <- Rochers_stats_invar_width_Qpriors$rrmse[c(3:5)]
Rochers_invar_width_Qpriors_n_rmse_5 <- Rochers_stats_invar_width_Qpriors$n_rmse[c(3:5)]
Rochers_invar_width_Qpriors_p_bias_5 <- Rochers_stats_invar_width_Qpriors$p_bias[c(3:5)]

boxplot(Rochers_temp_gauge_all_kge_5, Rochers_invar_width_kge_5, Rochers_invar_width_priors_kge_5, 
        Rochers_invar_width_Qpriors_kge_5, Rochers_var_width_kge_5, 
        Rochers_temp_gauge_all_nash_5, Rochers_invar_width_nash_5, Rochers_invar_width_priors_nash_5, 
        Rochers_invar_width_Qpriors_nash_5, Rochers_var_width_nash_5, 
        Rochers_temp_gauge_all_rrmse_5, Rochers_invar_width_rrmse_5, Rochers_invar_width_priors_rrmse_5, 
        Rochers_invar_width_Qpriors_rrmse_5, Rochers_var_width_rrmse_5, 
        Rochers_temp_gauge_all_n_rmse_5, Rochers_invar_width_n_rmse_5, Rochers_invar_width_priors_n_rmse_5, 
        Rochers_invar_width_Qpriors_n_rmse_5, Rochers_var_width_n_rmse_5, 
        Rochers_temp_gauge_all_p_bias_5, Rochers_invar_width_p_bias_5, Rochers_invar_width_priors_p_bias_5, 
        Rochers_invar_width_Qpriors_p_bias_5, Rochers_var_width_p_bias_5, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#6-10 discharge samples
Rochers_temp_gauge_all_kge_10 <- na.omit(Rochers_gauge_all$kge[Rochers_gauge_all$num_xs > 5.9 & Rochers_gauge_all$num_xs < 11.9])
Rochers_temp_gauge_all_nash_10 <- na.omit(Rochers_gauge_all$nash[Rochers_gauge_all$num_xs > 5.9 & Rochers_gauge_all$num_xs < 11.9])
Rochers_temp_gauge_all_rrmse_10 <- na.omit(Rochers_gauge_all$rrmse[Rochers_gauge_all$num_xs > 5.9 & Rochers_gauge_all$num_xs < 11.9])
Rochers_temp_gauge_all_n_rmse_10 <- na.omit(Rochers_gauge_all$n_rmse[Rochers_gauge_all$num_xs > 5.9 & Rochers_gauge_all$num_xs < 11.9])
Rochers_temp_gauge_all_p_bias_10 <- na.omit(Rochers_gauge_all$p_bias[Rochers_gauge_all$num_xs > 5.9 & Rochers_gauge_all$num_xs < 11.9])

Rochers_invar_width_kge_10 <- Rochers_stats_invar_width$kge[c(6:10)]
Rochers_invar_width_nash_10 <- Rochers_stats_invar_width$nash[c(6:10)]
Rochers_invar_width_rrmse_10 <- Rochers_stats_invar_width$rrmse[c(6:10)]
Rochers_invar_width_n_rmse_10 <- Rochers_stats_invar_width$n_rmse[c(6:10)]
Rochers_invar_width_p_bias_10 <- Rochers_stats_invar_width$p_bias[c(6:10)]

Rochers_var_width_kge_10 <- Rochers_stats_var_width$kge[c(6:10)]
Rochers_var_width_nash_10 <- Rochers_stats_var_width$nash[c(6:10)]
Rochers_var_width_rrmse_10 <- Rochers_stats_var_width$rrmse[c(6:10)]
Rochers_var_width_n_rmse_10 <- Rochers_stats_var_width$n_rmse[c(6:10)]
Rochers_var_width_p_bias_10 <- Rochers_stats_var_width$p_bias[c(6:10)]

Rochers_invar_width_priors_kge_10 <- Rochers_stats_invar_width_priors$kge[c(6:10)]
Rochers_invar_width_priors_nash_10 <- Rochers_stats_invar_width_priors$nash[c(6:10)]
Rochers_invar_width_priors_rrmse_10 <- Rochers_stats_invar_width_priors$rrmse[c(6:10)]
Rochers_invar_width_priors_n_rmse_10 <- Rochers_stats_invar_width_priors$n_rmse[c(6:10)]
Rochers_invar_width_priors_p_bias_10 <- Rochers_stats_invar_width_priors$p_bias[c(6:10)]

Rochers_invar_width_Qpriors_kge_10 <- Rochers_stats_invar_width_Qpriors$kge[c(6:10)]
Rochers_invar_width_Qpriors_nash_10 <- Rochers_stats_invar_width_Qpriors$nash[c(6:10)]
Rochers_invar_width_Qpriors_rrmse_10 <- Rochers_stats_invar_width_Qpriors$rrmse[c(6:10)]
Rochers_invar_width_Qpriors_n_rmse_10 <- Rochers_stats_invar_width_Qpriors$n_rmse[c(6:10)]
Rochers_invar_width_Qpriors_p_bias_10 <- Rochers_stats_invar_width_Qpriors$p_bias[c(6:10)]

boxplot(Rochers_temp_gauge_all_kge_10, Rochers_invar_width_kge_10, Rochers_invar_width_priors_kge_10, 
        Rochers_invar_width_Qpriors_kge_10, Rochers_var_width_kge_10, 
        Rochers_temp_gauge_all_nash_10, Rochers_invar_width_nash_10, Rochers_invar_width_priors_nash_10, 
        Rochers_invar_width_Qpriors_nash_10, Rochers_var_width_nash_10, 
        Rochers_temp_gauge_all_rrmse_10, Rochers_invar_width_rrmse_10, Rochers_invar_width_priors_rrmse_10, 
        Rochers_invar_width_Qpriors_rrmse_10, Rochers_var_width_rrmse_10, 
        Rochers_temp_gauge_all_n_rmse_10, Rochers_invar_width_n_rmse_10, Rochers_invar_width_priors_n_rmse_10, 
        Rochers_invar_width_Qpriors_n_rmse_10, Rochers_var_width_n_rmse_10, 
        Rochers_temp_gauge_all_p_bias_10, Rochers_invar_width_p_bias_10, Rochers_invar_width_priors_p_bias_10, 
        Rochers_invar_width_Qpriors_p_bias_10, Rochers_var_width_p_bias_10, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#11-46 discharge samples
Rochers_temp_gauge_all_kge_46 <- na.omit(Rochers_gauge_all$kge[Rochers_gauge_all$num_xs > 10.9])
Rochers_temp_gauge_all_nash_46 <- na.omit(Rochers_gauge_all$nash[Rochers_gauge_all$num_xs > 10.9])
Rochers_temp_gauge_all_rrmse_46 <- na.omit(Rochers_gauge_all$rrmse[Rochers_gauge_all$num_xs > 10.9])
Rochers_temp_gauge_all_n_rmse_46 <- na.omit(Rochers_gauge_all$r_rmse[Rochers_gauge_all$num_xs > 10.9])
Rochers_temp_gauge_all_p_bias_46 <- na.omit(Rochers_gauge_all$p_bias[Rochers_gauge_all$num_xs > 10.9])

Rochers_invar_width_kge_46 <- Rochers_stats_invar_width$kge[c(11:46)]
Rochers_invar_width_nash_46 <- Rochers_stats_invar_width$nash[c(11:46)]
Rochers_invar_width_rrmse_46 <- Rochers_stats_invar_width$rrmse[c(11:46)]
Rochers_invar_width_n_rmse_46 <- Rochers_stats_invar_width$n_rmse[c(11:46)]
Rochers_invar_width_p_bias_46 <- Rochers_stats_invar_width$p_bias[c(11:46)]

Rochers_var_width_kge_46 <- Rochers_stats_var_width$kge[c(11:46)]
Rochers_var_width_nash_46 <- Rochers_stats_var_width$nash[c(11:46)]
Rochers_var_width_rrmse_46 <- Rochers_stats_var_width$rrmse[c(11:46)]
Rochers_var_width_n_rmse_46 <- Rochers_stats_var_width$n_rmse[c(11:46)]
Rochers_var_width_p_bias_46 <- Rochers_stats_var_width$p_bias[c(11:46)]

Rochers_invar_width_priors_kge_46 <- Rochers_stats_invar_width_priors$kge[c(11:46)]
Rochers_invar_width_priors_nash_46 <- Rochers_stats_invar_width_priors$nash[c(11:46)]
Rochers_invar_width_priors_rrmse_46 <- Rochers_stats_invar_width_priors$rrmse[c(11:46)]
Rochers_invar_width_priors_n_rmse_46 <- Rochers_stats_invar_width_priors$n_rmse[c(11:46)]
Rochers_invar_width_priors_p_bias_46 <- Rochers_stats_invar_width_priors$p_bias[c(11:46)]

Rochers_invar_width_Qpriors_kge_46 <- Rochers_stats_invar_width_Qpriors$kge[c(11:46)]
Rochers_invar_width_Qpriors_nash_46 <- Rochers_stats_invar_width_Qpriors$nash[c(11:46)]
Rochers_invar_width_Qpriors_rrmse_46 <- Rochers_stats_invar_width_Qpriors$rrmse[c(11:46)]
Rochers_invar_width_Qpriors_n_rmse_46 <- Rochers_stats_invar_width_Qpriors$n_rmse[c(11:46)]
Rochers_invar_width_Qpriors_p_bias_46 <- Rochers_stats_invar_width_Qpriors$p_bias[c(11:46)]

boxplot(Rochers_temp_gauge_all_kge_46, Rochers_invar_width_kge_46, Rochers_invar_width_priors_kge_46, 
        Rochers_invar_width_Qpriors_kge_46, Rochers_var_width_kge_46, 
        Rochers_temp_gauge_all_nash_46, Rochers_invar_width_nash_46, Rochers_invar_width_priors_nash_46, 
        Rochers_invar_width_Qpriors_nash_46, Rochers_var_width_nash_46, 
        Rochers_temp_gauge_all_rrmse_46, Rochers_invar_width_rrmse_46, Rochers_invar_width_priors_rrmse_46, 
        Rochers_invar_width_Qpriors_rrmse_46, Rochers_var_width_rrmse_46, 
        Rochers_temp_gauge_all_n_rmse_46, Rochers_invar_width_n_rmse_46, Rochers_invar_width_priors_n_rmse_46, 
        Rochers_invar_width_Qpriors_n_rmse_46, Rochers_var_width_n_rmse_46, 
        Rochers_temp_gauge_all_p_bias_46, Rochers_invar_width_p_bias_46, Rochers_invar_width_priors_p_bias_46, 
        Rochers_invar_width_Qpriors_p_bias_46, Rochers_var_width_p_bias_46, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
legend("bottomleft", legend = c("Temporary Gauge", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                                "Var width new priors"), pch = c(15), 
       cex = 1,
       col = c("aquamarine4", "blue", "purple", "magenta","orange"))
#Remake plots only ranging from -1 to 0.5
boxplot(Rochers_temp_gauge_all_kge_2, Rochers_invar_width_kge_2, Rochers_invar_width_priors_kge_2, 
        Rochers_invar_width_Qpriors_kge_2, Rochers_var_width_kge_2, 
        Rochers_temp_gauge_all_nash_2, Rochers_invar_width_nash_2, Rochers_invar_width_priors_nash_2, 
        Rochers_invar_width_Qpriors_nash_2, Rochers_var_width_nash_2, 
        Rochers_temp_gauge_all_rrmse_2, Rochers_invar_width_rrmse_2, Rochers_invar_width_priors_rrmse_2, 
        Rochers_invar_width_Qpriors_rrmse_2, Rochers_var_width_rrmse_2, 
        Rochers_temp_gauge_all_n_rmse_2, Rochers_invar_width_n_rmse_2, Rochers_invar_width_priors_n_rmse_2, 
        Rochers_invar_width_Qpriors_n_rmse_2, Rochers_var_width_n_rmse_2, 
        Rochers_temp_gauge_all_p_bias_2, Rochers_invar_width_p_bias_2, Rochers_invar_width_priors_p_bias_2, 
        Rochers_invar_width_Qpriors_p_bias_2, Rochers_var_width_p_bias_2, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Rochers_temp_gauge_all_kge_5, Rochers_invar_width_kge_5, Rochers_invar_width_priors_kge_5, 
        Rochers_invar_width_Qpriors_kge_5, Rochers_var_width_kge_5, 
        Rochers_temp_gauge_all_nash_5, Rochers_invar_width_nash_5, Rochers_invar_width_priors_nash_5, 
        Rochers_invar_width_Qpriors_nash_5, Rochers_var_width_nash_5, 
        Rochers_temp_gauge_all_rrmse_5, Rochers_invar_width_rrmse_5, Rochers_invar_width_priors_rrmse_5, 
        Rochers_invar_width_Qpriors_rrmse_5, Rochers_var_width_rrmse_5, 
        Rochers_temp_gauge_all_n_rmse_5, Rochers_invar_width_n_rmse_5, Rochers_invar_width_priors_n_rmse_5, 
        Rochers_invar_width_Qpriors_n_rmse_5, Rochers_var_width_n_rmse_5, 
        Rochers_temp_gauge_all_p_bias_5, Rochers_invar_width_p_bias_5, Rochers_invar_width_priors_p_bias_5, 
        Rochers_invar_width_Qpriors_p_bias_5, Rochers_var_width_p_bias_5, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Rochers_temp_gauge_all_kge_10, Rochers_invar_width_kge_10, Rochers_invar_width_priors_kge_10, 
        Rochers_invar_width_Qpriors_kge_10, Rochers_var_width_kge_10, 
        Rochers_temp_gauge_all_nash_10, Rochers_invar_width_nash_10, Rochers_invar_width_priors_nash_10, 
        Rochers_invar_width_Qpriors_nash_10, Rochers_var_width_nash_10, 
        Rochers_temp_gauge_all_rrmse_10, Rochers_invar_width_rrmse_10, Rochers_invar_width_priors_rrmse_10, 
        Rochers_invar_width_Qpriors_rrmse_10, Rochers_var_width_rrmse_10, 
        Rochers_temp_gauge_all_n_rmse_10, Rochers_invar_width_n_rmse_10, Rochers_invar_width_priors_n_rmse_10, 
        Rochers_invar_width_Qpriors_n_rmse_10, Rochers_var_width_n_rmse_10, 
        Rochers_temp_gauge_all_p_bias_10, Rochers_invar_width_p_bias_10, Rochers_invar_width_priors_p_bias_10, 
        Rochers_invar_width_Qpriors_p_bias_10, Rochers_var_width_p_bias_10, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Rochers_temp_gauge_all_kge_46, Rochers_invar_width_kge_46, Rochers_invar_width_priors_kge_46, 
        Rochers_invar_width_Qpriors_kge_46, Rochers_var_width_kge_46, 
        Rochers_temp_gauge_all_nash_46, Rochers_invar_width_nash_46, Rochers_invar_width_priors_nash_46, 
        Rochers_invar_width_Qpriors_nash_46, Rochers_var_width_nash_46, 
        Rochers_temp_gauge_all_rrmse_46, Rochers_invar_width_rrmse_46, Rochers_invar_width_priors_rrmse_46, 
        Rochers_invar_width_Qpriors_rrmse_46, Rochers_var_width_rrmse_46, 
        Rochers_temp_gauge_all_n_rmse_46, Rochers_invar_width_n_rmse_46, Rochers_invar_width_priors_n_rmse_46, 
        Rochers_invar_width_Qpriors_n_rmse_46, Rochers_var_width_n_rmse_46, 
        Rochers_temp_gauge_all_p_bias_46, Rochers_invar_width_p_bias_46, Rochers_invar_width_priors_p_bias_46, 
        Rochers_invar_width_Qpriors_p_bias_46, Rochers_var_width_p_bias_46, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")





###Embarras------
#load WSE
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/PAD_2019_PT/Embarras/WSE")
Embarras_WSE <- read.csv("Embarras_WSE_PPP_corr.csv")
Embarras_WSE <- Embarras_WSE %>%
  mutate(day = as.Date(new_time))
Embarras_WSE_daily <- aggregate(. ~day, data = Embarras_WSE, mean, na.rm = TRUE)[1,c(4:ncol(Embarras_WSE))]
head(Embarras_WSE)
#load Q
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras")
Embarras_corr_Q <- read.csv("Embarras_corr_Q.csv")
Embarras_corr_Q <- Embarras_corr_Q %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Embarras_qobs_daily <- aggregate(. ~day, data = Embarras_corr_Q[,c(6,8,9,14)], 
                                mean, na.rm = TRUE)[,2]

#load cl and PT coords
setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras", sep =""))
Embarras_cl <-readOGR(dsn = ".", layer = "Embarras_CL_UTM")

setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/PAD_2019_PT", sep =""))
Embarras_PT_coords <- read.csv("Embarras_PT_coords.csv")
Embarras_PT_coords_sp <-SpatialPoints(Embarras_PT_coords[,4:5], 
                                     proj4string = crs('+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0' ))
#calculate the distance between pts
Embarras_xvec <- calc_xvec(Embarras_PT_coords_sp, Embarras_cl)
save(Embarras_xvec, file = "Embarras_xvec.RData")
#find overlapping ADCP and PT times
Embarras_closest_time <- vector(length = length(Embarras_corr_Q$new_date))
for(i in 1:length(Embarras_corr_Q$new_date)){
  Embarras_closest_time[i] = which.min(abs(as.POSIXct(Embarras_WSE$new_time, tz = "MST") - 
                                            as.POSIXct(Embarras_corr_Q$new_date[i], tz = "MST")))
}

Embarras_WSE_corrQ <- Embarras_WSE[c(Embarras_closest_time[order(Embarras_closest_time)]),c(3:6)]

#Calculate slope
Embarras_slope <- abs(calcslope(sort(Embarras_xvec[c(1:2,4,5)]), hmat = t(Embarras_WSE_corrQ)))
Embarras_slope[1,] <- colMeans(Embarras_slope, na.rm = TRUE)

#Run BAM
pt = proc.time()
Embarras_bam_invar_width <- run_bam_invar_width_default(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_invar_width",
                                                       slope =  Embarras_slope, qobs = Embarras_corr_Q, rivname = "Embarras",
                                                       minQ = min(Embarras_corr_Q$Q), maxQ = max(Embarras_corr_Q$Q),
                                                       wse = Embarras_WSE_corrQ)
library(hydroGOF)
Embarras_val_invar_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_invar_width",
                                   Embarras_corr_Q$Q)
Embarras_val_invar_width <- Embarras_val_invar_width[order(Embarras_val_invar_width$num_xs),]
Embarras_stats_invar_width <- bam_val_stats(Embarras_val_invar_width)
Embarras_plot_invar_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_invar_width",
                                     Embarras_corr_Q$Q)
proc.time()-pt

#With new priors
pt = proc.time()
Embarras_bam_invar_width_priors <- run_bam_invar_width_Q(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_invar_width_priors",
                                                        slope =  Embarras_slope, qobs = Embarras_corr_Q, rivname = "Embarras",
                                                        minQ = min(Embarras_corr_Q$Q), maxQ = max(Embarras_corr_Q$Q),
                                                        wse = Embarras_WSE_corrQ)
library(hydroGOF)
Embarras_val_invar_width_priors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_invar_width_priors",
                                          Embarras_corr_Q$Q)
Embarras_val_invar_width_priors <- Embarras_val_invar_width_priors[order(Embarras_val_invar_width_priors$num_xs),]
Embarras_stats_invar_width_priors <- bam_val_stats(Embarras_val_invar_width_priors)
Embarras_plot_invar_width_priors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_invar_width_priors",
                                            Embarras_corr_Q$Q)
proc.time()-pt


#With new priors and Q prior
pt = proc.time()
Embarras_bam_invar_width_Qpriors <- run_bam_invar_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_invar_width_Qpriors",
                                                       slope =  Embarras_slope, qobs = Embarras_corr_Q, rivname = "Embarras",
                                                       wse = Embarras_WSE_corrQ)
library(hydroGOF)
Embarras_val_invar_width_Qpriors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_invar_width_Qpriors",
                                           Embarras_corr_Q$Q)
Embarras_val_invar_width_Qpriors <- Embarras_val_invar_width_Qpriors[order(Embarras_val_invar_width_Qpriors$num_xs),]
Embarras_stats_invar_width_Qpriors <- bam_val_stats(Embarras_val_invar_width_Qpriors)
Embarras_plot_invar_width_Qpriors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_invar_width_Qpriors",
                                             Embarras_corr_Q$Q)
proc.time()-pt

#var width
pt = proc.time()
Embarras_bam_var_width <- run_bam_var_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_var_width",
                                           slope =  Embarras_slope, qobs = Embarras_corr_Q, rivname = "Embarras",
                                           wse = Embarras_WSE_corrQ)
library(hydroGOF)
Embarras_val_var_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_var_width",
                                 Embarras_corr_Q$Q)
Embarras_val_var_width <- Embarras_val_var_width[order(Embarras_val_var_width$num_xs),]
Embarras_stats_var_width <- bam_val_stats(Embarras_val_var_width)
Embarras_plot_var_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_var_width",
                                   Embarras_corr_Q$Q)
proc.time()-pt


#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/Gauge_All")
Embarras_temp_gauge_all <- temporary_gauge_all(num_days = nrow(Embarras_WSE_corrQ), 
                                              pt_count = ncol(Embarras_WSE_corrQ), 
                                              file_name = "Embarras",
                                              WSE_mat = t(Embarras_WSE_corrQ), 
                                              Qobs = Embarras_corr_Q$Q)
Embarras_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/Gauge_All",
                                     Embarras_corr_Q$Q)

#Load BAM results from old method of estimating width from DEM
library(hydroGOF)
Embarras_val_corr_Q <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_corrQ",
                              Embarras_corr_Q$Q)
Embarras_val_corr_Q <- Embarras_val_corr_Q[order(Embarras_val_corr_Q$num_xs),]
Embarras_stats_corr_Q <- bam_val_stats(Embarras_val_corr_Q)

#Plot total time and all error metrics--------
#KGE
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Embarras_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Embarras_corr_Q$Q)), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$kge - Embarras_stats_invar_width$kge_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$kge + Embarras_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$kge - Embarras_stats_invar_width_priors$kge_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$kge + Embarras_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$kge - Embarras_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$kge + Embarras_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$kge - Embarras_stats_var_width$kge_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$kge + Embarras_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Embarras_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Embarras_corr_Q$Q)), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$nash - Embarras_stats_invar_width$nash_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$nash + Embarras_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$nash - Embarras_stats_invar_width_priors$nash_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$nash + Embarras_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$nash - Embarras_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$nash + Embarras_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$nash - Embarras_stats_var_width$nash_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$nash + Embarras_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Embarras_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Embarras_corr_Q$Q)), 
        ylim= c(0.15, 0.25)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$rrmse - Embarras_stats_invar_width$rrmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$rrmse + Embarras_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$rrmse - Embarras_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$rrmse + Embarras_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$rrmse - Embarras_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$rrmse + Embarras_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$rrmse - Embarras_stats_var_width$rrmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$rrmse + Embarras_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Embarras_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Embarras_corr_Q$Q)), 
        ylim= c(0.8, 1.6)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$n_rmse - Embarras_stats_invar_width$n_rmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$n_rmse + Embarras_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$n_rmse - Embarras_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$n_rmse + Embarras_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$n_rmse - Embarras_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$n_rmse + Embarras_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$n_rmse - Embarras_stats_var_width$n_rmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$n_rmse + Embarras_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Embarras_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Embarras_corr_Q$Q)), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$p_bias - Embarras_stats_invar_width$p_bias_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$p_bias + Embarras_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$p_bias - Embarras_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$p_bias + Embarras_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$p_bias - Embarras_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$p_bias + Embarras_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$p_bias - Embarras_stats_var_width$p_bias_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$p_bias + Embarras_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(63, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot 10 time steps to show tradeoff better-------------
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Embarras_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$kge - Embarras_stats_invar_width$kge_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$kge + Embarras_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$kge - Embarras_stats_invar_width_priors$kge_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$kge + Embarras_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$kge - Embarras_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$kge + Embarras_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$kge - Embarras_stats_var_width$kge_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$kge + Embarras_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Embarras_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$nash - Embarras_stats_invar_width$nash_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$nash + Embarras_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$nash - Embarras_stats_invar_width_priors$nash_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$nash + Embarras_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$nash - Embarras_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$nash + Embarras_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$nash - Embarras_stats_var_width$nash_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$nash + Embarras_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Embarras_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$rrmse - Embarras_stats_invar_width$rrmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$rrmse + Embarras_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$rrmse - Embarras_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$rrmse + Embarras_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$rrmse - Embarras_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$rrmse + Embarras_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$rrmse - Embarras_stats_var_width$rrmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$rrmse + Embarras_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Embarras_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(80, 200)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$n_rmse - Embarras_stats_invar_width$n_rmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$n_rmse + Embarras_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$n_rmse - Embarras_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$n_rmse + Embarras_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$n_rmse - Embarras_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$n_rmse + Embarras_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$n_rmse - Embarras_stats_var_width$n_rmse_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$n_rmse + Embarras_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Embarras_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Embarras_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$p_bias - Embarras_stats_invar_width$p_bias_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width$p_bias + Embarras_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$p_bias - Embarras_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_priors$p_bias + Embarras_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$p_bias - Embarras_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_invar_width_Qpriors$p_bias + Embarras_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Embarras_WSE_corrQ)-1)), Embarras_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$p_bias - Embarras_stats_var_width$p_bias_sd, c(0:(nrow(Embarras_WSE_corrQ)-1)), 
       Embarras_stats_var_width$p_bias + Embarras_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(14, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot multiple error metric comparison------
#2 discharge samples-----
Embarras_temp_gauge_all_kge_2 <- na.omit(Embarras_gauge_all$kge[Embarras_gauge_all$num_xs == 1.9])
Embarras_temp_gauge_all_nash_2 <- na.omit(Embarras_gauge_all$nash[Embarras_gauge_all$num_xs == 1.9])
Embarras_temp_gauge_all_rrmse_2 <- na.omit(Embarras_gauge_all$rrmse[Embarras_gauge_all$num_xs == 1.9])
Embarras_temp_gauge_all_n_rmse_2 <- na.omit(Embarras_gauge_all$n_rmse[Embarras_gauge_all$num_xs == 1.9])
Embarras_temp_gauge_all_p_bias_2 <- na.omit(Embarras_gauge_all$p_bias[Embarras_gauge_all$num_xs == 1.9])

Embarras_invar_width_kge_2 <- Embarras_stats_invar_width$kge[c(1,2)]
Embarras_invar_width_nash_2 <- Embarras_stats_invar_width$nash[c(1,2)]
Embarras_invar_width_rrmse_2 <- Embarras_stats_invar_width$rrmse[c(1,2)]
Embarras_invar_width_n_rmse_2 <- Embarras_stats_invar_width$n_rmse[c(1,2)]
Embarras_invar_width_p_bias_2 <- Embarras_stats_invar_width$p_bias[c(1,2)]

Embarras_var_width_kge_2 <- Embarras_stats_var_width$kge[c(1,2)]
Embarras_var_width_nash_2 <- Embarras_stats_var_width$nash[c(1,2)]
Embarras_var_width_rrmse_2 <- Embarras_stats_var_width$rrmse[c(1,2)]
Embarras_var_width_n_rmse_2 <- Embarras_stats_var_width$n_rmse[c(1,2)]
Embarras_var_width_p_bias_2 <- Embarras_stats_var_width$p_bias[c(1,2)]

Embarras_invar_width_priors_kge_2 <- Embarras_stats_invar_width_priors$kge[c(1,2)]
Embarras_invar_width_priors_nash_2 <- Embarras_stats_invar_width_priors$nash[c(1,2)]
Embarras_invar_width_priors_rrmse_2 <- Embarras_stats_invar_width_priors$rrmse[c(1,2)]
Embarras_invar_width_priors_n_rmse_2 <- Embarras_stats_invar_width_priors$n_rmse[c(1,2)]
Embarras_invar_width_priors_p_bias_2 <- Embarras_stats_invar_width_priors$p_bias[c(1,2)]

Embarras_invar_width_Qpriors_kge_2 <- Embarras_stats_invar_width_Qpriors$kge[c(1,2)]
Embarras_invar_width_Qpriors_nash_2 <- Embarras_stats_invar_width_Qpriors$nash[c(1,2)]
Embarras_invar_width_Qpriors_rrmse_2 <- Embarras_stats_invar_width_Qpriors$rrmse[c(1,2)]
Embarras_invar_width_Qpriors_n_rmse_2 <- Embarras_stats_invar_width_Qpriors$n_rmse[c(1,2)]
Embarras_invar_width_Qpriors_p_bias_2 <- Embarras_stats_invar_width_Qpriors$p_bias[c(1,2)]

dev.off()
par(mfrow = c(2,2))
par(family = "serif")
boxplot(Embarras_temp_gauge_all_kge_2, Embarras_invar_width_kge_2, Embarras_invar_width_priors_kge_2, 
        Embarras_invar_width_Qpriors_kge_2, Embarras_var_width_kge_2, 
        Embarras_temp_gauge_all_nash_2, Embarras_invar_width_nash_2, Embarras_invar_width_priors_nash_2, 
        Embarras_invar_width_Qpriors_nash_2, Embarras_var_width_nash_2, 
        Embarras_temp_gauge_all_rrmse_2, Embarras_invar_width_rrmse_2, Embarras_invar_width_priors_rrmse_2, 
        Embarras_invar_width_Qpriors_rrmse_2, Embarras_var_width_rrmse_2, 
        Embarras_temp_gauge_all_n_rmse_2, Embarras_invar_width_n_rmse_2, Embarras_invar_width_priors_n_rmse_2, 
        Embarras_invar_width_Qpriors_n_rmse_2, Embarras_var_width_n_rmse_2, 
        Embarras_temp_gauge_all_p_bias_2, Embarras_invar_width_p_bias_2, Embarras_invar_width_priors_p_bias_2, 
        Embarras_invar_width_Qpriors_p_bias_2, Embarras_var_width_p_bias_2, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
#3-5 discharge samples------
Embarras_temp_gauge_all_kge_5 <- na.omit(Embarras_gauge_all$kge[Embarras_gauge_all$num_xs > 1.9 & Embarras_gauge_all$num_xs < 6.9])
Embarras_temp_gauge_all_nash_5 <- na.omit(Embarras_gauge_all$nash[Embarras_gauge_all$num_xs > 1.9 & Embarras_gauge_all$num_xs < 6.9])
Embarras_temp_gauge_all_rrmse_5 <- na.omit(Embarras_gauge_all$rrmse[Embarras_gauge_all$num_xs > 1.9 & Embarras_gauge_all$num_xs < 6.9])
Embarras_temp_gauge_all_n_rmse_5 <- na.omit(Embarras_gauge_all$n_rmse[Embarras_gauge_all$num_xs > 1.9 & Embarras_gauge_all$num_xs < 6.9])
Embarras_temp_gauge_all_p_bias_5 <- na.omit(Embarras_gauge_all$p_bias[Embarras_gauge_all$num_xs > 1.9 & Embarras_gauge_all$num_xs < 6.9])

Embarras_invar_width_kge_5 <- Embarras_stats_invar_width$kge[c(3:5)]
Embarras_invar_width_nash_5 <- Embarras_stats_invar_width$nash[c(3:5)]
Embarras_invar_width_rrmse_5 <- Embarras_stats_invar_width$rrmse[c(3:5)]
Embarras_invar_width_n_rmse_5 <- Embarras_stats_invar_width$n_rmse[c(3:5)]
Embarras_invar_width_p_bias_5 <- Embarras_stats_invar_width$p_bias[c(3:5)]

Embarras_var_width_kge_5 <- Embarras_stats_var_width$kge[c(3:5)]
Embarras_var_width_nash_5 <- Embarras_stats_var_width$nash[c(3:5)]
Embarras_var_width_rrmse_5 <- Embarras_stats_var_width$rrmse[c(3:5)]
Embarras_var_width_n_rmse_5 <- Embarras_stats_var_width$n_rmse[c(3:5)]
Embarras_var_width_p_bias_5 <- Embarras_stats_var_width$p_bias[c(3:5)]

Embarras_invar_width_priors_kge_5 <- Embarras_stats_invar_width_priors$kge[c(3:5)]
Embarras_invar_width_priors_nash_5 <- Embarras_stats_invar_width_priors$nash[c(3:5)]
Embarras_invar_width_priors_rrmse_5 <- Embarras_stats_invar_width_priors$rrmse[c(3:5)]
Embarras_invar_width_priors_n_rmse_5 <- Embarras_stats_invar_width_priors$n_rmse[c(3:5)]
Embarras_invar_width_priors_p_bias_5 <- Embarras_stats_invar_width_priors$p_bias[c(3:5)]

Embarras_invar_width_Qpriors_kge_5 <- Embarras_stats_invar_width_Qpriors$kge[c(3:5)]
Embarras_invar_width_Qpriors_nash_5 <- Embarras_stats_invar_width_Qpriors$nash[c(3:5)]
Embarras_invar_width_Qpriors_rrmse_5 <- Embarras_stats_invar_width_Qpriors$rrmse[c(3:5)]
Embarras_invar_width_Qpriors_n_rmse_5 <- Embarras_stats_invar_width_Qpriors$n_rmse[c(3:5)]
Embarras_invar_width_Qpriors_p_bias_5 <- Embarras_stats_invar_width_Qpriors$p_bias[c(3:5)]

boxplot(Embarras_temp_gauge_all_kge_5, Embarras_invar_width_kge_5, Embarras_invar_width_priors_kge_5, 
        Embarras_invar_width_Qpriors_kge_5, Embarras_var_width_kge_5, 
        Embarras_temp_gauge_all_nash_5, Embarras_invar_width_nash_5, Embarras_invar_width_priors_nash_5, 
        Embarras_invar_width_Qpriors_nash_5, Embarras_var_width_nash_5, 
        Embarras_temp_gauge_all_rrmse_5, Embarras_invar_width_rrmse_5, Embarras_invar_width_priors_rrmse_5, 
        Embarras_invar_width_Qpriors_rrmse_5, Embarras_var_width_rrmse_5, 
        Embarras_temp_gauge_all_n_rmse_5, Embarras_invar_width_n_rmse_5, Embarras_invar_width_priors_n_rmse_5, 
        Embarras_invar_width_Qpriors_n_rmse_5, Embarras_var_width_n_rmse_5, 
        Embarras_temp_gauge_all_p_bias_5, Embarras_invar_width_p_bias_5, Embarras_invar_width_priors_p_bias_5, 
        Embarras_invar_width_Qpriors_p_bias_5, Embarras_var_width_p_bias_5, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#6-10 discharge samples
Embarras_temp_gauge_all_kge_10 <- na.omit(Embarras_gauge_all$kge[Embarras_gauge_all$num_xs > 5.9 & Embarras_gauge_all$num_xs < 11.9])
Embarras_temp_gauge_all_nash_10 <- na.omit(Embarras_gauge_all$nash[Embarras_gauge_all$num_xs > 5.9 & Embarras_gauge_all$num_xs < 11.9])
Embarras_temp_gauge_all_rrmse_10 <- na.omit(Embarras_gauge_all$rrmse[Embarras_gauge_all$num_xs > 5.9 & Embarras_gauge_all$num_xs < 11.9])
Embarras_temp_gauge_all_n_rmse_10 <- na.omit(Embarras_gauge_all$n_rmse[Embarras_gauge_all$num_xs > 5.9 & Embarras_gauge_all$num_xs < 11.9])
Embarras_temp_gauge_all_p_bias_10 <- na.omit(Embarras_gauge_all$p_bias[Embarras_gauge_all$num_xs > 5.9 & Embarras_gauge_all$num_xs < 11.9])

Embarras_invar_width_kge_10 <- Embarras_stats_invar_width$kge[c(6:10)]
Embarras_invar_width_nash_10 <- Embarras_stats_invar_width$nash[c(6:10)]
Embarras_invar_width_rrmse_10 <- Embarras_stats_invar_width$rrmse[c(6:10)]
Embarras_invar_width_n_rmse_10 <- Embarras_stats_invar_width$n_rmse[c(6:10)]
Embarras_invar_width_p_bias_10 <- Embarras_stats_invar_width$p_bias[c(6:10)]

Embarras_var_width_kge_10 <- Embarras_stats_var_width$kge[c(6:10)]
Embarras_var_width_nash_10 <- Embarras_stats_var_width$nash[c(6:10)]
Embarras_var_width_rrmse_10 <- Embarras_stats_var_width$rrmse[c(6:10)]
Embarras_var_width_n_rmse_10 <- Embarras_stats_var_width$n_rmse[c(6:10)]
Embarras_var_width_p_bias_10 <- Embarras_stats_var_width$p_bias[c(6:10)]

Embarras_invar_width_priors_kge_10 <- Embarras_stats_invar_width_priors$kge[c(6:10)]
Embarras_invar_width_priors_nash_10 <- Embarras_stats_invar_width_priors$nash[c(6:10)]
Embarras_invar_width_priors_rrmse_10 <- Embarras_stats_invar_width_priors$rrmse[c(6:10)]
Embarras_invar_width_priors_n_rmse_10 <- Embarras_stats_invar_width_priors$n_rmse[c(6:10)]
Embarras_invar_width_priors_p_bias_10 <- Embarras_stats_invar_width_priors$p_bias[c(6:10)]

Embarras_invar_width_Qpriors_kge_10 <- Embarras_stats_invar_width_Qpriors$kge[c(6:10)]
Embarras_invar_width_Qpriors_nash_10 <- Embarras_stats_invar_width_Qpriors$nash[c(6:10)]
Embarras_invar_width_Qpriors_rrmse_10 <- Embarras_stats_invar_width_Qpriors$rrmse[c(6:10)]
Embarras_invar_width_Qpriors_n_rmse_10 <- Embarras_stats_invar_width_Qpriors$n_rmse[c(6:10)]
Embarras_invar_width_Qpriors_p_bias_10 <- Embarras_stats_invar_width_Qpriors$p_bias[c(6:10)]

boxplot(Embarras_temp_gauge_all_kge_10, Embarras_invar_width_kge_10, Embarras_invar_width_priors_kge_10, 
        Embarras_invar_width_Qpriors_kge_10, Embarras_var_width_kge_10, 
        Embarras_temp_gauge_all_nash_10, Embarras_invar_width_nash_10, Embarras_invar_width_priors_nash_10, 
        Embarras_invar_width_Qpriors_nash_10, Embarras_var_width_nash_10, 
        Embarras_temp_gauge_all_rrmse_10, Embarras_invar_width_rrmse_10, Embarras_invar_width_priors_rrmse_10, 
        Embarras_invar_width_Qpriors_rrmse_10, Embarras_var_width_rrmse_10, 
        Embarras_temp_gauge_all_n_rmse_10, Embarras_invar_width_n_rmse_10, Embarras_invar_width_priors_n_rmse_10, 
        Embarras_invar_width_Qpriors_n_rmse_10, Embarras_var_width_n_rmse_10, 
        Embarras_temp_gauge_all_p_bias_10, Embarras_invar_width_p_bias_10, Embarras_invar_width_priors_p_bias_10, 
        Embarras_invar_width_Qpriors_p_bias_10, Embarras_var_width_p_bias_10, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#11-46 discharge samples
Embarras_temp_gauge_all_kge_46 <- na.omit(Embarras_gauge_all$kge[Embarras_gauge_all$num_xs > 10.9])
Embarras_temp_gauge_all_nash_46 <- na.omit(Embarras_gauge_all$nash[Embarras_gauge_all$num_xs > 10.9])
Embarras_temp_gauge_all_rrmse_46 <- na.omit(Embarras_gauge_all$rrmse[Embarras_gauge_all$num_xs > 10.9])
Embarras_temp_gauge_all_n_rmse_46 <- na.omit(Embarras_gauge_all$r_rmse[Embarras_gauge_all$num_xs > 10.9])
Embarras_temp_gauge_all_p_bias_46 <- na.omit(Embarras_gauge_all$p_bias[Embarras_gauge_all$num_xs > 10.9])

Embarras_invar_width_kge_46 <- Embarras_stats_invar_width$kge[c(11:46)]
Embarras_invar_width_nash_46 <- Embarras_stats_invar_width$nash[c(11:46)]
Embarras_invar_width_rrmse_46 <- Embarras_stats_invar_width$rrmse[c(11:46)]
Embarras_invar_width_n_rmse_46 <- Embarras_stats_invar_width$n_rmse[c(11:46)]
Embarras_invar_width_p_bias_46 <- Embarras_stats_invar_width$p_bias[c(11:46)]

Embarras_var_width_kge_46 <- Embarras_stats_var_width$kge[c(11:46)]
Embarras_var_width_nash_46 <- Embarras_stats_var_width$nash[c(11:46)]
Embarras_var_width_rrmse_46 <- Embarras_stats_var_width$rrmse[c(11:46)]
Embarras_var_width_n_rmse_46 <- Embarras_stats_var_width$n_rmse[c(11:46)]
Embarras_var_width_p_bias_46 <- Embarras_stats_var_width$p_bias[c(11:46)]

Embarras_invar_width_priors_kge_46 <- Embarras_stats_invar_width_priors$kge[c(11:46)]
Embarras_invar_width_priors_nash_46 <- Embarras_stats_invar_width_priors$nash[c(11:46)]
Embarras_invar_width_priors_rrmse_46 <- Embarras_stats_invar_width_priors$rrmse[c(11:46)]
Embarras_invar_width_priors_n_rmse_46 <- Embarras_stats_invar_width_priors$n_rmse[c(11:46)]
Embarras_invar_width_priors_p_bias_46 <- Embarras_stats_invar_width_priors$p_bias[c(11:46)]

Embarras_invar_width_Qpriors_kge_46 <- Embarras_stats_invar_width_Qpriors$kge[c(11:46)]
Embarras_invar_width_Qpriors_nash_46 <- Embarras_stats_invar_width_Qpriors$nash[c(11:46)]
Embarras_invar_width_Qpriors_rrmse_46 <- Embarras_stats_invar_width_Qpriors$rrmse[c(11:46)]
Embarras_invar_width_Qpriors_n_rmse_46 <- Embarras_stats_invar_width_Qpriors$n_rmse[c(11:46)]
Embarras_invar_width_Qpriors_p_bias_46 <- Embarras_stats_invar_width_Qpriors$p_bias[c(11:46)]

boxplot(Embarras_temp_gauge_all_kge_46, Embarras_invar_width_kge_46, Embarras_invar_width_priors_kge_46, 
        Embarras_invar_width_Qpriors_kge_46, Embarras_var_width_kge_46, 
        Embarras_temp_gauge_all_nash_46, Embarras_invar_width_nash_46, Embarras_invar_width_priors_nash_46, 
        Embarras_invar_width_Qpriors_nash_46, Embarras_var_width_nash_46, 
        Embarras_temp_gauge_all_rrmse_46, Embarras_invar_width_rrmse_46, Embarras_invar_width_priors_rrmse_46, 
        Embarras_invar_width_Qpriors_rrmse_46, Embarras_var_width_rrmse_46, 
        Embarras_temp_gauge_all_n_rmse_46, Embarras_invar_width_n_rmse_46, Embarras_invar_width_priors_n_rmse_46, 
        Embarras_invar_width_Qpriors_n_rmse_46, Embarras_var_width_n_rmse_46, 
        Embarras_temp_gauge_all_p_bias_46, Embarras_invar_width_p_bias_46, Embarras_invar_width_priors_p_bias_46, 
        Embarras_invar_width_Qpriors_p_bias_46, Embarras_var_width_p_bias_46, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
legend("bottomleft", legend = c("Temporary Gauge", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                                "Var width new priors"), pch = c(15), 
       cex = 1,
       col = c("aquamarine4", "blue", "purple", "magenta","orange"))
#Remake plots only ranging from -1 to 0.5
boxplot(Embarras_temp_gauge_all_kge_2, Embarras_invar_width_kge_2, Embarras_invar_width_priors_kge_2, 
        Embarras_invar_width_Qpriors_kge_2, Embarras_var_width_kge_2, 
        Embarras_temp_gauge_all_nash_2, Embarras_invar_width_nash_2, Embarras_invar_width_priors_nash_2, 
        Embarras_invar_width_Qpriors_nash_2, Embarras_var_width_nash_2, 
        Embarras_temp_gauge_all_rrmse_2, Embarras_invar_width_rrmse_2, Embarras_invar_width_priors_rrmse_2, 
        Embarras_invar_width_Qpriors_rrmse_2, Embarras_var_width_rrmse_2, 
        Embarras_temp_gauge_all_n_rmse_2, Embarras_invar_width_n_rmse_2, Embarras_invar_width_priors_n_rmse_2, 
        Embarras_invar_width_Qpriors_n_rmse_2, Embarras_var_width_n_rmse_2, 
        Embarras_temp_gauge_all_p_bias_2, Embarras_invar_width_p_bias_2, Embarras_invar_width_priors_p_bias_2, 
        Embarras_invar_width_Qpriors_p_bias_2, Embarras_var_width_p_bias_2, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Embarras_temp_gauge_all_kge_5, Embarras_invar_width_kge_5, Embarras_invar_width_priors_kge_5, 
        Embarras_invar_width_Qpriors_kge_5, Embarras_var_width_kge_5, 
        Embarras_temp_gauge_all_nash_5, Embarras_invar_width_nash_5, Embarras_invar_width_priors_nash_5, 
        Embarras_invar_width_Qpriors_nash_5, Embarras_var_width_nash_5, 
        Embarras_temp_gauge_all_rrmse_5, Embarras_invar_width_rrmse_5, Embarras_invar_width_priors_rrmse_5, 
        Embarras_invar_width_Qpriors_rrmse_5, Embarras_var_width_rrmse_5, 
        Embarras_temp_gauge_all_n_rmse_5, Embarras_invar_width_n_rmse_5, Embarras_invar_width_priors_n_rmse_5, 
        Embarras_invar_width_Qpriors_n_rmse_5, Embarras_var_width_n_rmse_5, 
        Embarras_temp_gauge_all_p_bias_5, Embarras_invar_width_p_bias_5, Embarras_invar_width_priors_p_bias_5, 
        Embarras_invar_width_Qpriors_p_bias_5, Embarras_var_width_p_bias_5, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Embarras_temp_gauge_all_kge_10, Embarras_invar_width_kge_10, Embarras_invar_width_priors_kge_10, 
        Embarras_invar_width_Qpriors_kge_10, Embarras_var_width_kge_10, 
        Embarras_temp_gauge_all_nash_10, Embarras_invar_width_nash_10, Embarras_invar_width_priors_nash_10, 
        Embarras_invar_width_Qpriors_nash_10, Embarras_var_width_nash_10, 
        Embarras_temp_gauge_all_rrmse_10, Embarras_invar_width_rrmse_10, Embarras_invar_width_priors_rrmse_10, 
        Embarras_invar_width_Qpriors_rrmse_10, Embarras_var_width_rrmse_10, 
        Embarras_temp_gauge_all_n_rmse_10, Embarras_invar_width_n_rmse_10, Embarras_invar_width_priors_n_rmse_10, 
        Embarras_invar_width_Qpriors_n_rmse_10, Embarras_var_width_n_rmse_10, 
        Embarras_temp_gauge_all_p_bias_10, Embarras_invar_width_p_bias_10, Embarras_invar_width_priors_p_bias_10, 
        Embarras_invar_width_Qpriors_p_bias_10, Embarras_var_width_p_bias_10, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Embarras_temp_gauge_all_kge_46, Embarras_invar_width_kge_46, Embarras_invar_width_priors_kge_46, 
        Embarras_invar_width_Qpriors_kge_46, Embarras_var_width_kge_46, 
        Embarras_temp_gauge_all_nash_46, Embarras_invar_width_nash_46, Embarras_invar_width_priors_nash_46, 
        Embarras_invar_width_Qpriors_nash_46, Embarras_var_width_nash_46, 
        Embarras_temp_gauge_all_rrmse_46, Embarras_invar_width_rrmse_46, Embarras_invar_width_priors_rrmse_46, 
        Embarras_invar_width_Qpriors_rrmse_46, Embarras_var_width_rrmse_46, 
        Embarras_temp_gauge_all_n_rmse_46, Embarras_invar_width_n_rmse_46, Embarras_invar_width_priors_n_rmse_46, 
        Embarras_invar_width_Qpriors_n_rmse_46, Embarras_var_width_n_rmse_46, 
        Embarras_temp_gauge_all_p_bias_46, Embarras_invar_width_p_bias_46, Embarras_invar_width_priors_p_bias_46, 
        Embarras_invar_width_Qpriors_p_bias_46, Embarras_var_width_p_bias_46, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")


###Richardson------
#load WSE
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/PAD_2019_PT/Richardson/WSE")
Richardson_WSE <- read.csv("Richardson_WSE_PPP_corr.csv")
Richardson_WSE <- Richardson_WSE %>%
  mutate(day = as.Date(new_time))
Richardson_WSE_daily <- aggregate(. ~day, data = Richardson_WSE, mean, na.rm = TRUE)[1,c(4:ncol(Richardson_WSE))]
head(Richardson_WSE)
#load Q
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson")
Richardson_corr_Q <- read.csv("Richardson_corr_Q.csv")
Richardson_corr_Q <- Richardson_corr_Q %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Richardson_qobs_daily <- aggregate(. ~day, data = Richardson_corr_Q[,c(6,8,9,14)], 
                                 mean, na.rm = TRUE)[,2]

#load cl and PT coords
setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson", sep =""))
Richardson_cl <-readOGR(dsn = ".", layer = "Richardson_CL_UTM")

setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/PAD_2019_PT", sep =""))
Richardson_PT_coords <- read.csv("Richardson_PT_coords.csv")
Richardson_PT_coords_sp <-SpatialPoints(Richardson_PT_coords[,4:5], 
                                      proj4string = crs('+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0' ))
#calculate the distance between pts
Richardson_xvec <- calc_xvec(Richardson_PT_coords_sp, Richardson_cl)
save(Richardson_xvec, file = "Richardson_xvec.RData")
#find overlapping ADCP and PT times
Richardson_closest_time <- vector(length = length(Richardson_corr_Q$new_date))
for(i in 1:length(Richardson_corr_Q$new_date)){
  Richardson_closest_time[i] = which.min(abs(as.POSIXct(Richardson_WSE$new_time, tz = "MST") - 
                                             as.POSIXct(Richardson_corr_Q$new_date[i], tz = "MST")))
}

Richardson_WSE_corrQ <- Richardson_WSE[c(Richardson_closest_time[order(Richardson_closest_time)]),c(3:7)]

#Calculate slope
Richardson_slope <- abs(calcslope(Richardson_xvec, hmat = t(Richardson_WSE_corrQ)))
Richardson_slope[1,] <- colMeans(Richardson_slope, na.rm = TRUE)

#Run BAM
pt = proc.time()
Richardson_bam_invar_width <- run_bam_invar_width_default(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_invar_width",
                                                        slope =  Richardson_slope, qobs = Richardson_corr_Q, rivname = "Richardson",
                                                        minQ = min(Richardson_corr_Q$Q), maxQ = max(Richardson_corr_Q$Q),
                                                        wse = Richardson_WSE_corrQ)
library(hydroGOF)
Richardson_val_invar_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_invar_width",
                                    Richardson_corr_Q$Q)
Richardson_val_invar_width <- Richardson_val_invar_width[order(Richardson_val_invar_width$num_xs),]
Richardson_stats_invar_width <- bam_val_stats(Richardson_val_invar_width)
Richardson_plot_invar_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_invar_width",
                                      Richardson_corr_Q$Q)
proc.time()-pt

#With new priors
pt = proc.time()
Richardson_bam_invar_width_priors <- run_bam_invar_width_Q(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_invar_width_priors",
                                                         slope =  Richardson_slope, qobs = Richardson_corr_Q, rivname = "Richardson",
                                                         minQ = min(Richardson_corr_Q$Q), maxQ = max(Richardson_corr_Q$Q),
                                                         wse = Richardson_WSE_corrQ)
library(hydroGOF)
Richardson_val_invar_width_priors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_invar_width_priors",
                                           Richardson_corr_Q$Q)
Richardson_val_invar_width_priors <- Richardson_val_invar_width_priors[order(Richardson_val_invar_width_priors$num_xs),]
Richardson_stats_invar_width_priors <- bam_val_stats(Richardson_val_invar_width_priors)
Richardson_plot_invar_width_priors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_invar_width_priors",
                                             Richardson_corr_Q$Q)
proc.time()-pt


#With new priors and Q prior
pt = proc.time()
Richardson_bam_invar_width_Qpriors <- run_bam_invar_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_invar_width_Qpriors",
                                                        slope =  Richardson_slope, qobs = Richardson_corr_Q, rivname = "Richardson",
                                                        wse = Richardson_WSE_corrQ)
library(hydroGOF)
Richardson_val_invar_width_Qpriors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_invar_width_Qpriors",
                                            Richardson_corr_Q$Q)
Richardson_val_invar_width_Qpriors <- Richardson_val_invar_width_Qpriors[order(Richardson_val_invar_width_Qpriors$num_xs),]
Richardson_stats_invar_width_Qpriors <- bam_val_stats(Richardson_val_invar_width_Qpriors)
Richardson_plot_invar_width_Qpriors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_invar_width_Qpriors",
                                              Richardson_corr_Q$Q)
proc.time()-pt

#var width
pt = proc.time()
Richardson_bam_var_width <- run_bam_var_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_var_width",
                                            slope =  Richardson_slope, qobs = Richardson_corr_Q, rivname = "Richardson",
                                            wse = Richardson_WSE_corrQ)
library(hydroGOF)
Richardson_val_var_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_var_width",
                                  Richardson_corr_Q$Q)
Richardson_val_var_width <- Richardson_val_var_width[order(Richardson_val_var_width$num_xs),]
Richardson_stats_var_width <- bam_val_stats(Richardson_val_var_width)
Richardson_plot_var_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_var_width",
                                    Richardson_corr_Q$Q)
proc.time()-pt


#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/Gauge_All")
Richardson_temp_gauge_all <- temporary_gauge_all(num_days = nrow(Richardson_WSE_corrQ), 
                                               pt_count = ncol(Richardson_WSE_corrQ), 
                                               file_name = "Richardson",
                                               WSE_mat = t(Richardson_WSE_corrQ), 
                                               Qobs = Richardson_corr_Q$Q)
Richardson_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/Gauge_All",
                                      Richardson_corr_Q$Q)

#Load BAM results from old method of estimating width from DEM
library(hydroGOF)
Richardson_val_corr_Q <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_corrQ",
                               Richardson_corr_Q$Q)
Richardson_val_corr_Q <- Richardson_val_corr_Q[order(Richardson_val_corr_Q$num_xs),]
Richardson_stats_corr_Q <- bam_val_stats(Richardson_val_corr_Q)

#Plot total time and all error metrics--------
#KGE
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Richardson_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Richardson_corr_Q$Q)), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$kge - Richardson_stats_invar_width$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$kge + Richardson_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$kge - Richardson_stats_invar_width_priors$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$kge + Richardson_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$kge - Richardson_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$kge + Richardson_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$kge - Richardson_stats_var_width$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$kge + Richardson_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_corr_Q$kge, col = "red", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$kge - Richardson_stats_corr_Q$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$kge + Richardson_stats_corr_Q$kge_sd, length=0.05, angle=90, code=3,
       col = "red")

#NSE
boxplot(nash~num_xs,
        data= Richardson_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Richardson_corr_Q$Q)), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$nash - Richardson_stats_invar_width$nash_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$nash + Richardson_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$nash - Richardson_stats_invar_width_priors$nash_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$nash + Richardson_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$nash - Richardson_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$nash + Richardson_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$nash - Richardson_stats_var_width$nash_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$nash + Richardson_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_corr_Q$nash, col = "red", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$nash - Richardson_stats_corr_Q$nash_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$nash + Richardson_stats_corr_Q$nash_sd, length=0.05, angle=90, code=3,
       col = "red")

#rrmse
boxplot(rrmse~num_xs,
        data= Richardson_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Richardson_corr_Q$Q)), 
        ylim= c(0.15, 0.25)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$rrmse - Richardson_stats_invar_width$rrmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$rrmse + Richardson_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$rrmse - Richardson_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$rrmse + Richardson_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$rrmse - Richardson_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$rrmse + Richardson_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$rrmse - Richardson_stats_var_width$rrmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$rrmse + Richardson_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_corr_Q$rrmse, col = "red", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$rrmse - Richardson_stats_corr_Q$rrmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$rrmse + Richardson_stats_corr_Q$rrmse_sd, length=0.05, angle=90, code=3,
       col = "red")

#n_rmse
boxplot(n_rmse~num_xs,
        data= Richardson_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Richardson_corr_Q$Q)), 
        ylim= c(0.8, 1.6)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$n_rmse - Richardson_stats_invar_width$n_rmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$n_rmse + Richardson_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$n_rmse - Richardson_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$n_rmse + Richardson_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$n_rmse - Richardson_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$n_rmse + Richardson_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$n_rmse - Richardson_stats_var_width$n_rmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$n_rmse + Richardson_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_corr_Q$n_rmse, col = "red", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$n_rmse - Richardson_stats_corr_Q$n_rmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$n_rmse + Richardson_stats_corr_Q$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "red")

#p_bias
boxplot(p_bias~num_xs,
        data= Richardson_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Richardson_corr_Q$Q)), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$p_bias - Richardson_stats_invar_width$p_bias_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$p_bias + Richardson_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$p_bias - Richardson_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$p_bias + Richardson_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$p_bias - Richardson_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$p_bias + Richardson_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$p_bias - Richardson_stats_var_width$p_bias_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$p_bias + Richardson_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_corr_Q$kge, col = "red", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$kge - Richardson_stats_corr_Q$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_corr_Q$kge + Richardson_stats_corr_Q$kge_sd, length=0.05, angle=90, code=3,
       col = "red")

par(xpd = NA)
legend(63, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot 10 time steps to show tradeoff better-------------
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Richardson_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$kge - Richardson_stats_invar_width$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$kge + Richardson_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$kge - Richardson_stats_invar_width_priors$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$kge + Richardson_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$kge - Richardson_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$kge + Richardson_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$kge - Richardson_stats_var_width$kge_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$kge + Richardson_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Richardson_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$nash - Richardson_stats_invar_width$nash_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$nash + Richardson_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$nash - Richardson_stats_invar_width_priors$nash_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$nash + Richardson_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$nash - Richardson_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$nash + Richardson_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$nash - Richardson_stats_var_width$nash_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$nash + Richardson_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Richardson_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$rrmse - Richardson_stats_invar_width$rrmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$rrmse + Richardson_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$rrmse - Richardson_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$rrmse + Richardson_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$rrmse - Richardson_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$rrmse + Richardson_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$rrmse - Richardson_stats_var_width$rrmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$rrmse + Richardson_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Richardson_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(80, 200)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$n_rmse - Richardson_stats_invar_width$n_rmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$n_rmse + Richardson_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$n_rmse - Richardson_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$n_rmse + Richardson_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$n_rmse - Richardson_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$n_rmse + Richardson_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$n_rmse - Richardson_stats_var_width$n_rmse_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$n_rmse + Richardson_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Richardson_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Richardson_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$p_bias - Richardson_stats_invar_width$p_bias_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width$p_bias + Richardson_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$p_bias - Richardson_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_priors$p_bias + Richardson_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$p_bias - Richardson_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_invar_width_Qpriors$p_bias + Richardson_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Richardson_WSE_corrQ)-1)), Richardson_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$p_bias - Richardson_stats_var_width$p_bias_sd, c(0:(nrow(Richardson_WSE_corrQ)-1)), 
       Richardson_stats_var_width$p_bias + Richardson_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(14, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot multiple error metric comparison------
#2 discharge samples-----
Richardson_temp_gauge_all_kge_2 <- na.omit(Richardson_gauge_all$kge[Richardson_gauge_all$num_xs == 1.9])
Richardson_temp_gauge_all_nash_2 <- na.omit(Richardson_gauge_all$nash[Richardson_gauge_all$num_xs == 1.9])
Richardson_temp_gauge_all_rrmse_2 <- na.omit(Richardson_gauge_all$rrmse[Richardson_gauge_all$num_xs == 1.9])
Richardson_temp_gauge_all_n_rmse_2 <- na.omit(Richardson_gauge_all$n_rmse[Richardson_gauge_all$num_xs == 1.9])
Richardson_temp_gauge_all_p_bias_2 <- na.omit(Richardson_gauge_all$p_bias[Richardson_gauge_all$num_xs == 1.9])

Richardson_invar_width_kge_2 <- Richardson_stats_invar_width$kge[c(1,2)]
Richardson_invar_width_nash_2 <- Richardson_stats_invar_width$nash[c(1,2)]
Richardson_invar_width_rrmse_2 <- Richardson_stats_invar_width$rrmse[c(1,2)]
Richardson_invar_width_n_rmse_2 <- Richardson_stats_invar_width$n_rmse[c(1,2)]
Richardson_invar_width_p_bias_2 <- Richardson_stats_invar_width$p_bias[c(1,2)]

Richardson_var_width_kge_2 <- Richardson_stats_var_width$kge[c(1,2)]
Richardson_var_width_nash_2 <- Richardson_stats_var_width$nash[c(1,2)]
Richardson_var_width_rrmse_2 <- Richardson_stats_var_width$rrmse[c(1,2)]
Richardson_var_width_n_rmse_2 <- Richardson_stats_var_width$n_rmse[c(1,2)]
Richardson_var_width_p_bias_2 <- Richardson_stats_var_width$p_bias[c(1,2)]

Richardson_invar_width_priors_kge_2 <- Richardson_stats_invar_width_priors$kge[c(1,2)]
Richardson_invar_width_priors_nash_2 <- Richardson_stats_invar_width_priors$nash[c(1,2)]
Richardson_invar_width_priors_rrmse_2 <- Richardson_stats_invar_width_priors$rrmse[c(1,2)]
Richardson_invar_width_priors_n_rmse_2 <- Richardson_stats_invar_width_priors$n_rmse[c(1,2)]
Richardson_invar_width_priors_p_bias_2 <- Richardson_stats_invar_width_priors$p_bias[c(1,2)]

Richardson_invar_width_Qpriors_kge_2 <- Richardson_stats_invar_width_Qpriors$kge[c(1,2)]
Richardson_invar_width_Qpriors_nash_2 <- Richardson_stats_invar_width_Qpriors$nash[c(1,2)]
Richardson_invar_width_Qpriors_rrmse_2 <- Richardson_stats_invar_width_Qpriors$rrmse[c(1,2)]
Richardson_invar_width_Qpriors_n_rmse_2 <- Richardson_stats_invar_width_Qpriors$n_rmse[c(1,2)]
Richardson_invar_width_Qpriors_p_bias_2 <- Richardson_stats_invar_width_Qpriors$p_bias[c(1,2)]

dev.off()
par(mfrow = c(2,2))
par(family = "serif")
boxplot(Richardson_temp_gauge_all_kge_2, Richardson_invar_width_kge_2, Richardson_invar_width_priors_kge_2, 
        Richardson_invar_width_Qpriors_kge_2, Richardson_var_width_kge_2, 
        Richardson_temp_gauge_all_nash_2, Richardson_invar_width_nash_2, Richardson_invar_width_priors_nash_2, 
        Richardson_invar_width_Qpriors_nash_2, Richardson_var_width_nash_2, 
        Richardson_temp_gauge_all_rrmse_2, Richardson_invar_width_rrmse_2, Richardson_invar_width_priors_rrmse_2, 
        Richardson_invar_width_Qpriors_rrmse_2, Richardson_var_width_rrmse_2, 
        Richardson_temp_gauge_all_n_rmse_2, Richardson_invar_width_n_rmse_2, Richardson_invar_width_priors_n_rmse_2, 
        Richardson_invar_width_Qpriors_n_rmse_2, Richardson_var_width_n_rmse_2, 
        Richardson_temp_gauge_all_p_bias_2, Richardson_invar_width_p_bias_2, Richardson_invar_width_priors_p_bias_2, 
        Richardson_invar_width_Qpriors_p_bias_2, Richardson_var_width_p_bias_2, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
#3-5 discharge samples------
Richardson_temp_gauge_all_kge_5 <- na.omit(Richardson_gauge_all$kge[Richardson_gauge_all$num_xs > 1.9 & Richardson_gauge_all$num_xs < 6.9])
Richardson_temp_gauge_all_nash_5 <- na.omit(Richardson_gauge_all$nash[Richardson_gauge_all$num_xs > 1.9 & Richardson_gauge_all$num_xs < 6.9])
Richardson_temp_gauge_all_rrmse_5 <- na.omit(Richardson_gauge_all$rrmse[Richardson_gauge_all$num_xs > 1.9 & Richardson_gauge_all$num_xs < 6.9])
Richardson_temp_gauge_all_n_rmse_5 <- na.omit(Richardson_gauge_all$n_rmse[Richardson_gauge_all$num_xs > 1.9 & Richardson_gauge_all$num_xs < 6.9])
Richardson_temp_gauge_all_p_bias_5 <- na.omit(Richardson_gauge_all$p_bias[Richardson_gauge_all$num_xs > 1.9 & Richardson_gauge_all$num_xs < 6.9])

Richardson_invar_width_kge_5 <- Richardson_stats_invar_width$kge[c(3:5)]
Richardson_invar_width_nash_5 <- Richardson_stats_invar_width$nash[c(3:5)]
Richardson_invar_width_rrmse_5 <- Richardson_stats_invar_width$rrmse[c(3:5)]
Richardson_invar_width_n_rmse_5 <- Richardson_stats_invar_width$n_rmse[c(3:5)]
Richardson_invar_width_p_bias_5 <- Richardson_stats_invar_width$p_bias[c(3:5)]

Richardson_var_width_kge_5 <- Richardson_stats_var_width$kge[c(3:5)]
Richardson_var_width_nash_5 <- Richardson_stats_var_width$nash[c(3:5)]
Richardson_var_width_rrmse_5 <- Richardson_stats_var_width$rrmse[c(3:5)]
Richardson_var_width_n_rmse_5 <- Richardson_stats_var_width$n_rmse[c(3:5)]
Richardson_var_width_p_bias_5 <- Richardson_stats_var_width$p_bias[c(3:5)]

Richardson_invar_width_priors_kge_5 <- Richardson_stats_invar_width_priors$kge[c(3:5)]
Richardson_invar_width_priors_nash_5 <- Richardson_stats_invar_width_priors$nash[c(3:5)]
Richardson_invar_width_priors_rrmse_5 <- Richardson_stats_invar_width_priors$rrmse[c(3:5)]
Richardson_invar_width_priors_n_rmse_5 <- Richardson_stats_invar_width_priors$n_rmse[c(3:5)]
Richardson_invar_width_priors_p_bias_5 <- Richardson_stats_invar_width_priors$p_bias[c(3:5)]

Richardson_invar_width_Qpriors_kge_5 <- Richardson_stats_invar_width_Qpriors$kge[c(3:5)]
Richardson_invar_width_Qpriors_nash_5 <- Richardson_stats_invar_width_Qpriors$nash[c(3:5)]
Richardson_invar_width_Qpriors_rrmse_5 <- Richardson_stats_invar_width_Qpriors$rrmse[c(3:5)]
Richardson_invar_width_Qpriors_n_rmse_5 <- Richardson_stats_invar_width_Qpriors$n_rmse[c(3:5)]
Richardson_invar_width_Qpriors_p_bias_5 <- Richardson_stats_invar_width_Qpriors$p_bias[c(3:5)]

boxplot(Richardson_temp_gauge_all_kge_5, Richardson_invar_width_kge_5, Richardson_invar_width_priors_kge_5, 
        Richardson_invar_width_Qpriors_kge_5, Richardson_var_width_kge_5, 
        Richardson_temp_gauge_all_nash_5, Richardson_invar_width_nash_5, Richardson_invar_width_priors_nash_5, 
        Richardson_invar_width_Qpriors_nash_5, Richardson_var_width_nash_5, 
        Richardson_temp_gauge_all_rrmse_5, Richardson_invar_width_rrmse_5, Richardson_invar_width_priors_rrmse_5, 
        Richardson_invar_width_Qpriors_rrmse_5, Richardson_var_width_rrmse_5, 
        Richardson_temp_gauge_all_n_rmse_5, Richardson_invar_width_n_rmse_5, Richardson_invar_width_priors_n_rmse_5, 
        Richardson_invar_width_Qpriors_n_rmse_5, Richardson_var_width_n_rmse_5, 
        Richardson_temp_gauge_all_p_bias_5, Richardson_invar_width_p_bias_5, Richardson_invar_width_priors_p_bias_5, 
        Richardson_invar_width_Qpriors_p_bias_5, Richardson_var_width_p_bias_5, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#6-10 discharge samples
Richardson_temp_gauge_all_kge_10 <- na.omit(Richardson_gauge_all$kge[Richardson_gauge_all$num_xs > 5.9 & Richardson_gauge_all$num_xs < 11.9])
Richardson_temp_gauge_all_nash_10 <- na.omit(Richardson_gauge_all$nash[Richardson_gauge_all$num_xs > 5.9 & Richardson_gauge_all$num_xs < 11.9])
Richardson_temp_gauge_all_rrmse_10 <- na.omit(Richardson_gauge_all$rrmse[Richardson_gauge_all$num_xs > 5.9 & Richardson_gauge_all$num_xs < 11.9])
Richardson_temp_gauge_all_n_rmse_10 <- na.omit(Richardson_gauge_all$n_rmse[Richardson_gauge_all$num_xs > 5.9 & Richardson_gauge_all$num_xs < 11.9])
Richardson_temp_gauge_all_p_bias_10 <- na.omit(Richardson_gauge_all$p_bias[Richardson_gauge_all$num_xs > 5.9 & Richardson_gauge_all$num_xs < 11.9])

Richardson_invar_width_kge_10 <- Richardson_stats_invar_width$kge[c(6:10)]
Richardson_invar_width_nash_10 <- Richardson_stats_invar_width$nash[c(6:10)]
Richardson_invar_width_rrmse_10 <- Richardson_stats_invar_width$rrmse[c(6:10)]
Richardson_invar_width_n_rmse_10 <- Richardson_stats_invar_width$n_rmse[c(6:10)]
Richardson_invar_width_p_bias_10 <- Richardson_stats_invar_width$p_bias[c(6:10)]

Richardson_var_width_kge_10 <- Richardson_stats_var_width$kge[c(6:10)]
Richardson_var_width_nash_10 <- Richardson_stats_var_width$nash[c(6:10)]
Richardson_var_width_rrmse_10 <- Richardson_stats_var_width$rrmse[c(6:10)]
Richardson_var_width_n_rmse_10 <- Richardson_stats_var_width$n_rmse[c(6:10)]
Richardson_var_width_p_bias_10 <- Richardson_stats_var_width$p_bias[c(6:10)]

Richardson_invar_width_priors_kge_10 <- Richardson_stats_invar_width_priors$kge[c(6:10)]
Richardson_invar_width_priors_nash_10 <- Richardson_stats_invar_width_priors$nash[c(6:10)]
Richardson_invar_width_priors_rrmse_10 <- Richardson_stats_invar_width_priors$rrmse[c(6:10)]
Richardson_invar_width_priors_n_rmse_10 <- Richardson_stats_invar_width_priors$n_rmse[c(6:10)]
Richardson_invar_width_priors_p_bias_10 <- Richardson_stats_invar_width_priors$p_bias[c(6:10)]

Richardson_invar_width_Qpriors_kge_10 <- Richardson_stats_invar_width_Qpriors$kge[c(6:10)]
Richardson_invar_width_Qpriors_nash_10 <- Richardson_stats_invar_width_Qpriors$nash[c(6:10)]
Richardson_invar_width_Qpriors_rrmse_10 <- Richardson_stats_invar_width_Qpriors$rrmse[c(6:10)]
Richardson_invar_width_Qpriors_n_rmse_10 <- Richardson_stats_invar_width_Qpriors$n_rmse[c(6:10)]
Richardson_invar_width_Qpriors_p_bias_10 <- Richardson_stats_invar_width_Qpriors$p_bias[c(6:10)]

boxplot(Richardson_temp_gauge_all_kge_10, Richardson_invar_width_kge_10, Richardson_invar_width_priors_kge_10, 
        Richardson_invar_width_Qpriors_kge_10, Richardson_var_width_kge_10, 
        Richardson_temp_gauge_all_nash_10, Richardson_invar_width_nash_10, Richardson_invar_width_priors_nash_10, 
        Richardson_invar_width_Qpriors_nash_10, Richardson_var_width_nash_10, 
        Richardson_temp_gauge_all_rrmse_10, Richardson_invar_width_rrmse_10, Richardson_invar_width_priors_rrmse_10, 
        Richardson_invar_width_Qpriors_rrmse_10, Richardson_var_width_rrmse_10, 
        Richardson_temp_gauge_all_n_rmse_10, Richardson_invar_width_n_rmse_10, Richardson_invar_width_priors_n_rmse_10, 
        Richardson_invar_width_Qpriors_n_rmse_10, Richardson_var_width_n_rmse_10, 
        Richardson_temp_gauge_all_p_bias_10, Richardson_invar_width_p_bias_10, Richardson_invar_width_priors_p_bias_10, 
        Richardson_invar_width_Qpriors_p_bias_10, Richardson_var_width_p_bias_10, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#11-46 discharge samples
Richardson_temp_gauge_all_kge_46 <- na.omit(Richardson_gauge_all$kge[Richardson_gauge_all$num_xs > 10.9])
Richardson_temp_gauge_all_nash_46 <- na.omit(Richardson_gauge_all$nash[Richardson_gauge_all$num_xs > 10.9])
Richardson_temp_gauge_all_rrmse_46 <- na.omit(Richardson_gauge_all$rrmse[Richardson_gauge_all$num_xs > 10.9])
Richardson_temp_gauge_all_n_rmse_46 <- na.omit(Richardson_gauge_all$r_rmse[Richardson_gauge_all$num_xs > 10.9])
Richardson_temp_gauge_all_p_bias_46 <- na.omit(Richardson_gauge_all$p_bias[Richardson_gauge_all$num_xs > 10.9])

Richardson_invar_width_kge_46 <- Richardson_stats_invar_width$kge[c(11:46)]
Richardson_invar_width_nash_46 <- Richardson_stats_invar_width$nash[c(11:46)]
Richardson_invar_width_rrmse_46 <- Richardson_stats_invar_width$rrmse[c(11:46)]
Richardson_invar_width_n_rmse_46 <- Richardson_stats_invar_width$n_rmse[c(11:46)]
Richardson_invar_width_p_bias_46 <- Richardson_stats_invar_width$p_bias[c(11:46)]

Richardson_var_width_kge_46 <- Richardson_stats_var_width$kge[c(11:46)]
Richardson_var_width_nash_46 <- Richardson_stats_var_width$nash[c(11:46)]
Richardson_var_width_rrmse_46 <- Richardson_stats_var_width$rrmse[c(11:46)]
Richardson_var_width_n_rmse_46 <- Richardson_stats_var_width$n_rmse[c(11:46)]
Richardson_var_width_p_bias_46 <- Richardson_stats_var_width$p_bias[c(11:46)]

Richardson_invar_width_priors_kge_46 <- Richardson_stats_invar_width_priors$kge[c(11:46)]
Richardson_invar_width_priors_nash_46 <- Richardson_stats_invar_width_priors$nash[c(11:46)]
Richardson_invar_width_priors_rrmse_46 <- Richardson_stats_invar_width_priors$rrmse[c(11:46)]
Richardson_invar_width_priors_n_rmse_46 <- Richardson_stats_invar_width_priors$n_rmse[c(11:46)]
Richardson_invar_width_priors_p_bias_46 <- Richardson_stats_invar_width_priors$p_bias[c(11:46)]

Richardson_invar_width_Qpriors_kge_46 <- Richardson_stats_invar_width_Qpriors$kge[c(11:46)]
Richardson_invar_width_Qpriors_nash_46 <- Richardson_stats_invar_width_Qpriors$nash[c(11:46)]
Richardson_invar_width_Qpriors_rrmse_46 <- Richardson_stats_invar_width_Qpriors$rrmse[c(11:46)]
Richardson_invar_width_Qpriors_n_rmse_46 <- Richardson_stats_invar_width_Qpriors$n_rmse[c(11:46)]
Richardson_invar_width_Qpriors_p_bias_46 <- Richardson_stats_invar_width_Qpriors$p_bias[c(11:46)]

boxplot(Richardson_temp_gauge_all_kge_46, Richardson_invar_width_kge_46, Richardson_invar_width_priors_kge_46, 
        Richardson_invar_width_Qpriors_kge_46, Richardson_var_width_kge_46, 
        Richardson_temp_gauge_all_nash_46, Richardson_invar_width_nash_46, Richardson_invar_width_priors_nash_46, 
        Richardson_invar_width_Qpriors_nash_46, Richardson_var_width_nash_46, 
        Richardson_temp_gauge_all_rrmse_46, Richardson_invar_width_rrmse_46, Richardson_invar_width_priors_rrmse_46, 
        Richardson_invar_width_Qpriors_rrmse_46, Richardson_var_width_rrmse_46, 
        Richardson_temp_gauge_all_n_rmse_46, Richardson_invar_width_n_rmse_46, Richardson_invar_width_priors_n_rmse_46, 
        Richardson_invar_width_Qpriors_n_rmse_46, Richardson_var_width_n_rmse_46, 
        Richardson_temp_gauge_all_p_bias_46, Richardson_invar_width_p_bias_46, Richardson_invar_width_priors_p_bias_46, 
        Richardson_invar_width_Qpriors_p_bias_46, Richardson_var_width_p_bias_46, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
legend("bottomleft", legend = c("Temporary Gauge", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                                "Var width new priors"), pch = c(15), 
       cex = 1,
       col = c("aquamarine4", "blue", "purple", "magenta","orange"))
#Remake plots only ranging from -1 to 0.5
boxplot(Richardson_temp_gauge_all_kge_2, Richardson_invar_width_kge_2, Richardson_invar_width_priors_kge_2, 
        Richardson_invar_width_Qpriors_kge_2, Richardson_var_width_kge_2, 
        Richardson_temp_gauge_all_nash_2, Richardson_invar_width_nash_2, Richardson_invar_width_priors_nash_2, 
        Richardson_invar_width_Qpriors_nash_2, Richardson_var_width_nash_2, 
        Richardson_temp_gauge_all_rrmse_2, Richardson_invar_width_rrmse_2, Richardson_invar_width_priors_rrmse_2, 
        Richardson_invar_width_Qpriors_rrmse_2, Richardson_var_width_rrmse_2, 
        Richardson_temp_gauge_all_n_rmse_2, Richardson_invar_width_n_rmse_2, Richardson_invar_width_priors_n_rmse_2, 
        Richardson_invar_width_Qpriors_n_rmse_2, Richardson_var_width_n_rmse_2, 
        Richardson_temp_gauge_all_p_bias_2, Richardson_invar_width_p_bias_2, Richardson_invar_width_priors_p_bias_2, 
        Richardson_invar_width_Qpriors_p_bias_2, Richardson_var_width_p_bias_2, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Richardson_temp_gauge_all_kge_5, Richardson_invar_width_kge_5, Richardson_invar_width_priors_kge_5, 
        Richardson_invar_width_Qpriors_kge_5, Richardson_var_width_kge_5, 
        Richardson_temp_gauge_all_nash_5, Richardson_invar_width_nash_5, Richardson_invar_width_priors_nash_5, 
        Richardson_invar_width_Qpriors_nash_5, Richardson_var_width_nash_5, 
        Richardson_temp_gauge_all_rrmse_5, Richardson_invar_width_rrmse_5, Richardson_invar_width_priors_rrmse_5, 
        Richardson_invar_width_Qpriors_rrmse_5, Richardson_var_width_rrmse_5, 
        Richardson_temp_gauge_all_n_rmse_5, Richardson_invar_width_n_rmse_5, Richardson_invar_width_priors_n_rmse_5, 
        Richardson_invar_width_Qpriors_n_rmse_5, Richardson_var_width_n_rmse_5, 
        Richardson_temp_gauge_all_p_bias_5, Richardson_invar_width_p_bias_5, Richardson_invar_width_priors_p_bias_5, 
        Richardson_invar_width_Qpriors_p_bias_5, Richardson_var_width_p_bias_5, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Richardson_temp_gauge_all_kge_10, Richardson_invar_width_kge_10, Richardson_invar_width_priors_kge_10, 
        Richardson_invar_width_Qpriors_kge_10, Richardson_var_width_kge_10, 
        Richardson_temp_gauge_all_nash_10, Richardson_invar_width_nash_10, Richardson_invar_width_priors_nash_10, 
        Richardson_invar_width_Qpriors_nash_10, Richardson_var_width_nash_10, 
        Richardson_temp_gauge_all_rrmse_10, Richardson_invar_width_rrmse_10, Richardson_invar_width_priors_rrmse_10, 
        Richardson_invar_width_Qpriors_rrmse_10, Richardson_var_width_rrmse_10, 
        Richardson_temp_gauge_all_n_rmse_10, Richardson_invar_width_n_rmse_10, Richardson_invar_width_priors_n_rmse_10, 
        Richardson_invar_width_Qpriors_n_rmse_10, Richardson_var_width_n_rmse_10, 
        Richardson_temp_gauge_all_p_bias_10, Richardson_invar_width_p_bias_10, Richardson_invar_width_priors_p_bias_10, 
        Richardson_invar_width_Qpriors_p_bias_10, Richardson_var_width_p_bias_10, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Richardson_temp_gauge_all_kge_46, Richardson_invar_width_kge_46, Richardson_invar_width_priors_kge_46, 
        Richardson_invar_width_Qpriors_kge_46, Richardson_var_width_kge_46, 
        Richardson_temp_gauge_all_nash_46, Richardson_invar_width_nash_46, Richardson_invar_width_priors_nash_46, 
        Richardson_invar_width_Qpriors_nash_46, Richardson_var_width_nash_46, 
        Richardson_temp_gauge_all_rrmse_46, Richardson_invar_width_rrmse_46, Richardson_invar_width_priors_rrmse_46, 
        Richardson_invar_width_Qpriors_rrmse_46, Richardson_var_width_rrmse_46, 
        Richardson_temp_gauge_all_n_rmse_46, Richardson_invar_width_n_rmse_46, Richardson_invar_width_priors_n_rmse_46, 
        Richardson_invar_width_Qpriors_n_rmse_46, Richardson_var_width_n_rmse_46, 
        Richardson_temp_gauge_all_p_bias_46, Richardson_invar_width_p_bias_46, Richardson_invar_width_priors_p_bias_46, 
        Richardson_invar_width_Qpriors_p_bias_46, Richardson_var_width_p_bias_46, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")





###Limon------
#load WSE
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/PAD_2019_PT/Limon/WSE")
Limon_WSE <- read.csv("Limon_WSE_PPP_corr.csv")
Limon_WSE <- Limon_WSE %>%
  mutate(day = as.Date(new_time))
Limon_WSE_daily <- aggregate(. ~day, data = Limon_WSE, mean, na.rm = TRUE)[1,c(4:ncol(Limon_WSE))]
head(Limon_WSE)
#load Q
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon")
Limon_corr_Q <- read.csv("Limon_corr_Q.csv")
Limon_corr_Q <- Limon_corr_Q %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Limon_qobs_daily <- aggregate(. ~day, data = Limon_corr_Q[,c(6,8,9,14)], 
                                   mean, na.rm = TRUE)[,2]

#load cl and PT coords
setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon", sep =""))
Limon_cl <-readOGR(dsn = ".", layer = "Limon_CL_UTM")

setwd(paste("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/PAD_2019_PT", sep =""))
Limon_PT_coords <- read.csv("Limon_PT_coords.csv")
Limon_PT_coords_sp <-SpatialPoints(Limon_PT_coords[,4:5], 
                                        proj4string = crs('+proj=utm +zone=12 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0' ))
#calculate the distance between pts
Limon_xvec <- calc_xvec(Limon_PT_coords_sp, Limon_cl)
save(Limon_xvec, file = "Limon_xvec.RData")
#find overlapping ADCP and PT times
Limon_closest_time <- vector(length = length(Limon_corr_Q$new_date))
for(i in 1:length(Limon_corr_Q$new_date)){
  Limon_closest_time[i] = which.min(abs(as.POSIXct(Limon_WSE$new_time, tz = "MST") - 
                                               as.POSIXct(Limon_corr_Q$new_date[i], tz = "MST")))
}

Limon_WSE_corrQ <- Limon_WSE[c(Limon_closest_time[order(Limon_closest_time)]),c(3:6)]

#Calculate slope
Limon_slope <- abs(calcslope(Limon_xvec[c(1,2,3,5)], hmat = t(Limon_WSE_corrQ)))
Limon_slope[1,] <- colMeans(Limon_slope, na.rm = TRUE)

#Run BAM
pt = proc.time()
Limon_bam_invar_width <- run_bam_invar_width_default(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_invar_width",
                                                          slope =  Limon_slope, qobs = Limon_corr_Q, rivname = "Limon",
                                                          minQ = min(Limon_corr_Q$Q), maxQ = max(Limon_corr_Q$Q),
                                                          wse = Limon_WSE_corrQ)
library(hydroGOF)
Limon_val_invar_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_invar_width",
                                      Limon_corr_Q$Q)
Limon_val_invar_width <- Limon_val_invar_width[order(Limon_val_invar_width$num_xs),]
Limon_stats_invar_width <- bam_val_stats(Limon_val_invar_width)
Limon_plot_invar_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_invar_width",
                                        Limon_corr_Q$Q)
proc.time()-pt

#With new priors
pt = proc.time()
Limon_bam_invar_width_priors <- run_bam_invar_width_Q(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_invar_width_priors",
                                                           slope =  Limon_slope, qobs = Limon_corr_Q, rivname = "Limon",
                                                           minQ = min(Limon_corr_Q$Q), maxQ = max(Limon_corr_Q$Q),
                                                           wse = Limon_WSE_corrQ)
library(hydroGOF)
Limon_val_invar_width_priors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_invar_width_priors",
                                             Limon_corr_Q$Q)
Limon_val_invar_width_priors <- Limon_val_invar_width_priors[order(Limon_val_invar_width_priors$num_xs),]
Limon_stats_invar_width_priors <- bam_val_stats(Limon_val_invar_width_priors)
Limon_plot_invar_width_priors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_invar_width_priors",
                                               Limon_corr_Q$Q)
proc.time()-pt


#With new priors and Q prior
pt = proc.time()
Limon_bam_invar_width_Qpriors <- run_bam_invar_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_invar_width_Qpriors",
                                                          slope =  Limon_slope, qobs = Limon_corr_Q, rivname = "Limon",
                                                          wse = Limon_WSE_corrQ)
library(hydroGOF)
Limon_val_invar_width_Qpriors <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_invar_width_Qpriors",
                                              Limon_corr_Q$Q)
Limon_val_invar_width_Qpriors <- Limon_val_invar_width_Qpriors[order(Limon_val_invar_width_Qpriors$num_xs),]
Limon_stats_invar_width_Qpriors <- bam_val_stats(Limon_val_invar_width_Qpriors)
Limon_plot_invar_width_Qpriors <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_invar_width_Qpriors",
                                                Limon_corr_Q$Q)
proc.time()-pt

#var width
pt = proc.time()
Limon_bam_var_width <- run_bam_var_width(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_var_width",
                                              slope =  Limon_slope, qobs = Limon_corr_Q, rivname = "Limon",
                                              wse = Limon_WSE_corrQ)
library(hydroGOF)
Limon_val_var_width <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_var_width",
                                    Limon_corr_Q$Q)
Limon_val_var_width <- Limon_val_var_width[order(Limon_val_var_width$num_xs),]
Limon_stats_var_width <- bam_val_stats(Limon_val_var_width)
Limon_plot_var_width <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_var_width",
                                      Limon_corr_Q$Q)
proc.time()-pt


#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/Gauge_All")
Limon_temp_gauge_all <- temporary_gauge_all(num_days = nrow(Limon_WSE_corrQ), 
                                                 pt_count = ncol(Limon_WSE_corrQ), 
                                                 file_name = "Limon",
                                                 WSE_mat = t(Limon_WSE_corrQ), 
                                                 Qobs = Limon_corr_Q$Q)
Limon_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/Gauge_All",
                                        Limon_corr_Q$Q)

#Load BAM results from old method of estimating width from DEM
library(hydroGOF)
Limon_val_corr_Q <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_corrQ",
                                 Limon_corr_Q$Q)
Limon_val_corr_Q <- Limon_val_corr_Q[order(Limon_val_corr_Q$num_xs),]
Limon_stats_corr_Q <- bam_val_stats(Limon_val_corr_Q)

#Plot total time and all error metrics--------
#KGE
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Limon_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Limon_corr_Q$Q)), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$kge - Limon_stats_invar_width$kge_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$kge + Limon_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$kge - Limon_stats_invar_width_priors$kge_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$kge + Limon_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$kge - Limon_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$kge + Limon_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$kge - Limon_stats_var_width$kge_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$kge + Limon_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Limon_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Limon_corr_Q$Q)), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$nash - Limon_stats_invar_width$nash_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$nash + Limon_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$nash - Limon_stats_invar_width_priors$nash_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$nash + Limon_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$nash - Limon_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$nash + Limon_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$nash - Limon_stats_var_width$nash_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$nash + Limon_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Limon_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Limon_corr_Q$Q)), 
        ylim= c(0.15, 0.25)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$rrmse - Limon_stats_invar_width$rrmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$rrmse + Limon_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$rrmse - Limon_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$rrmse + Limon_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$rrmse - Limon_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$rrmse + Limon_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$rrmse - Limon_stats_var_width$rrmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$rrmse + Limon_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Limon_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Limon_corr_Q$Q)), 
        ylim= c(0.8, 1.6)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$n_rmse - Limon_stats_invar_width$n_rmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$n_rmse + Limon_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$n_rmse - Limon_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$n_rmse + Limon_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$n_rmse - Limon_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$n_rmse + Limon_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$n_rmse - Limon_stats_var_width$n_rmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$n_rmse + Limon_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Limon_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, length(Limon_corr_Q$Q)), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$p_bias - Limon_stats_invar_width$p_bias_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$p_bias + Limon_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$p_bias - Limon_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$p_bias + Limon_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$p_bias - Limon_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$p_bias + Limon_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$p_bias - Limon_stats_var_width$p_bias_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$p_bias + Limon_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(63, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot 10 time steps to show tradeoff better-------------
dev.off()
par(mfrow = c(3,2))
par(family = "serif")
boxplot(kge~num_xs,
        data= Limon_gauge_all,
        main="KGE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-1, 0.5)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$kge, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$kge - Limon_stats_invar_width$kge_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$kge + Limon_stats_invar_width$kge_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$kge, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$kge - Limon_stats_invar_width_priors$kge_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$kge + Limon_stats_invar_width_priors$kge_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$kge, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$kge - Limon_stats_invar_width_Qpriors$kge_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$kge + Limon_stats_invar_width_Qpriors$kge_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$kge, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$kge - Limon_stats_var_width$kge_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$kge + Limon_stats_var_width$kge_sd, length=0.05, angle=90, code=3,
       col = "orange")

#NSE
boxplot(nash~num_xs,
        data= Limon_gauge_all,
        main="NSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-2, 0.25)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$nash, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$nash - Limon_stats_invar_width$nash_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$nash + Limon_stats_invar_width$nash_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$nash, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$nash - Limon_stats_invar_width_priors$nash_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$nash + Limon_stats_invar_width_priors$nash_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$nash, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$nash - Limon_stats_invar_width_Qpriors$nash_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$nash + Limon_stats_invar_width_Qpriors$nash_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$nash, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$nash - Limon_stats_var_width$nash_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$nash + Limon_stats_var_width$nash_sd, length=0.05, angle=90, code=3,
       col = "orange")
#rrmse
boxplot(rrmse~num_xs,
        data= Limon_gauge_all,
        main="RRMSE", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(0.05, 0.15)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$rrmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$rrmse - Limon_stats_invar_width$rrmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$rrmse + Limon_stats_invar_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$rrmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$rrmse - Limon_stats_invar_width_priors$rrmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$rrmse + Limon_stats_invar_width_priors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$rrmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$rrmse - Limon_stats_invar_width_Qpriors$rrmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$rrmse + Limon_stats_invar_width_Qpriors$rrmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$rrmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$rrmse - Limon_stats_var_width$rrmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$rrmse + Limon_stats_var_width$rrmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#n_rmse
boxplot(n_rmse~num_xs,
        data= Limon_gauge_all,
        main="NRMSE", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(80, 200)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$n_rmse, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$n_rmse - Limon_stats_invar_width$n_rmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$n_rmse + Limon_stats_invar_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$n_rmse, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$n_rmse - Limon_stats_invar_width_priors$n_rmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$n_rmse + Limon_stats_invar_width_priors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$n_rmse, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$n_rmse - Limon_stats_invar_width_Qpriors$n_rmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$n_rmse + Limon_stats_invar_width_Qpriors$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$n_rmse, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$n_rmse - Limon_stats_var_width$n_rmse_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$n_rmse + Limon_stats_var_width$n_rmse_sd, length=0.05, angle=90, code=3,
       col = "orange")
#p_bias
boxplot(p_bias~num_xs,
        data= Limon_gauge_all,
        main="PBIAS", xaxt = "n",
        xlab="", ylab="", col="aquamarine4",
        border = "black", cex.lab = 1.5, cex.axis = 1.5, cex.main = 2, 
        xlim = c(0, 10.1), 
        ylim= c(-8, 4)
)
axis(1, at = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), 
     labels = seq(0, (nrow(Limon_WSE_corrQ)-1), 10), cex.axis = 1.5)
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width$p_bias, col = "blue", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$p_bias - Limon_stats_invar_width$p_bias_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width$p_bias + Limon_stats_invar_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "blue")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_priors$p_bias, col = "purple", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$p_bias - Limon_stats_invar_width_priors$p_bias_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_priors$p_bias + Limon_stats_invar_width_priors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "purple")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_invar_width_Qpriors$p_bias, col = "magenta", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$p_bias - Limon_stats_invar_width_Qpriors$p_bias_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_invar_width_Qpriors$p_bias + Limon_stats_invar_width_Qpriors$p_bias_sd, length=0.05, angle=90, code=3,
       col = "magenta")
points(c(0:(nrow(Limon_WSE_corrQ)-1)), Limon_stats_var_width$p_bias, col = "orange", pch = 19)
arrows(c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$p_bias - Limon_stats_var_width$p_bias_sd, c(0:(nrow(Limon_WSE_corrQ)-1)), 
       Limon_stats_var_width$p_bias + Limon_stats_var_width$p_bias_sd, length=0.05, angle=90, code=3,
       col = "orange")

par(xpd = NA)
legend(14, 4, legend = c("Invar width", "Invar width new priors w/o Q","Invar width new priors",
                         "Var width new priors", "Temporary Gauge"), pch = c(19, 19, 19, 19, 15), 
       cex = 1.8,
       col = c("blue", "purple", "magenta","orange", "aquamarine4"))

#Plot multiple error metric comparison------
#2 discharge samples-----
Limon_temp_gauge_all_kge_2 <- na.omit(Limon_gauge_all$kge[Limon_gauge_all$num_xs == 1.9])
Limon_temp_gauge_all_nash_2 <- na.omit(Limon_gauge_all$nash[Limon_gauge_all$num_xs == 1.9])
Limon_temp_gauge_all_rrmse_2 <- na.omit(Limon_gauge_all$rrmse[Limon_gauge_all$num_xs == 1.9])
Limon_temp_gauge_all_n_rmse_2 <- na.omit(Limon_gauge_all$n_rmse[Limon_gauge_all$num_xs == 1.9])
Limon_temp_gauge_all_p_bias_2 <- na.omit(Limon_gauge_all$p_bias[Limon_gauge_all$num_xs == 1.9])

Limon_invar_width_kge_2 <- Limon_stats_invar_width$kge[c(1,2)]
Limon_invar_width_nash_2 <- Limon_stats_invar_width$nash[c(1,2)]
Limon_invar_width_rrmse_2 <- Limon_stats_invar_width$rrmse[c(1,2)]
Limon_invar_width_n_rmse_2 <- Limon_stats_invar_width$n_rmse[c(1,2)]
Limon_invar_width_p_bias_2 <- Limon_stats_invar_width$p_bias[c(1,2)]

Limon_var_width_kge_2 <- Limon_stats_var_width$kge[c(1,2)]
Limon_var_width_nash_2 <- Limon_stats_var_width$nash[c(1,2)]
Limon_var_width_rrmse_2 <- Limon_stats_var_width$rrmse[c(1,2)]
Limon_var_width_n_rmse_2 <- Limon_stats_var_width$n_rmse[c(1,2)]
Limon_var_width_p_bias_2 <- Limon_stats_var_width$p_bias[c(1,2)]

Limon_invar_width_priors_kge_2 <- Limon_stats_invar_width_priors$kge[c(1,2)]
Limon_invar_width_priors_nash_2 <- Limon_stats_invar_width_priors$nash[c(1,2)]
Limon_invar_width_priors_rrmse_2 <- Limon_stats_invar_width_priors$rrmse[c(1,2)]
Limon_invar_width_priors_n_rmse_2 <- Limon_stats_invar_width_priors$n_rmse[c(1,2)]
Limon_invar_width_priors_p_bias_2 <- Limon_stats_invar_width_priors$p_bias[c(1,2)]

Limon_invar_width_Qpriors_kge_2 <- Limon_stats_invar_width_Qpriors$kge[c(1,2)]
Limon_invar_width_Qpriors_nash_2 <- Limon_stats_invar_width_Qpriors$nash[c(1,2)]
Limon_invar_width_Qpriors_rrmse_2 <- Limon_stats_invar_width_Qpriors$rrmse[c(1,2)]
Limon_invar_width_Qpriors_n_rmse_2 <- Limon_stats_invar_width_Qpriors$n_rmse[c(1,2)]
Limon_invar_width_Qpriors_p_bias_2 <- Limon_stats_invar_width_Qpriors$p_bias[c(1,2)]

dev.off()
par(mfrow = c(2,2))
par(family = "serif")
boxplot(Limon_temp_gauge_all_kge_2, Limon_invar_width_kge_2, Limon_invar_width_priors_kge_2, 
        Limon_invar_width_Qpriors_kge_2, Limon_var_width_kge_2, 
        Limon_temp_gauge_all_nash_2, Limon_invar_width_nash_2, Limon_invar_width_priors_nash_2, 
        Limon_invar_width_Qpriors_nash_2, Limon_var_width_nash_2, 
        Limon_temp_gauge_all_rrmse_2, Limon_invar_width_rrmse_2, Limon_invar_width_priors_rrmse_2, 
        Limon_invar_width_Qpriors_rrmse_2, Limon_var_width_rrmse_2, 
        Limon_temp_gauge_all_n_rmse_2, Limon_invar_width_n_rmse_2, Limon_invar_width_priors_n_rmse_2, 
        Limon_invar_width_Qpriors_n_rmse_2, Limon_var_width_n_rmse_2, 
        Limon_temp_gauge_all_p_bias_2, Limon_invar_width_p_bias_2, Limon_invar_width_priors_p_bias_2, 
        Limon_invar_width_Qpriors_p_bias_2, Limon_var_width_p_bias_2, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
#3-5 discharge samples------
Limon_temp_gauge_all_kge_5 <- na.omit(Limon_gauge_all$kge[Limon_gauge_all$num_xs > 1.9 & Limon_gauge_all$num_xs < 6.9])
Limon_temp_gauge_all_nash_5 <- na.omit(Limon_gauge_all$nash[Limon_gauge_all$num_xs > 1.9 & Limon_gauge_all$num_xs < 6.9])
Limon_temp_gauge_all_rrmse_5 <- na.omit(Limon_gauge_all$rrmse[Limon_gauge_all$num_xs > 1.9 & Limon_gauge_all$num_xs < 6.9])
Limon_temp_gauge_all_n_rmse_5 <- na.omit(Limon_gauge_all$n_rmse[Limon_gauge_all$num_xs > 1.9 & Limon_gauge_all$num_xs < 6.9])
Limon_temp_gauge_all_p_bias_5 <- na.omit(Limon_gauge_all$p_bias[Limon_gauge_all$num_xs > 1.9 & Limon_gauge_all$num_xs < 6.9])

Limon_invar_width_kge_5 <- Limon_stats_invar_width$kge[c(3:5)]
Limon_invar_width_nash_5 <- Limon_stats_invar_width$nash[c(3:5)]
Limon_invar_width_rrmse_5 <- Limon_stats_invar_width$rrmse[c(3:5)]
Limon_invar_width_n_rmse_5 <- Limon_stats_invar_width$n_rmse[c(3:5)]
Limon_invar_width_p_bias_5 <- Limon_stats_invar_width$p_bias[c(3:5)]

Limon_var_width_kge_5 <- Limon_stats_var_width$kge[c(3:5)]
Limon_var_width_nash_5 <- Limon_stats_var_width$nash[c(3:5)]
Limon_var_width_rrmse_5 <- Limon_stats_var_width$rrmse[c(3:5)]
Limon_var_width_n_rmse_5 <- Limon_stats_var_width$n_rmse[c(3:5)]
Limon_var_width_p_bias_5 <- Limon_stats_var_width$p_bias[c(3:5)]

Limon_invar_width_priors_kge_5 <- Limon_stats_invar_width_priors$kge[c(3:5)]
Limon_invar_width_priors_nash_5 <- Limon_stats_invar_width_priors$nash[c(3:5)]
Limon_invar_width_priors_rrmse_5 <- Limon_stats_invar_width_priors$rrmse[c(3:5)]
Limon_invar_width_priors_n_rmse_5 <- Limon_stats_invar_width_priors$n_rmse[c(3:5)]
Limon_invar_width_priors_p_bias_5 <- Limon_stats_invar_width_priors$p_bias[c(3:5)]

Limon_invar_width_Qpriors_kge_5 <- Limon_stats_invar_width_Qpriors$kge[c(3:5)]
Limon_invar_width_Qpriors_nash_5 <- Limon_stats_invar_width_Qpriors$nash[c(3:5)]
Limon_invar_width_Qpriors_rrmse_5 <- Limon_stats_invar_width_Qpriors$rrmse[c(3:5)]
Limon_invar_width_Qpriors_n_rmse_5 <- Limon_stats_invar_width_Qpriors$n_rmse[c(3:5)]
Limon_invar_width_Qpriors_p_bias_5 <- Limon_stats_invar_width_Qpriors$p_bias[c(3:5)]

boxplot(Limon_temp_gauge_all_kge_5, Limon_invar_width_kge_5, Limon_invar_width_priors_kge_5, 
        Limon_invar_width_Qpriors_kge_5, Limon_var_width_kge_5, 
        Limon_temp_gauge_all_nash_5, Limon_invar_width_nash_5, Limon_invar_width_priors_nash_5, 
        Limon_invar_width_Qpriors_nash_5, Limon_var_width_nash_5, 
        Limon_temp_gauge_all_rrmse_5, Limon_invar_width_rrmse_5, Limon_invar_width_priors_rrmse_5, 
        Limon_invar_width_Qpriors_rrmse_5, Limon_var_width_rrmse_5, 
        Limon_temp_gauge_all_n_rmse_5, Limon_invar_width_n_rmse_5, Limon_invar_width_priors_n_rmse_5, 
        Limon_invar_width_Qpriors_n_rmse_5, Limon_var_width_n_rmse_5, 
        Limon_temp_gauge_all_p_bias_5, Limon_invar_width_p_bias_5, Limon_invar_width_priors_p_bias_5, 
        Limon_invar_width_Qpriors_p_bias_5, Limon_var_width_p_bias_5, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#6-10 discharge samples
Limon_temp_gauge_all_kge_10 <- na.omit(Limon_gauge_all$kge[Limon_gauge_all$num_xs > 5.9 & Limon_gauge_all$num_xs < 11.9])
Limon_temp_gauge_all_nash_10 <- na.omit(Limon_gauge_all$nash[Limon_gauge_all$num_xs > 5.9 & Limon_gauge_all$num_xs < 11.9])
Limon_temp_gauge_all_rrmse_10 <- na.omit(Limon_gauge_all$rrmse[Limon_gauge_all$num_xs > 5.9 & Limon_gauge_all$num_xs < 11.9])
Limon_temp_gauge_all_n_rmse_10 <- na.omit(Limon_gauge_all$n_rmse[Limon_gauge_all$num_xs > 5.9 & Limon_gauge_all$num_xs < 11.9])
Limon_temp_gauge_all_p_bias_10 <- na.omit(Limon_gauge_all$p_bias[Limon_gauge_all$num_xs > 5.9 & Limon_gauge_all$num_xs < 11.9])

Limon_invar_width_kge_10 <- Limon_stats_invar_width$kge[c(6:10)]
Limon_invar_width_nash_10 <- Limon_stats_invar_width$nash[c(6:10)]
Limon_invar_width_rrmse_10 <- Limon_stats_invar_width$rrmse[c(6:10)]
Limon_invar_width_n_rmse_10 <- Limon_stats_invar_width$n_rmse[c(6:10)]
Limon_invar_width_p_bias_10 <- Limon_stats_invar_width$p_bias[c(6:10)]

Limon_var_width_kge_10 <- Limon_stats_var_width$kge[c(6:10)]
Limon_var_width_nash_10 <- Limon_stats_var_width$nash[c(6:10)]
Limon_var_width_rrmse_10 <- Limon_stats_var_width$rrmse[c(6:10)]
Limon_var_width_n_rmse_10 <- Limon_stats_var_width$n_rmse[c(6:10)]
Limon_var_width_p_bias_10 <- Limon_stats_var_width$p_bias[c(6:10)]

Limon_invar_width_priors_kge_10 <- Limon_stats_invar_width_priors$kge[c(6:10)]
Limon_invar_width_priors_nash_10 <- Limon_stats_invar_width_priors$nash[c(6:10)]
Limon_invar_width_priors_rrmse_10 <- Limon_stats_invar_width_priors$rrmse[c(6:10)]
Limon_invar_width_priors_n_rmse_10 <- Limon_stats_invar_width_priors$n_rmse[c(6:10)]
Limon_invar_width_priors_p_bias_10 <- Limon_stats_invar_width_priors$p_bias[c(6:10)]

Limon_invar_width_Qpriors_kge_10 <- Limon_stats_invar_width_Qpriors$kge[c(6:10)]
Limon_invar_width_Qpriors_nash_10 <- Limon_stats_invar_width_Qpriors$nash[c(6:10)]
Limon_invar_width_Qpriors_rrmse_10 <- Limon_stats_invar_width_Qpriors$rrmse[c(6:10)]
Limon_invar_width_Qpriors_n_rmse_10 <- Limon_stats_invar_width_Qpriors$n_rmse[c(6:10)]
Limon_invar_width_Qpriors_p_bias_10 <- Limon_stats_invar_width_Qpriors$p_bias[c(6:10)]

boxplot(Limon_temp_gauge_all_kge_10, Limon_invar_width_kge_10, Limon_invar_width_priors_kge_10, 
        Limon_invar_width_Qpriors_kge_10, Limon_var_width_kge_10, 
        Limon_temp_gauge_all_nash_10, Limon_invar_width_nash_10, Limon_invar_width_priors_nash_10, 
        Limon_invar_width_Qpriors_nash_10, Limon_var_width_nash_10, 
        Limon_temp_gauge_all_rrmse_10, Limon_invar_width_rrmse_10, Limon_invar_width_priors_rrmse_10, 
        Limon_invar_width_Qpriors_rrmse_10, Limon_var_width_rrmse_10, 
        Limon_temp_gauge_all_n_rmse_10, Limon_invar_width_n_rmse_10, Limon_invar_width_priors_n_rmse_10, 
        Limon_invar_width_Qpriors_n_rmse_10, Limon_var_width_n_rmse_10, 
        Limon_temp_gauge_all_p_bias_10, Limon_invar_width_p_bias_10, Limon_invar_width_priors_p_bias_10, 
        Limon_invar_width_Qpriors_p_bias_10, Limon_var_width_p_bias_10, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

#11-46 discharge samples
Limon_temp_gauge_all_kge_46 <- na.omit(Limon_gauge_all$kge[Limon_gauge_all$num_xs > 10.9])
Limon_temp_gauge_all_nash_46 <- na.omit(Limon_gauge_all$nash[Limon_gauge_all$num_xs > 10.9])
Limon_temp_gauge_all_rrmse_46 <- na.omit(Limon_gauge_all$rrmse[Limon_gauge_all$num_xs > 10.9])
Limon_temp_gauge_all_n_rmse_46 <- na.omit(Limon_gauge_all$r_rmse[Limon_gauge_all$num_xs > 10.9])
Limon_temp_gauge_all_p_bias_46 <- na.omit(Limon_gauge_all$p_bias[Limon_gauge_all$num_xs > 10.9])

Limon_invar_width_kge_46 <- Limon_stats_invar_width$kge[c(11:46)]
Limon_invar_width_nash_46 <- Limon_stats_invar_width$nash[c(11:46)]
Limon_invar_width_rrmse_46 <- Limon_stats_invar_width$rrmse[c(11:46)]
Limon_invar_width_n_rmse_46 <- Limon_stats_invar_width$n_rmse[c(11:46)]
Limon_invar_width_p_bias_46 <- Limon_stats_invar_width$p_bias[c(11:46)]

Limon_var_width_kge_46 <- Limon_stats_var_width$kge[c(11:46)]
Limon_var_width_nash_46 <- Limon_stats_var_width$nash[c(11:46)]
Limon_var_width_rrmse_46 <- Limon_stats_var_width$rrmse[c(11:46)]
Limon_var_width_n_rmse_46 <- Limon_stats_var_width$n_rmse[c(11:46)]
Limon_var_width_p_bias_46 <- Limon_stats_var_width$p_bias[c(11:46)]

Limon_invar_width_priors_kge_46 <- Limon_stats_invar_width_priors$kge[c(11:46)]
Limon_invar_width_priors_nash_46 <- Limon_stats_invar_width_priors$nash[c(11:46)]
Limon_invar_width_priors_rrmse_46 <- Limon_stats_invar_width_priors$rrmse[c(11:46)]
Limon_invar_width_priors_n_rmse_46 <- Limon_stats_invar_width_priors$n_rmse[c(11:46)]
Limon_invar_width_priors_p_bias_46 <- Limon_stats_invar_width_priors$p_bias[c(11:46)]

Limon_invar_width_Qpriors_kge_46 <- Limon_stats_invar_width_Qpriors$kge[c(11:46)]
Limon_invar_width_Qpriors_nash_46 <- Limon_stats_invar_width_Qpriors$nash[c(11:46)]
Limon_invar_width_Qpriors_rrmse_46 <- Limon_stats_invar_width_Qpriors$rrmse[c(11:46)]
Limon_invar_width_Qpriors_n_rmse_46 <- Limon_stats_invar_width_Qpriors$n_rmse[c(11:46)]
Limon_invar_width_Qpriors_p_bias_46 <- Limon_stats_invar_width_Qpriors$p_bias[c(11:46)]

boxplot(Limon_temp_gauge_all_kge_46, Limon_invar_width_kge_46, Limon_invar_width_priors_kge_46, 
        Limon_invar_width_Qpriors_kge_46, Limon_var_width_kge_46, 
        Limon_temp_gauge_all_nash_46, Limon_invar_width_nash_46, Limon_invar_width_priors_nash_46, 
        Limon_invar_width_Qpriors_nash_46, Limon_var_width_nash_46, 
        Limon_temp_gauge_all_rrmse_46, Limon_invar_width_rrmse_46, Limon_invar_width_priors_rrmse_46, 
        Limon_invar_width_Qpriors_rrmse_46, Limon_var_width_rrmse_46, 
        Limon_temp_gauge_all_n_rmse_46, Limon_invar_width_n_rmse_46, Limon_invar_width_priors_n_rmse_46, 
        Limon_invar_width_Qpriors_n_rmse_46, Limon_var_width_n_rmse_46, 
        Limon_temp_gauge_all_p_bias_46, Limon_invar_width_p_bias_46, Limon_invar_width_priors_p_bias_46, 
        Limon_invar_width_Qpriors_p_bias_46, Limon_var_width_p_bias_46, 
        ylim = c(-5,1.5), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")
legend("bottomleft", legend = c("Temporary Gauge", "Invar width", "Invar width new priors w/o Q","Invar width new priors",
                                "Var width new priors"), pch = c(15), 
       cex = 1,
       col = c("aquamarine4", "blue", "purple", "magenta","orange"))
#Remake plots only ranging from -1 to 0.5
boxplot(Limon_temp_gauge_all_kge_2, Limon_invar_width_kge_2, Limon_invar_width_priors_kge_2, 
        Limon_invar_width_Qpriors_kge_2, Limon_var_width_kge_2, 
        Limon_temp_gauge_all_nash_2, Limon_invar_width_nash_2, Limon_invar_width_priors_nash_2, 
        Limon_invar_width_Qpriors_nash_2, Limon_var_width_nash_2, 
        Limon_temp_gauge_all_rrmse_2, Limon_invar_width_rrmse_2, Limon_invar_width_priors_rrmse_2, 
        Limon_invar_width_Qpriors_rrmse_2, Limon_var_width_rrmse_2, 
        Limon_temp_gauge_all_n_rmse_2, Limon_invar_width_n_rmse_2, Limon_invar_width_priors_n_rmse_2, 
        Limon_invar_width_Qpriors_n_rmse_2, Limon_var_width_n_rmse_2, 
        Limon_temp_gauge_all_p_bias_2, Limon_invar_width_p_bias_2, Limon_invar_width_priors_p_bias_2, 
        Limon_invar_width_Qpriors_p_bias_2, Limon_var_width_p_bias_2, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "1-2 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Limon_temp_gauge_all_kge_5, Limon_invar_width_kge_5, Limon_invar_width_priors_kge_5, 
        Limon_invar_width_Qpriors_kge_5, Limon_var_width_kge_5, 
        Limon_temp_gauge_all_nash_5, Limon_invar_width_nash_5, Limon_invar_width_priors_nash_5, 
        Limon_invar_width_Qpriors_nash_5, Limon_var_width_nash_5, 
        Limon_temp_gauge_all_rrmse_5, Limon_invar_width_rrmse_5, Limon_invar_width_priors_rrmse_5, 
        Limon_invar_width_Qpriors_rrmse_5, Limon_var_width_rrmse_5, 
        Limon_temp_gauge_all_n_rmse_5, Limon_invar_width_n_rmse_5, Limon_invar_width_priors_n_rmse_5, 
        Limon_invar_width_Qpriors_n_rmse_5, Limon_var_width_n_rmse_5, 
        Limon_temp_gauge_all_p_bias_5, Limon_invar_width_p_bias_5, Limon_invar_width_priors_p_bias_5, 
        Limon_invar_width_Qpriors_p_bias_5, Limon_var_width_p_bias_5, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "3-5 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Limon_temp_gauge_all_kge_10, Limon_invar_width_kge_10, Limon_invar_width_priors_kge_10, 
        Limon_invar_width_Qpriors_kge_10, Limon_var_width_kge_10, 
        Limon_temp_gauge_all_nash_10, Limon_invar_width_nash_10, Limon_invar_width_priors_nash_10, 
        Limon_invar_width_Qpriors_nash_10, Limon_var_width_nash_10, 
        Limon_temp_gauge_all_rrmse_10, Limon_invar_width_rrmse_10, Limon_invar_width_priors_rrmse_10, 
        Limon_invar_width_Qpriors_rrmse_10, Limon_var_width_rrmse_10, 
        Limon_temp_gauge_all_n_rmse_10, Limon_invar_width_n_rmse_10, Limon_invar_width_priors_n_rmse_10, 
        Limon_invar_width_Qpriors_n_rmse_10, Limon_var_width_n_rmse_10, 
        Limon_temp_gauge_all_p_bias_10, Limon_invar_width_p_bias_10, Limon_invar_width_priors_p_bias_10, 
        Limon_invar_width_Qpriors_p_bias_10, Limon_var_width_p_bias_10, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "6-10 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")

boxplot(Limon_temp_gauge_all_kge_46, Limon_invar_width_kge_46, Limon_invar_width_priors_kge_46, 
        Limon_invar_width_Qpriors_kge_46, Limon_var_width_kge_46, 
        Limon_temp_gauge_all_nash_46, Limon_invar_width_nash_46, Limon_invar_width_priors_nash_46, 
        Limon_invar_width_Qpriors_nash_46, Limon_var_width_nash_46, 
        Limon_temp_gauge_all_rrmse_46, Limon_invar_width_rrmse_46, Limon_invar_width_priors_rrmse_46, 
        Limon_invar_width_Qpriors_rrmse_46, Limon_var_width_rrmse_46, 
        Limon_temp_gauge_all_n_rmse_46, Limon_invar_width_n_rmse_46, Limon_invar_width_priors_n_rmse_46, 
        Limon_invar_width_Qpriors_n_rmse_46, Limon_var_width_n_rmse_46, 
        Limon_temp_gauge_all_p_bias_46, Limon_invar_width_p_bias_46, Limon_invar_width_priors_p_bias_46, 
        Limon_invar_width_Qpriors_p_bias_46, Limon_var_width_p_bias_46, 
        ylim = c(-1,1), 
        col = c("aquamarine4", "blue", "purple", "magenta","orange"),xaxt = "n", 
        main = "11-46 Discharge Samples",
        at = c(1:5, 7:11, 13:17, 19:23, 25:29))
axis(1, at = seq(3, 30, 6), 
     labels = c("KGE", "NSE", "RRMSE", "NRMSE", "PBIAS"), las = 2)
abline(h = 0, lty = 2, col = "darkgrey")





###Rochers------
par(family = "serif")
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/PAD_2018_PT/Rochers/WSE")
Rochers_WSE <- read.csv("Rochers_WSE_PPP_corr.csv")
Rochers_WSE <- Rochers_WSE[,c(1:7)]
Rochers_WSE <- Rochers_WSE %>%
  mutate(day = as.Date(new_time, format="%d/%m/%Y"))
Rochers_WSE_daily <- aggregate(. ~day, data = Rochers_WSE, mean, na.rm = TRUE)[,c(4:ncol(Rochers_WSE))]
plot_elev_prof(Rochers_elev_prof, Rochers_WSE_daily, "Rochers")

#Full Daily Time Series (No validation)
locator(n = 4)
Rochers_upper_l <- c(58.2, 47.2,  57.9,  73.5,  73.5)
Rochers_lower_l <- c(67.4, 65.3,  86.8,  85.2,  85.2)
Rochers_lower_r <- c(82.6, 79.1, 104.2,  95.1,  95.1)
Rochers_upper_r <- c(97.7, 94.8, 126.4, 102.7, 102.7)

Rochers_elev_prof[[5]] = Rochers_elev_prof[[4]]
Rochers_width <- calc_width_new(h = Rochers_WSE_daily, elev_prof = Rochers_elev_prof[1:5], 
                                upper_l = Rochers_upper_l, lower_l = Rochers_lower_l, 
                                lower_r = Rochers_lower_r, upper_r = Rochers_upper_r,
                                scale_prof = c(Rochers_scale_x[1:4], Rochers_scale_x[4]))

Rochers_dA <- calcdA_mat(t(Rochers_width), t(Rochers_WSE_daily))
Rochers_xvec <- calc_xvec(Rochers_PT_coords_sp[c(1:5)], Rochers_cl)
Rochers_slope <- abs(calcslope(rev(Rochers_xvec), hmat = t(Rochers_WSE_daily)))
Rochers_slope[1,] <- colMeans(Rochers_slope, na.rm = TRUE)
Rochers_qobs_df$Location <- unlist(lapply(Rochers_qobs_df$Location, toString))
Rochers_qobs_df <- Rochers_qobs_df[startsWith(Rochers_qobs_df$Location,
                                              "RC"),]
Rochers_qobs_df <- Rochers_qobs_df %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Rochers_corr_Q <- Rochers_qobs_df[Rochers_qobs_df$Q > 1000,]
Rochers_qobs_daily <- aggregate(. ~day, data = Rochers_corr_Q[,c(6,11)], mean, na.rm = TRUE)[,2]

#Plot Data
layout(matrix(3:1,ncol=1))
par(family = "serif")
colfunc <- colorRampPalette(c("cyan", "darkblue"))(10)
Rochers_width_plot <- matplot(Rochers_width, type = c("l"), col= colfunc,
                              main = " ", xlab = " ",
                              ylab = "Width (m)",
                              cex.lab = 2, cex.axis = 2, cex.main =3) #plot
Rochers_dA_plot <- matplot(t(Rochers_dA), type = c("l"), col= colfunc,
                           main = " ", xlab = " ",
                           ylab = "dA (m^2)",
                           cex.lab = 2, cex.axis = 2, cex.main =3) #plot
Rochers_slope_plot <- matplot(t(Rochers_slope), type = c("l"), col= colfunc,
                              main = " ", xlab = " ",
                              ylab = "Slope",
                              cex.lab = 2, cex.axis = 2, cex.main =3) #plot

Rochers_data <- bam_data(w = t(Rochers_width), dA = Rochers_dA, s = Rochers_slope, 
                         Qhat = Rochers_corr_Q$Q)
Rochers_priors <- bam_priors(bamdata= Rochers_data, 
                             lowerbound_logQ = log(1200), 
                             upperbound_logQ = log(2500))
Rochers_bam <- bam_estimate(bamdata = Rochers_data, bampriors = Rochers_priors)
detach(package:hydroGOF)
Rochers_bam_val <- bam_validate(fit = Rochers_bam, qobs = seq(1, nrow(Rochers_WSE_daily), 1))
par(family = "serif")

bam_hydrograph(fit = Rochers_bam)+
  xlab("Time (days)")+ylab(expression(Discharge~ (m^{3}/s)))+theme_bw()+
  theme(text=element_text(size=16, family="serif"))+ 
  ggtitle("Rochers Hydrograph") + 
  scale_x_continuous(breaks = seq(0, 30, 10),labels = paste0(c("8/7/18", "8/27/18", 
                                                               "9/15/18", "10/5/18")))+
  annotate("point", x = c(2:4), y = c(Rochers_qobs_daily), colour = "black")

par(bg = NA)
par(family = "serif")
par(mar=c(5.1, 5.5, 4.1,2.1))
Rochers_daily_df <- data.frame(x =1:nrow(Rochers_WSE_daily),
                               mean = Rochers_bam_val$valdata$qpred,
                               upper = Rochers_bam_val$valdata$qpred + 40, 
                               lower = Rochers_bam_val$valdata$qpred - 40)
plot(Rochers_daily_df$x, Rochers_daily_df$mean, ylim = c(75, 200), type = "l",  xaxt = "n", xlab = " ", 
     ylab = expression(Discharge~ (m^{3}/s)), cex.axis = 2, cex.lab = 2, main = "Rochers", cex.main = 3)
polygon(c(Rochers_daily_df$x,rev(Rochers_daily_df$x)),c(Rochers_daily_df$lower,
                                                        rev(Rochers_daily_df$upper)),
        col = rgb(0,0.25,0.75, 0.25), border = FALSE)
lines(Rochers_daily_df$x, Rochers_daily_df$mean, lwd = 3, col = "aquamarine4")
points(x = c(2:4), y = c(Rochers_qobs_daily), pch = 19)
axis(1, at = seq(0, 20, 5), labels = paste0(c("8/7", "8/12", 
                                              "8/19", "8/24", "8/29")), cex.axis = 2)
png("Rochers_Hydrograph.png", height = 350, width = 400,res = 300)
dev.off()


#Partial Q
Rochers_closest_time <- vector(length = length(Rochers_corr_Q$new_date))
for(i in 1:length(Rochers_corr_Q$new_date)){
  Rochers_closest_time[i] = which.min(abs(as.POSIXct(Rochers_WSE$new_time, 
                                                     format = "%m/%d/%Y %H:%M", tz = "MST") - 
                                            as.POSIXct(Rochers_corr_Q$new_date[i])))
}

Rochers_WSE_corrQ <- Rochers_WSE[c(Rochers_closest_time[order(Rochers_closest_time)]),c(3:7)]
Rochers_width_corrQ <- calc_width_new(h = Rochers_WSE_corrQ, elev_prof = Rochers_elev_prof[c(1:5)], 
                                      upper_l = Rochers_upper_l[c(1:5)], lower_l = Rochers_lower_l[c(1:5)],
                                      lower_r = Rochers_lower_r[c(1:5)], upper_r = Rochers_upper_r[c(1:5)],
                                      scale_prof = c(Rochers_scale_x[1:4], Rochers_scale_x[4]))

Rochers_dA_corrQ <- calcdA_mat(t(Rochers_width_corrQ), t(Rochers_WSE_corrQ))
Rochers_xvec_corrQ <- calc_xvec(Rochers_PT_coords_sp[c(1:5)], Rochers_cl)
Rochers_slope_corrQ <- abs(calcslope(rev(Rochers_xvec_corrQ), hmat = t(Rochers_WSE_corrQ)))
Rochers_slope_corrQ[1,] <- colMeans(Rochers_slope_corrQ, na.rm = TRUE)
Rochers_data_corrQ <- bam_data(w = t(Rochers_width_corrQ), dA = Rochers_dA_corrQ, 
                               s = Rochers_slope_corrQ,Qhat = Rochers_corr_Q$Q)

Rochers_bam_corrQ <- run_bam(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_corrQ",
                             width = Rochers_width_corrQ,  dA = Rochers_dA_corrQ,
                             slope =  Rochers_slope_corrQ, qobs = Rochers_corr_Q$Q, rivname = "Rochers",
                             minQ = 1200, maxQ = 2500)
library(hydroGOF)
Rochers_val_corrQ <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_corrQ",
                             Rochers_corr_Q$Q)
Rochers_val_corrQ <- Rochers_val_corrQ[order(Rochers_val_corrQ$num_xs),]
Rochers_stats_corrQ <- bam_val_stats(Rochers_val_corrQ)
Rochers_plot_corrQ <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/BAM_corrQ",
                               Rochers_corr_Q$Q)

#Using the bathymetry from the ADCP to estimate width

#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/Gauge_All")
Rochers_temp_gauge_all <- temporary_gauge_all(num_days = 45, pt_count = 5, file_name = "Rochers",
                                              WSE_mat = t(Rochers_WSE_corrQ), 
                                              Qobs = Rochers_corr_Q$Q)
Rochers_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2018/Rochers/Gauge_All",
                                     Rochers_corr_Q$Q)

#KGE
par(mar=c(5.1, 5.1, 4.1,2.1))
par(family = "serif")
boxplot(kge~num_xs,
        data= Rochers_gauge_all,
        main="Rochers", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 2, cex.axis = 2.5, cex.main = 3, 
        xlim = c(0, length(Rochers_corr_Q$Q)), 
        ylim= c(-1, 1)
)
axis(1, at = seq(0, 44, 10), labels = seq(0, 44, 10), cex.axis = 2.5)
points(c(0:44), Rochers_stats_corrQ$kge, col = "red", pch = 19)
arrows(c(0:44), Rochers_stats_corrQ$kge - Rochers_stats_corrQ$kge_sd, c(0:44), 
       Rochers_stats_corrQ$kge + Rochers_stats_corrQ$kge_sd, length=0.05, angle=90, code=3,
       col = "red")

###Embarras------
par(family = "serif")
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/PAD_2019_PT/Embarras/WSE")
Embarras_WSE <- read.csv("Embarras_WSE_line_corr.csv")
Embarras_WSE <- Embarras_WSE %>%
  mutate(day = as.Date(new_time))
Embarras_WSE_daily <- aggregate(. ~day, data = Embarras_WSE, mean, na.rm = TRUE)[,c(4:ncol(Embarras_WSE))]
plot_elev_prof(Embarras_elev_prof[c(1,2,4,5)], Embarras_WSE_daily, "Embarras")

#Full Daily Time Series (No validation)
locator(n = 4)
Embarras_upper_l <- c( 71.5,  63.7, 49.1, 49.1)
Embarras_lower_l <- c( 89.6,  69.9, 74.5, 74.5)
Embarras_lower_r <- c(133.0, 107.2, 112.1, 112.1)
Embarras_upper_r <- c(154.4, 114.8, 165.2, 165.2)

Embarras_elev_prof[[4]] = Embarras_elev_prof[[5]]

Embarras_width <- calc_width_new(h = Embarras_WSE_daily, elev_prof = Embarras_elev_prof[c(1,2,4,5)], 
                                 upper_l = Embarras_upper_l, lower_l = Embarras_lower_l, 
                                 lower_r = Embarras_lower_r, upper_r = Embarras_upper_r,
                                 scale_prof = Embarras_scale_x[c(1,2,5,5)])

Embarras_dA <- calcdA_mat(t(Embarras_width), t(Embarras_WSE_daily))
Embarras_xvec <- calc_xvec(Embarras_PT_coords_sp[c(1,2,4,5)], Embarras_cl)
Embarras_slope <- abs(calcslope(rev(Embarras_xvec), hmat = t(Embarras_WSE_daily)))
Embarras_slope[1,] <- colMeans(Embarras_slope, na.rm = TRUE)
Embarras_qobs_df$Location <- unlist(lapply(Embarras_qobs_df$Location, toString))
Embarras_qobs_df <- Embarras_qobs_df %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Embarras_corr_Q <- Embarras_qobs_df[Embarras_qobs_df$Q > 100,]
Embarras_qobs_daily <- aggregate(. ~day, data = Embarras_corr_Q[,c(5,11)], mean, na.rm = TRUE)[,2]

#Plot Data
layout(matrix(3:1,ncol=1))
par(family = "serif")
colfunc <- colorRampPalette(c("cyan", "darkblue"))(10)
Embarras_width_plot <- matplot(Embarras_width, type = c("l"), col= colfunc,
                               main = " ", xlab = " ",
                               ylab = "Width (m)",
                               cex.lab = 2, cex.axis = 2, cex.main =3) #plot
Embarras_dA_plot <- matplot(t(Embarras_dA), type = c("l"), col= colfunc,
                            main = " ", xlab = " ",
                            ylab = "dA (m^2)",
                            cex.lab = 2, cex.axis = 2, cex.main =3) #plot
Embarras_slope_plot <- matplot(t(Embarras_slope), type = c("l"), col= colfunc,
                               main = " ", xlab = " ",
                               ylab = "Slope",
                               cex.lab = 2, cex.axis = 2, cex.main =3) #plot

Embarras_data <- bam_data(w = t(Embarras_width), dA = Embarras_dA, s = Embarras_slope, 
                          Qhat = Embarras_corr_Q$Q)
Embarras_priors <- bam_priors(bamdata= Embarras_data, 
                              lowerbound_logQ = log(75), 
                              upperbound_logQ = log(325))
Embarras_bam <- bam_estimate(bamdata = Embarras_data, bampriors = Embarras_priors)
detach(package:hydroGOF)
Embarras_bam_val <- bam_validate(fit = Embarras_bam, qobs = seq(1, nrow(Embarras_WSE_daily), 1))
par(family = "serif")

bam_hydrograph(fit = Embarras_bam)+
  xlab("Time (days)")+ylab(expression(Discharge~ (m^{3}/s)))+theme_bw()+
  theme(text=element_text(size=16, family="serif"))+ 
  ggtitle("Embarras Hydrograph") + 
  scale_x_continuous(breaks = seq(0, 30, 10),labels = paste0(c("8/7/18", "8/27/18", 
                                                               "9/15/18", "10/5/18")))+
  annotate("point", x = c(2:5), y = c(Embarras_qobs_daily), colour = "black")

par(bg = NA)
par(family = "serif")
par(mar=c(5.1, 5.5, 4.1,2.1))
Embarras_daily_df <- data.frame(x =1:nrow(Embarras_WSE_daily),
                                mean = Embarras_bam_val$valdata$qpred,
                                upper = Embarras_bam_val$valdata$qpred + 40, 
                                lower = Embarras_bam_val$valdata$qpred - 40)
plot(Embarras_daily_df$x, Embarras_daily_df$mean, ylim = c(75, 200), type = "l",  xaxt = "n", xlab = " ", 
     ylab = expression(Discharge~ (m^{3}/s)), cex.axis = 2, cex.lab = 2, main = "Embarras", cex.main = 3)
polygon(c(Embarras_daily_df$x,rev(Embarras_daily_df$x)),c(Embarras_daily_df$lower,
                                                          rev(Embarras_daily_df$upper)),
        col = rgb(0,0.25,0.75, 0.25), border = FALSE)
lines(Embarras_daily_df$x, Embarras_daily_df$mean, lwd = 3, col = "aquamarine4")
points(x = c(2:4), y = c(Embarras_qobs_daily), pch = 19)
axis(1, at = seq(0, 20, 5), labels = paste0(c("8/7", "8/12", 
                                              "8/19", "8/24", "8/29")), cex.axis = 2)
png("Embarras_Hydrograph.png", height = 350, width = 400,res = 300)
dev.off()


#Partial Q
Embarras_closest_time <- vector(length = length(Embarras_corr_Q$new_date))
for(i in 1:length(Embarras_corr_Q$new_date)){
  Embarras_closest_time[i] = which.min(abs(as.POSIXct(Embarras_WSE$new_time, tz = "MST") - 
                                             as.POSIXct(Embarras_corr_Q$new_date[i])))
}
#which(is.na(rowSums(Embarras_WSE_corrQ[,c(3:9)])))
Embarras_WSE_corrQ <- Embarras_WSE[c(Embarras_closest_time[order(Embarras_closest_time)]),]
Embarras_WSE_corrQ <- Embarras_WSE_corrQ[,3:6]
Embarras_width_corrQ <- calc_width_new(h = Embarras_WSE_corrQ, elev_prof = Embarras_elev_prof[c(1,2,4,5)], 
                                       upper_l = Embarras_upper_l, lower_l = Embarras_lower_l,
                                       lower_r = Embarras_lower_r, upper_r = Embarras_upper_r,
                                       scale_prof = Embarras_scale_x[c(1,2,5,5)])

Embarras_dA_corrQ <- calcdA_mat(t(Embarras_width_corrQ), t(Embarras_WSE_corrQ))
Embarras_xvec_corrQ <- calc_xvec(Embarras_PT_coords_sp[c(1,2,4,5)], Embarras_cl)
Embarras_slope_corrQ <- abs(calcslope(rev(Embarras_xvec_corrQ), hmat = t(Embarras_WSE_corrQ)))
Embarras_slope_corrQ[1,] <- colMeans(Embarras_slope_corrQ, na.rm = TRUE)
Embarras_data_corrQ <- bam_data(w = t(Embarras_width_corrQ), dA = Embarras_dA_corrQ, 
                                s = Embarras_slope_corrQ,Qhat = Embarras_corr_Q$Q)

Embarras_bam_corrQ <- run_bam(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_corrQ",
                              width = Embarras_width_corrQ,  dA = Embarras_dA_corrQ,
                              slope =  Embarras_slope_corrQ, qobs = Embarras_corr_Q$Q, rivname = "Embarras",
                              minQ = 75, maxQ = 325)
library(hydroGOF)
Embarras_val_corrQ <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_corrQ",
                              qobs = Embarras_corr_Q$Q)
Embarras_val_corrQ <- Embarras_val_corrQ[order(Embarras_val_corrQ$num_xs),]
Embarras_stats_corrQ <- bam_val_stats(Embarras_val_corrQ)
Embarras_plot_corrQ <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/BAM_corrQ",
                                Embarras_corr_Q$Q)

#Using the bathymetry from the ADCP to estimate width

#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/Gauge_All")
Embarras_temp_gauge_all <- temporary_gauge_all(num_days = 51, pt_count = 4, file_name = "Embarras",
                                               WSE_mat = t(Embarras_WSE_corrQ), 
                                               Qobs = Embarras_corr_Q$Q)
Embarras_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Embarras/Gauge_All",
                                      Embarras_corr_Q$Q)

#KGE
par(mar=c(5.1, 5.1, 4.1,2.1))
par(family = "serif")
boxplot(kge~num_xs,
        data= Embarras_gauge_all,
        main="Embarras", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 2, cex.axis = 2.5, cex.main = 3, 
        xlim = c(0, length(Embarras_corr_Q$Q)), 
        ylim= c(-1, 1)
)
axis(1, at = seq(0, 50, 10), labels = seq(0, 50, 10), cex.axis = 2.5)
points(c(0:50), Embarras_stats_corrQ$kge, col = "red", pch = 19)
arrows(c(0:50), Embarras_stats_corrQ$kge - Embarras_stats_corrQ$kge_sd, c(0:50), 
       Embarras_stats_corrQ$kge + Embarras_stats_corrQ$kge_sd, length=0.05, angle=90, code=3,
       col = "red")
###Limon------
par(family = "serif")
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/PAD_2019_PT/Limon/WSE")
Limon_WSE <- read.csv("Limon_WSE_line_corr.csv")
Limon_WSE <- Limon_WSE %>%
  mutate(day = as.Date(new_time))
Limon_WSE_daily <- aggregate(. ~day, data = Limon_WSE, mean, na.rm = TRUE)[,c(4:ncol(Limon_WSE))]
plot_elev_prof(Limon_elev_prof[2:5], Limon_WSE_daily, "Limon")

#Full Daily Time Series (No validation)
locator(n = 4)
Limon_upper_l <- c( 1.1,  40.4, 74.6,   0.3)
Limon_lower_l <- c( 4.1,  56.4, 82.7,  19.8)
Limon_lower_r <- c(15.0,  78.6, 101.6, 54.5)
Limon_upper_r <- c(20.8,  95.8, 111.2, 76.2)


Limon_width <- calc_width_new(h = Limon_WSE_daily, elev_prof = Limon_elev_prof[c(2:5)], 
                              upper_l = Limon_upper_l, lower_l = Limon_lower_l, 
                              lower_r = Limon_lower_r, upper_r = Limon_upper_r,
                              scale_prof = Limon_scale_x[c(2:5)])

Limon_dA <- calcdA_mat(t(Limon_width), t(Limon_WSE_daily))
Limon_xvec <- calc_xvec(Limon_PT_coords_sp[c(2:5)], Limon_cl)
Limon_slope <- abs(calcslope(rev(Limon_xvec), hmat = t(Limon_WSE_daily)))
Limon_slope[1,] <- colMeans(Limon_slope, na.rm = TRUE)
Limon_qobs_df$Location <- unlist(lapply(Limon_qobs_df$Location, toString))
Limon_qobs_df <- Limon_qobs_df %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Limon_corr_Q <- Limon_qobs_df[Limon_qobs_df$Q > 30 & Limon_qobs_df$Q < 50,]
Limon_qobs_daily <- aggregate(. ~day, data = Limon_corr_Q[,c(5,11)], mean, na.rm = TRUE)[,2]

#Plot Data
layout(matrix(3:1,ncol=1))
par(family = "serif")
colfunc <- colorRampPalette(c("cyan", "darkblue"))(10)
Limon_width_plot <- matplot(Limon_width, type = c("l"), col= colfunc,
                            main = " ", xlab = " ",
                            ylab = "Width (m)",
                            cex.lab = 2, cex.axis = 2, cex.main =3) #plot
Limon_dA_plot <- matplot(t(Limon_dA), type = c("l"), col= colfunc,
                         main = " ", xlab = " ",
                         ylab = "dA (m^2)",
                         cex.lab = 2, cex.axis = 2, cex.main =3) #plot
Limon_slope_plot <- matplot(t(Limon_slope), type = c("l"), col= colfunc,
                            main = " ", xlab = " ",
                            ylab = "Slope",
                            cex.lab = 2, cex.axis = 2, cex.main =3) #plot

Limon_data <- bam_data(w = t(Limon_width), dA = Limon_dA, s = Limon_slope, 
                       Qhat = Limon_corr_Q$Q)
Limon_priors <- bam_priors(bamdata= Limon_data, 
                           lowerbound_logQ = log(20), 
                           upperbound_logQ = log(60))
Limon_bam <- bam_estimate(bamdata = Limon_data, bampriors = Limon_priors)
detach(package:hydroGOF)
Limon_bam_val <- bam_validate(fit = Limon_bam, qobs = seq(1, nrow(Limon_WSE_daily), 1))
par(family = "serif")

bam_hydrograph(fit = Limon_bam)+
  xlab("Time (days)")+ylab(expression(Discharge~ (m^{3}/s)))+theme_bw()+
  theme(text=element_text(size=16, family="serif"))+ 
  ggtitle("Limon Hydrograph") + 
  scale_x_continuous(breaks = seq(0, 30, 10),labels = paste0(c("8/7/18", "8/27/18", 
                                                               "9/15/18", "10/5/18")))+
  annotate("point", x = c(2:5), y = c(Limon_qobs_daily), colour = "black")

par(bg = NA)
par(family = "serif")
par(mar=c(5.1, 5.5, 4.1,2.1))
Limon_daily_df <- data.frame(x =1:nrow(Limon_WSE_daily),
                             mean = Limon_bam_val$valdata$qpred,
                             upper = Limon_bam_val$valdata$qpred + 40, 
                             lower = Limon_bam_val$valdata$qpred - 40)
plot(Limon_daily_df$x, Limon_daily_df$mean, ylim = c(75, 200), type = "l",  xaxt = "n", xlab = " ", 
     ylab = expression(Discharge~ (m^{3}/s)), cex.axis = 2, cex.lab = 2, main = "Limon", cex.main = 3)
polygon(c(Limon_daily_df$x,rev(Limon_daily_df$x)),c(Limon_daily_df$lower,
                                                    rev(Limon_daily_df$upper)),
        col = rgb(0,0.25,0.75, 0.25), border = FALSE)
lines(Limon_daily_df$x, Limon_daily_df$mean, lwd = 3, col = "aquamarine4")
points(x = c(2:4), y = c(Limon_qobs_daily), pch = 19)
axis(1, at = seq(0, 20, 5), labels = paste0(c("8/7", "8/12", 
                                              "8/19", "8/24", "8/29")), cex.axis = 2)
png("Limon_Hydrograph.png", height = 350, width = 400,res = 300)
dev.off()


#Partial Q
Limon_closest_time <- vector(length = length(Limon_corr_Q$new_date))
for(i in 1:length(Limon_corr_Q$new_date)){
  Limon_closest_time[i] = which.min(abs(as.POSIXct(Limon_WSE$new_time, tz = "MST") - 
                                          as.POSIXct(Limon_corr_Q$new_date[i])))
}
#which(is.na(rowSums(Limon_WSE_corrQ[,c(3:9)])))
Limon_WSE_corrQ <- Limon_WSE[c(Limon_closest_time[order(Limon_closest_time)]),]
Limon_WSE_corrQ <- Limon_WSE_corrQ[,3:6]
Limon_width_corrQ <- calc_width_new(h = Limon_WSE_corrQ, elev_prof = Limon_elev_prof[c(2:5)], 
                                    upper_l = Limon_upper_l, lower_l = Limon_lower_l,
                                    lower_r = Limon_lower_r, upper_r = Limon_upper_r,
                                    scale_prof = Limon_scale_x[c(2:5)])

Limon_dA_corrQ <- calcdA_mat(t(Limon_width_corrQ), t(Limon_WSE_corrQ))
Limon_xvec_corrQ <- calc_xvec(Limon_PT_coords_sp[c(2:5)], Limon_cl)
Limon_slope_corrQ <- abs(calcslope(rev(Limon_xvec_corrQ), hmat = t(Limon_WSE_corrQ)))
Limon_slope_corrQ[1,] <- colMeans(Limon_slope_corrQ, na.rm = TRUE)
Limon_data_corrQ <- bam_data(w = t(Limon_width_corrQ), dA = Limon_dA_corrQ, 
                             s = Limon_slope_corrQ,Qhat = Limon_corr_Q$Q)

Limon_bam_corrQ <- run_bam(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_corrQ",
                           width = Limon_width_corrQ,  dA = Limon_dA_corrQ,
                           slope =  Limon_slope_corrQ, qobs = Limon_corr_Q$Q, rivname = "Limon",
                           minQ = 20, maxQ = 60)
library(hydroGOF)
Limon_val_corrQ <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_corrQ",
                           qobs = Limon_corr_Q$Q)
Limon_val_corrQ <- Limon_val_corrQ[order(Limon_val_corrQ$num_xs),]
Limon_stats_corrQ <- bam_val_stats(Limon_val_corrQ)
Limon_plot_corrQ <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/BAM_corrQ",
                             Limon_corr_Q$Q)

#Using the bathymetry from the ADCP to estimate width

#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/Gauge_All")
Limon_temp_gauge_all <- temporary_gauge_all(num_days = 9, pt_count = 4, file_name = "Limon",
                                            WSE_mat = t(Limon_WSE_corrQ), 
                                            Qobs = Limon_corr_Q$Q)
Limon_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Limon/Gauge_All",
                                   Limon_corr_Q$Q)

#KGE
par(mar=c(5.1, 5.1, 4.1,2.1))
par(family = "serif")
boxplot(kge~num_xs,
        data= Limon_gauge_all,
        main="Limon", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 2, cex.axis = 2.5, cex.main = 3, 
        xlim = c(0, length(Limon_corr_Q$Q)), 
        ylim= c(-1, 1)
)
axis(1, at = seq(0, 8, 2), labels = seq(0, 8, 2), cex.axis = 2.5)
points(c(0:8), Limon_stats_corrQ$kge, col = "red", pch = 19)
arrows(c(0:8), Limon_stats_corrQ$kge - Limon_stats_corrQ$kge_sd, c(0:8), 
       Limon_stats_corrQ$kge + Limon_stats_corrQ$kge_sd, length=0.05, angle=90, code=3,
       col = "red")


###Richardson------
par(family = "serif")
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/PAD_2019_PT/Richardson/WSE")
Richardson_WSE <- read.csv("Richardson_WSE_line_corr.csv")
Richardson_WSE <- Richardson_WSE %>%
  mutate(day = as.Date(new_time))
Richardson_WSE_daily <- aggregate(. ~day, data = Richardson_WSE, mean, na.rm = TRUE)[,c(4:ncol(Richardson_WSE))]
plot_elev_prof(Richardson_elev_prof, Richardson_WSE_daily, "Richardson")

#Full Daily Time Series (No validation)
locator(n = 4)
Richardson_upper_l <- c(18.1, 18.1, 18.1, 18.1, 18.1)
Richardson_lower_l <- c(29.1, 29.1, 29.1, 29.1, 29.1)
Richardson_lower_r <- c(85.4, 85.4, 85.4, 85.4, 85.4)
Richardson_upper_r <- c(96.1, 96.1, 96.1, 96.1, 96.1)

Richardson_elev_prof[[2]] = Richardson_elev_prof[[1]]
Richardson_elev_prof[[3]] = Richardson_elev_prof[[1]]
Richardson_elev_prof[[4]] = Richardson_elev_prof[[1]]
Richardson_elev_prof[[5]] = Richardson_elev_prof[[1]]

Richardson_width <- calc_width_new(h = Richardson_WSE_daily, elev_prof = Richardson_elev_prof, 
                                   upper_l = Richardson_upper_l, lower_l = Richardson_lower_l, 
                                   lower_r = Richardson_lower_r, upper_r = Richardson_upper_r,
                                   scale_prof = Richardson_scale_x[c(1,1,1,1,1)])

Richardson_dA <- calcdA_mat(t(Richardson_width), t(Richardson_WSE_daily))
Richardson_xvec <- calc_xvec(Richardson_PT_coords_sp, Richardson_cl)
Richardson_slope <- abs(calcslope(rev(Richardson_xvec), hmat = t(Richardson_WSE_daily)))
Richardson_slope[1,] <- colMeans(Richardson_slope, na.rm = TRUE)
Richardson_qobs_df$Location <- unlist(lapply(Richardson_qobs_df$Location, toString))
Richardson_qobs_df <- Richardson_qobs_df %>%
  mutate(day = as.Date(new_date, format="%Y-%m-%d"))
Richardson_corr_Q <- Richardson_qobs_df[Richardson_qobs_df$Q < 25,]
Richardson_qobs_daily <- aggregate(. ~day, data = Richardson_corr_Q[,c(5,11)], mean, na.rm = TRUE)[,2]

#Plot Data
layout(matrix(3:1,ncol=1))
par(family = "serif")
colfunc <- colorRampPalette(c("cyan", "darkblue"))(10)
Richardson_width_plot <- matplot(Richardson_width, type = c("l"), col= colfunc,
                                 main = " ", xlab = " ",
                                 ylab = "Width (m)",
                                 cex.lab = 2, cex.axis = 2, cex.main =3) #plot
Richardson_dA_plot <- matplot(t(Richardson_dA), type = c("l"), col= colfunc,
                              main = " ", xlab = " ",
                              ylab = "dA (m^2)",
                              cex.lab = 2, cex.axis = 2, cex.main =3) #plot
Richardson_slope_plot <- matplot(t(Richardson_slope), type = c("l"), col= colfunc,
                                 main = " ", xlab = " ",
                                 ylab = "Slope",
                                 cex.lab = 2, cex.axis = 2, cex.main =3) #plot

Richardson_data <- bam_data(w = t(Richardson_width), dA = Richardson_dA, s = Richardson_slope, 
                            Qhat = Richardson_corr_Q$Q)
Richardson_priors <- bam_priors(bamdata= Richardson_data, 
                                lowerbound_logQ = log(20), 
                                upperbound_logQ = log(60))
Richardson_bam <- bam_estimate(bamdata = Richardson_data, bampriors = Richardson_priors)
detach(package:hydroGOF)
Richardson_bam_val <- bam_validate(fit = Richardson_bam, qobs = seq(1, nrow(Richardson_WSE_daily), 1))
par(family = "serif")

bam_hydrograph(fit = Richardson_bam)+
  xlab("Time (days)")+ylab(expression(Discharge~ (m^{3}/s)))+theme_bw()+
  theme(text=element_text(size=16, family="serif"))+ 
  ggtitle("Richardson Hydrograph") + 
  scale_x_continuous(breaks = seq(0, 30, 10),labels = paste0(c("8/7/18", "8/27/18", 
                                                               "9/15/18", "10/5/18")))+
  annotate("point", x = c(26,32), y = c(Richardson_qobs_daily), colour = "black")

#par(bg = NA)
par(family = "serif")
par(mar=c(5.1, 5.5, 4.1,2.1))
Richardson_daily_df <- data.frame(x =1:nrow(Richardson_WSE_daily),
                                  mean = Richardson_bam_val$valdata$qpred,
                                  upper = Richardson_bam_val$valdata$qpred + 10, 
                                  lower = Richardson_bam_val$valdata$qpred - 10)
plot(Richardson_daily_df$x, Richardson_daily_df$mean, ylim = c(0, 60), type = "l",  xaxt = "n", xlab = " ", 
     ylab = " ", cex.axis = 2.5, cex.lab = 2, main = "Richardson", cex.main = 3)
polygon(c(Richardson_daily_df$x,rev(Richardson_daily_df$x)),c(Richardson_daily_df$lower,
                                                              rev(Richardson_daily_df$upper)),
        col = rgb(0,0.25,0.75, 0.25), border = FALSE)
lines(Richardson_daily_df$x, Richardson_daily_df$mean, lwd = 3, col = "aquamarine4")
points(x = c(26,32), y = c(Richardson_qobs_daily), pch = 19)
axis(1, at = seq(0, 40, 10), labels = paste0(c("7/13", "7/23", 
                                               "8/2", "8/12", "8/22")), cex.axis = 2.5)
png("Richardson_Hydrograph.png", height = 350, width = 400,res = 300)
dev.off()


#Partial Q
Richardson_closest_time <- vector(length = length(Richardson_corr_Q$new_date))
for(i in 1:length(Richardson_corr_Q$new_date)){
  Richardson_closest_time[i] = which.min(abs(as.POSIXct(Richardson_WSE$new_time, tz = "MST") - 
                                               as.POSIXct(Richardson_corr_Q$new_date[i])))
}
#which(is.na(rowSums(Richardson_WSE_corrQ[,c(3:9)])))
Richardson_WSE_corrQ <- Richardson_WSE[c(Richardson_closest_time[order(Richardson_closest_time)]),]
Richardson_WSE_corrQ <- Richardson_WSE_corrQ[,3:7]
Richardson_width_corrQ <- calc_width_new(h = Richardson_WSE_corrQ, elev_prof = Richardson_elev_prof, 
                                         upper_l = Richardson_upper_l, lower_l = Richardson_lower_l,
                                         lower_r = Richardson_lower_r, upper_r = Richardson_upper_r,
                                         scale_prof = Richardson_scale_x[c(1,1,1,1,1)])
Richardson_width_corrQ <- matrix(c(rep(28.2, 26), rep(18.7, 26), 
                                   rep(25.6, 26), rep(24.6, 26), rep(18.4, 26)), nrow = 26)
Richardson_dA_corrQ <- calcdA_mat(t(Richardson_width_corrQ), t(Richardson_WSE_corrQ))
Richardson_xvec_corrQ <- calc_xvec(Richardson_PT_coords_sp, Richardson_cl)
Richardson_slope_corrQ <- abs(calcslope(rev(Richardson_xvec_corrQ), hmat = t(Richardson_WSE_corrQ)))
Richardson_slope_corrQ[1,] <- colMeans(Richardson_slope_corrQ, na.rm = TRUE)
Richardson_data_corrQ <- bam_data(w = t(Richardson_width_corrQ), dA = Richardson_dA_corrQ, 
                                  s = Richardson_slope_corrQ,Qhat = Richardson_corr_Q$Q)
Richardson_bam_corrQ <- run_bam(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_corrQ",
                                width = Richardson_width_corrQ,  dA = Richardson_dA_corrQ,
                                slope =  Richardson_slope_corrQ, qobs = Richardson_corr_Q$Q, rivname = "Richardson",
                                minQ = 5, maxQ = 40)
Richardson_bam_corrQ <- run_bam(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_width",
                                width = Richardson_width_corrQ,  dA = Richardson_dA_corrQ,
                                slope =  Richardson_slope_corrQ, qobs = Richardson_corr_Q$Q, rivname = "Richardson",
                                minQ = min(Richardson_corr_Q$Q), maxQ = max(Richardson_corr_Q$Q))
library(hydroGOF)
Richardson_val_corrQ <- bam_val(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_corrQ",
                                qobs = Richardson_corr_Q$Q)
Richardson_val_corrQ <- Richardson_val_corrQ[order(Richardson_val_corrQ$num_xs),]
Richardson_stats_corrQ <- bam_val_stats(Richardson_val_corrQ)
Richardson_plot_corrQ <- bam_plot(wd = "C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/BAM_corrQ",
                                  Richardson_corr_Q$Q)

#Using the bathymetry from the ADCP to estimate width

#Temporary Gauge
setwd("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/Gauge_All")
Richardson_temp_gauge_all <- temporary_gauge_all(num_days = 26, pt_count = 5, file_name = "Richardson",
                                                 WSE_mat = t(Richardson_WSE_corrQ), 
                                                 Qobs = Richardson_corr_Q$Q)
Richardson_gauge_all <- gauge_stats_all("C:/Users/Merritt/Desktop/Research/PT_Paper/PAD/PAD_2019/Richardson/Gauge_All",
                                        Richardson_corr_Q$Q)

#KGE
par(mar=c(5.1, 5.1, 4.1,2.1))
par(family = "serif")
boxplot(kge~num_xs,
        data= Richardson_gauge_all,
        main="Richardson", xaxt = "n",
        xlab=" ", ylab=" ", col="aquamarine4",
        border = "black", cex.lab = 2, cex.axis = 2.5, cex.main = 3, 
        xlim = c(0, length(Richardson_corr_Q$Q)), 
        ylim= c(-1, 1)
)
axis(1, at = seq(0, 25, 5), labels = seq(0, 25, 5), cex.axis = 2.5)
points(c(0:25), Richardson_stats_corrQ$kge, col = "red", pch = 19)
arrows(c(0:25), Richardson_stats_corrQ$kge - Richardson_stats_corrQ$kge_sd, c(0:25), 
       Richardson_stats_corrQ$kge + Richardson_stats_corrQ$kge_sd, length=0.05, angle=90, code=3,
       col = "red")

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
